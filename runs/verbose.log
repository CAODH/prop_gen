Fold 0
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'cuda': True,
 'data_path': 'dopamine.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cache': False,
 'num_folds': 1,
 'num_lrs': 1,
 'quiet': False,
 'save_dir': 'runs\\fold_0',
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'test': False,
 'test_fold_index': None,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': None,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 3,504 | train size = 2,803 | val size = 350 | test size = 351
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Moving model to cuda
Epoch 0
Loss = 2.1829e-02, PNorm = 33.8465, GNorm = 1.3129, lr_0 = 1.8036e-04
Loss = 1.9120e-02, PNorm = 33.8478, GNorm = 2.4547, lr_0 = 2.6071e-04
Loss = 1.9050e-02, PNorm = 33.8547, GNorm = 2.9982, lr_0 = 3.4107e-04
Loss = 1.6421e-02, PNorm = 33.8719, GNorm = 2.7916, lr_0 = 4.2143e-04
Loss = 1.7353e-02, PNorm = 33.8944, GNorm = 2.0418, lr_0 = 5.0179e-04
Validation rmse = 1.040176
Epoch 1
Loss = 1.6044e-02, PNorm = 33.9212, GNorm = 5.3097, lr_0 = 5.8214e-04
Loss = 1.5592e-02, PNorm = 33.9561, GNorm = 14.6405, lr_0 = 6.6250e-04
Loss = 1.5189e-02, PNorm = 33.9940, GNorm = 3.9838, lr_0 = 7.4286e-04
Loss = 1.5161e-02, PNorm = 34.0513, GNorm = 5.2476, lr_0 = 8.2321e-04
Loss = 1.6603e-02, PNorm = 34.1085, GNorm = 3.4573, lr_0 = 9.0357e-04
Loss = 1.4798e-02, PNorm = 34.1795, GNorm = 8.5422, lr_0 = 9.8393e-04
Validation rmse = 0.976308
Epoch 2
Loss = 1.1711e-02, PNorm = 34.2416, GNorm = 0.9130, lr_0 = 9.8832e-04
Loss = 1.3108e-02, PNorm = 34.3200, GNorm = 1.2122, lr_0 = 9.7391e-04
Loss = 1.3984e-02, PNorm = 34.3906, GNorm = 0.9000, lr_0 = 9.5972e-04
Loss = 1.3969e-02, PNorm = 34.4771, GNorm = 5.3514, lr_0 = 9.4573e-04
Loss = 1.4945e-02, PNorm = 34.5594, GNorm = 1.3807, lr_0 = 9.3194e-04
Validation rmse = 0.934928
Epoch 3
Loss = 1.3016e-02, PNorm = 34.6412, GNorm = 1.4788, lr_0 = 9.1835e-04
Loss = 1.1238e-02, PNorm = 34.7228, GNorm = 1.3997, lr_0 = 9.0497e-04
Loss = 1.3277e-02, PNorm = 34.8014, GNorm = 7.9825, lr_0 = 8.9177e-04
Loss = 1.1079e-02, PNorm = 34.8803, GNorm = 6.2151, lr_0 = 8.7877e-04
Loss = 1.2817e-02, PNorm = 34.9460, GNorm = 1.9098, lr_0 = 8.6596e-04
Loss = 9.7991e-03, PNorm = 35.0294, GNorm = 3.1625, lr_0 = 8.5334e-04
Validation rmse = 0.928781
Epoch 4
Loss = 1.0892e-02, PNorm = 35.0855, GNorm = 6.2929, lr_0 = 8.4090e-04
Loss = 1.0515e-02, PNorm = 35.1502, GNorm = 5.2412, lr_0 = 8.2864e-04
Loss = 1.0093e-02, PNorm = 35.2232, GNorm = 1.6801, lr_0 = 8.1656e-04
Loss = 1.0436e-02, PNorm = 35.2905, GNorm = 2.0472, lr_0 = 8.0466e-04
Loss = 1.0387e-02, PNorm = 35.3392, GNorm = 3.1535, lr_0 = 7.9293e-04
Loss = 9.9936e-03, PNorm = 35.3963, GNorm = 1.9835, lr_0 = 7.8137e-04
Validation rmse = 0.839874
Epoch 5
Loss = 8.6018e-03, PNorm = 35.4543, GNorm = 1.6607, lr_0 = 7.6998e-04
Loss = 1.0267e-02, PNorm = 35.5071, GNorm = 4.2946, lr_0 = 7.5876e-04
Loss = 8.8691e-03, PNorm = 35.5688, GNorm = 1.1187, lr_0 = 7.4770e-04
Loss = 9.0801e-03, PNorm = 35.6303, GNorm = 2.8139, lr_0 = 7.3680e-04
Loss = 1.0572e-02, PNorm = 35.6816, GNorm = 3.0153, lr_0 = 7.2605e-04
Validation rmse = 0.836349
Epoch 6
Loss = 1.0230e-02, PNorm = 35.7216, GNorm = 2.2567, lr_0 = 7.1547e-04
Loss = 9.3869e-03, PNorm = 35.7697, GNorm = 1.5044, lr_0 = 7.0504e-04
Loss = 8.7128e-03, PNorm = 35.8290, GNorm = 3.8662, lr_0 = 6.9476e-04
Loss = 9.5500e-03, PNorm = 35.8728, GNorm = 4.4320, lr_0 = 6.8464e-04
Loss = 7.5335e-03, PNorm = 35.9054, GNorm = 1.1584, lr_0 = 6.7465e-04
Loss = 8.2982e-03, PNorm = 35.9520, GNorm = 2.6928, lr_0 = 6.6482e-04
Validation rmse = 0.772700
Epoch 7
Loss = 9.4583e-03, PNorm = 35.9979, GNorm = 1.7807, lr_0 = 6.5513e-04
Loss = 8.5819e-03, PNorm = 36.0327, GNorm = 3.9067, lr_0 = 6.4558e-04
Loss = 8.5321e-03, PNorm = 36.0763, GNorm = 1.5910, lr_0 = 6.3617e-04
Loss = 9.4939e-03, PNorm = 36.1215, GNorm = 10.2046, lr_0 = 6.2689e-04
Loss = 8.1567e-03, PNorm = 36.1626, GNorm = 1.9818, lr_0 = 6.1776e-04
Validation rmse = 0.786834
Epoch 8
Loss = 6.8226e-03, PNorm = 36.2143, GNorm = 5.6353, lr_0 = 6.0875e-04
Loss = 8.0101e-03, PNorm = 36.2531, GNorm = 3.2610, lr_0 = 5.9988e-04
Loss = 8.6851e-03, PNorm = 36.2903, GNorm = 2.7800, lr_0 = 5.9113e-04
Loss = 7.7597e-03, PNorm = 36.3282, GNorm = 1.4763, lr_0 = 5.8251e-04
Loss = 7.4756e-03, PNorm = 36.3605, GNorm = 1.5977, lr_0 = 5.7402e-04
Loss = 7.8429e-03, PNorm = 36.3903, GNorm = 2.2262, lr_0 = 5.6565e-04
Validation rmse = 0.759359
Epoch 9
Loss = 7.0085e-03, PNorm = 36.4206, GNorm = 1.6546, lr_0 = 5.5741e-04
Loss = 7.9025e-03, PNorm = 36.4571, GNorm = 2.7174, lr_0 = 5.4928e-04
Loss = 7.5892e-03, PNorm = 36.4954, GNorm = 1.3057, lr_0 = 5.4128e-04
Loss = 7.9348e-03, PNorm = 36.5163, GNorm = 1.4927, lr_0 = 5.3339e-04
Loss = 6.9265e-03, PNorm = 36.5411, GNorm = 2.0426, lr_0 = 5.2561e-04
Loss = 7.2352e-03, PNorm = 36.5749, GNorm = 1.9713, lr_0 = 5.1795e-04
Validation rmse = 0.753875
Epoch 10
Loss = 7.5652e-03, PNorm = 36.6052, GNorm = 4.0511, lr_0 = 5.1040e-04
Loss = 7.6993e-03, PNorm = 36.6411, GNorm = 4.8174, lr_0 = 5.0296e-04
Loss = 8.0329e-03, PNorm = 36.6701, GNorm = 1.4335, lr_0 = 4.9562e-04
Loss = 6.4813e-03, PNorm = 36.6961, GNorm = 1.6770, lr_0 = 4.8840e-04
Loss = 6.9001e-03, PNorm = 36.7221, GNorm = 3.5089, lr_0 = 4.8128e-04
Validation rmse = 0.720108
Epoch 11
Loss = 7.6779e-03, PNorm = 36.7479, GNorm = 4.0468, lr_0 = 4.7426e-04
Loss = 7.9188e-03, PNorm = 36.7814, GNorm = 2.3410, lr_0 = 4.6735e-04
Loss = 6.3958e-03, PNorm = 36.8073, GNorm = 2.3339, lr_0 = 4.6054e-04
Loss = 6.3590e-03, PNorm = 36.8398, GNorm = 1.0232, lr_0 = 4.5382e-04
Loss = 6.4504e-03, PNorm = 36.8591, GNorm = 1.0571, lr_0 = 4.4721e-04
Loss = 6.7876e-03, PNorm = 36.8809, GNorm = 3.5791, lr_0 = 4.4069e-04
Validation rmse = 0.720982
Epoch 12
Loss = 6.0414e-03, PNorm = 36.9029, GNorm = 3.7498, lr_0 = 4.3427e-04
Loss = 7.0152e-03, PNorm = 36.9226, GNorm = 1.3802, lr_0 = 4.2793e-04
Loss = 7.1761e-03, PNorm = 36.9526, GNorm = 0.9162, lr_0 = 4.2170e-04
Loss = 7.2428e-03, PNorm = 36.9740, GNorm = 2.0437, lr_0 = 4.1555e-04
Loss = 7.1926e-03, PNorm = 36.9954, GNorm = 1.9362, lr_0 = 4.0949e-04
Validation rmse = 0.705182
Epoch 13
Loss = 4.3223e-03, PNorm = 37.0266, GNorm = 1.2982, lr_0 = 4.0352e-04
Loss = 6.3306e-03, PNorm = 37.0556, GNorm = 1.5940, lr_0 = 3.9764e-04
Loss = 7.0197e-03, PNorm = 37.0743, GNorm = 1.8081, lr_0 = 3.9184e-04
Loss = 5.5869e-03, PNorm = 37.0929, GNorm = 1.3280, lr_0 = 3.8613e-04
Loss = 6.5707e-03, PNorm = 37.1131, GNorm = 1.0927, lr_0 = 3.8050e-04
Loss = 6.9357e-03, PNorm = 37.1405, GNorm = 1.4477, lr_0 = 3.7496e-04
Validation rmse = 0.689070
Epoch 14
Loss = 6.2339e-03, PNorm = 37.1539, GNorm = 0.7783, lr_0 = 3.6949e-04
Loss = 6.3603e-03, PNorm = 37.1773, GNorm = 1.0141, lr_0 = 3.6410e-04
Loss = 5.2540e-03, PNorm = 37.1969, GNorm = 1.6005, lr_0 = 3.5880e-04
Loss = 6.1992e-03, PNorm = 37.2162, GNorm = 6.2505, lr_0 = 3.5357e-04
Loss = 5.6098e-03, PNorm = 37.2352, GNorm = 1.7820, lr_0 = 3.4841e-04
Loss = 6.6915e-03, PNorm = 37.2548, GNorm = 2.2544, lr_0 = 3.4333e-04
Validation rmse = 0.691614
Epoch 15
Loss = 5.8190e-03, PNorm = 37.2784, GNorm = 2.1665, lr_0 = 3.3833e-04
Loss = 5.3977e-03, PNorm = 37.2957, GNorm = 1.4207, lr_0 = 3.3340e-04
Loss = 6.8681e-03, PNorm = 37.3048, GNorm = 3.5662, lr_0 = 3.2853e-04
Loss = 5.4692e-03, PNorm = 37.3218, GNorm = 2.5679, lr_0 = 3.2375e-04
Loss = 6.0608e-03, PNorm = 37.3412, GNorm = 1.1267, lr_0 = 3.1903e-04
Validation rmse = 0.722500
Epoch 16
Loss = 6.5937e-03, PNorm = 37.3567, GNorm = 3.9608, lr_0 = 3.1438e-04
Loss = 5.3777e-03, PNorm = 37.3732, GNorm = 1.2440, lr_0 = 3.0979e-04
Loss = 5.8094e-03, PNorm = 37.3891, GNorm = 1.4120, lr_0 = 3.0528e-04
Loss = 6.0778e-03, PNorm = 37.4036, GNorm = 1.4768, lr_0 = 3.0083e-04
Loss = 5.7975e-03, PNorm = 37.4195, GNorm = 1.7740, lr_0 = 2.9644e-04
Loss = 5.3577e-03, PNorm = 37.4344, GNorm = 1.5900, lr_0 = 2.9212e-04
Validation rmse = 0.659236
Epoch 17
Loss = 4.8083e-03, PNorm = 37.4496, GNorm = 1.3371, lr_0 = 2.8786e-04
Loss = 5.8496e-03, PNorm = 37.4607, GNorm = 3.7911, lr_0 = 2.8367e-04
Loss = 6.4969e-03, PNorm = 37.4792, GNorm = 1.4635, lr_0 = 2.7953e-04
Loss = 5.2393e-03, PNorm = 37.4964, GNorm = 1.1106, lr_0 = 2.7546e-04
Loss = 5.2436e-03, PNorm = 37.5079, GNorm = 1.6476, lr_0 = 2.7144e-04
Validation rmse = 0.665784
Epoch 18
Loss = 6.4896e-03, PNorm = 37.5205, GNorm = 2.2312, lr_0 = 2.6748e-04
Loss = 4.9766e-03, PNorm = 37.5356, GNorm = 1.8329, lr_0 = 2.6358e-04
Loss = 5.0230e-03, PNorm = 37.5520, GNorm = 1.8442, lr_0 = 2.5974e-04
Loss = 5.6643e-03, PNorm = 37.5664, GNorm = 1.8807, lr_0 = 2.5595e-04
Loss = 5.5420e-03, PNorm = 37.5723, GNorm = 1.6904, lr_0 = 2.5222e-04
Loss = 5.0697e-03, PNorm = 37.5821, GNorm = 1.3573, lr_0 = 2.4855e-04
Validation rmse = 0.664228
Epoch 19
Loss = 6.2090e-03, PNorm = 37.5961, GNorm = 1.8324, lr_0 = 2.4492e-04
Loss = 4.8391e-03, PNorm = 37.6105, GNorm = 1.1151, lr_0 = 2.4135e-04
Loss = 5.7129e-03, PNorm = 37.6230, GNorm = 1.1381, lr_0 = 2.3783e-04
Loss = 5.2478e-03, PNorm = 37.6342, GNorm = 2.1873, lr_0 = 2.3437e-04
Loss = 5.0227e-03, PNorm = 37.6497, GNorm = 1.6339, lr_0 = 2.3095e-04
Loss = 5.0558e-03, PNorm = 37.6602, GNorm = 1.4427, lr_0 = 2.2758e-04
Validation rmse = 0.652433
Epoch 20
Loss = 5.5591e-03, PNorm = 37.6684, GNorm = 1.5635, lr_0 = 2.2427e-04
Loss = 5.2611e-03, PNorm = 37.6820, GNorm = 2.2892, lr_0 = 2.2100e-04
Loss = 4.6999e-03, PNorm = 37.6930, GNorm = 2.1567, lr_0 = 2.1778e-04
Loss = 5.5731e-03, PNorm = 37.7023, GNorm = 1.6615, lr_0 = 2.1460e-04
Loss = 4.5178e-03, PNorm = 37.7104, GNorm = 2.7120, lr_0 = 2.1147e-04
Validation rmse = 0.648593
Epoch 21
Loss = 5.1537e-03, PNorm = 37.7200, GNorm = 1.5811, lr_0 = 2.0839e-04
Loss = 4.8821e-03, PNorm = 37.7305, GNorm = 1.4041, lr_0 = 2.0535e-04
Loss = 5.4443e-03, PNorm = 37.7418, GNorm = 2.1154, lr_0 = 2.0236e-04
Loss = 4.6187e-03, PNorm = 37.7503, GNorm = 1.3012, lr_0 = 1.9941e-04
Loss = 4.8355e-03, PNorm = 37.7617, GNorm = 2.6776, lr_0 = 1.9650e-04
Loss = 5.0380e-03, PNorm = 37.7705, GNorm = 1.0405, lr_0 = 1.9364e-04
Validation rmse = 0.639360
Epoch 22
Loss = 4.3663e-03, PNorm = 37.7760, GNorm = 1.2723, lr_0 = 1.9081e-04
Loss = 4.6657e-03, PNorm = 37.7813, GNorm = 1.6208, lr_0 = 1.8803e-04
Loss = 4.7033e-03, PNorm = 37.7880, GNorm = 0.7892, lr_0 = 1.8529e-04
Loss = 5.2616e-03, PNorm = 37.8011, GNorm = 2.9966, lr_0 = 1.8259e-04
Loss = 5.2702e-03, PNorm = 37.8122, GNorm = 1.2073, lr_0 = 1.7993e-04
Validation rmse = 0.632158
Epoch 23
Loss = 3.1855e-03, PNorm = 37.8194, GNorm = 2.3889, lr_0 = 1.7731e-04
Loss = 5.0667e-03, PNorm = 37.8273, GNorm = 1.2843, lr_0 = 1.7472e-04
Loss = 5.3537e-03, PNorm = 37.8372, GNorm = 2.6887, lr_0 = 1.7217e-04
Loss = 4.6849e-03, PNorm = 37.8460, GNorm = 2.2586, lr_0 = 1.6966e-04
Loss = 4.5425e-03, PNorm = 37.8515, GNorm = 2.7649, lr_0 = 1.6719e-04
Loss = 5.2397e-03, PNorm = 37.8589, GNorm = 1.9549, lr_0 = 1.6475e-04
Validation rmse = 0.634913
Epoch 24
Loss = 5.4181e-03, PNorm = 37.8671, GNorm = 3.7383, lr_0 = 1.6235e-04
Loss = 4.5291e-03, PNorm = 37.8760, GNorm = 2.3922, lr_0 = 1.5999e-04
Loss = 5.1892e-03, PNorm = 37.8826, GNorm = 1.6242, lr_0 = 1.5765e-04
Loss = 4.8731e-03, PNorm = 37.8898, GNorm = 3.0276, lr_0 = 1.5536e-04
Loss = 4.6258e-03, PNorm = 37.8964, GNorm = 1.9350, lr_0 = 1.5309e-04
Loss = 4.1353e-03, PNorm = 37.9017, GNorm = 1.1466, lr_0 = 1.5086e-04
Validation rmse = 0.639093
Epoch 25
Loss = 4.0450e-03, PNorm = 37.9081, GNorm = 1.5755, lr_0 = 1.4866e-04
Loss = 4.6365e-03, PNorm = 37.9151, GNorm = 0.8582, lr_0 = 1.4649e-04
Loss = 5.4007e-03, PNorm = 37.9214, GNorm = 1.8702, lr_0 = 1.4436e-04
Loss = 4.5368e-03, PNorm = 37.9258, GNorm = 2.2822, lr_0 = 1.4225e-04
Loss = 4.6292e-03, PNorm = 37.9327, GNorm = 1.6449, lr_0 = 1.4018e-04
Validation rmse = 0.653268
Epoch 26
Loss = 5.2279e-03, PNorm = 37.9397, GNorm = 1.6950, lr_0 = 1.3814e-04
Loss = 4.0587e-03, PNorm = 37.9472, GNorm = 1.5650, lr_0 = 1.3612e-04
Loss = 5.0352e-03, PNorm = 37.9523, GNorm = 1.4527, lr_0 = 1.3414e-04
Loss = 3.9493e-03, PNorm = 37.9582, GNorm = 1.5714, lr_0 = 1.3218e-04
Loss = 4.8136e-03, PNorm = 37.9642, GNorm = 2.9674, lr_0 = 1.3026e-04
Loss = 4.8636e-03, PNorm = 37.9693, GNorm = 1.2609, lr_0 = 1.2836e-04
Validation rmse = 0.632042
Epoch 27
Loss = 4.3293e-03, PNorm = 37.9743, GNorm = 0.9110, lr_0 = 1.2649e-04
Loss = 4.8134e-03, PNorm = 37.9801, GNorm = 1.7627, lr_0 = 1.2464e-04
Loss = 3.9676e-03, PNorm = 37.9846, GNorm = 1.6476, lr_0 = 1.2282e-04
Loss = 4.8019e-03, PNorm = 37.9906, GNorm = 1.4625, lr_0 = 1.2103e-04
Loss = 4.5850e-03, PNorm = 37.9964, GNorm = 1.1105, lr_0 = 1.1927e-04
Validation rmse = 0.624686
Epoch 28
Loss = 4.0824e-03, PNorm = 38.0020, GNorm = 2.6173, lr_0 = 1.1753e-04
Loss = 4.2317e-03, PNorm = 38.0084, GNorm = 2.4001, lr_0 = 1.1582e-04
Loss = 4.4294e-03, PNorm = 38.0122, GNorm = 1.5433, lr_0 = 1.1413e-04
Loss = 3.7216e-03, PNorm = 38.0186, GNorm = 1.4530, lr_0 = 1.1247e-04
Loss = 5.3328e-03, PNorm = 38.0225, GNorm = 2.9871, lr_0 = 1.1083e-04
Loss = 4.6677e-03, PNorm = 38.0273, GNorm = 3.9866, lr_0 = 1.0921e-04
Validation rmse = 0.636303
Epoch 29
Loss = 4.0120e-03, PNorm = 38.0320, GNorm = 1.4847, lr_0 = 1.0762e-04
Loss = 4.4812e-03, PNorm = 38.0362, GNorm = 1.5465, lr_0 = 1.0605e-04
Loss = 3.8580e-03, PNorm = 38.0412, GNorm = 1.1633, lr_0 = 1.0450e-04
Loss = 3.9575e-03, PNorm = 38.0454, GNorm = 4.1514, lr_0 = 1.0298e-04
Loss = 4.5252e-03, PNorm = 38.0488, GNorm = 1.6323, lr_0 = 1.0148e-04
Loss = 5.2531e-03, PNorm = 38.0530, GNorm = 1.3844, lr_0 = 1.0000e-04
Validation rmse = 0.619786
Model 0 best validation rmse = 0.619786 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.692200
Ensemble test rmse = 0.692200
1-fold cross validation
Seed 0 ==> test rmse = 0.692200
Overall test rmse = 0.692200 +/- 0.000000
Fold 0
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'cuda': True,
 'data_path': 'dopamine.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cache': False,
 'num_folds': 5,
 'num_lrs': 1,
 'quiet': False,
 'save_dir': 'runs\\fold_0',
 'save_smiles_splits': False,
 'seed': 42,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'test': False,
 'test_fold_index': None,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': None,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 42
Total size = 3,504 | train size = 2,803 | val size = 350 | test size = 351
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Moving model to cuda
Epoch 0
Loss = 2.0315e-02, PNorm = 33.9336, GNorm = 5.1933, lr_0 = 1.8036e-04
Loss = 2.0629e-02, PNorm = 33.9367, GNorm = 2.8888, lr_0 = 2.6071e-04
Loss = 1.9793e-02, PNorm = 33.9453, GNorm = 3.5975, lr_0 = 3.4107e-04
Loss = 1.9511e-02, PNorm = 33.9606, GNorm = 5.8313, lr_0 = 4.2143e-04
Loss = 1.7538e-02, PNorm = 33.9783, GNorm = 2.9195, lr_0 = 5.0179e-04
Validation rmse = 0.987372
Epoch 1
Loss = 1.6246e-02, PNorm = 34.0098, GNorm = 0.8253, lr_0 = 5.8214e-04
Loss = 1.5763e-02, PNorm = 34.0526, GNorm = 4.5818, lr_0 = 6.6250e-04
Loss = 1.4494e-02, PNorm = 34.0959, GNorm = 2.6939, lr_0 = 7.4286e-04
Loss = 1.4516e-02, PNorm = 34.1489, GNorm = 3.1846, lr_0 = 8.2321e-04
Loss = 1.4778e-02, PNorm = 34.2117, GNorm = 6.8008, lr_0 = 9.0357e-04
Loss = 1.3791e-02, PNorm = 34.2778, GNorm = 5.4603, lr_0 = 9.8393e-04
Validation rmse = 0.972128
Epoch 2
Loss = 1.3215e-02, PNorm = 34.3585, GNorm = 1.6215, lr_0 = 9.8832e-04
Loss = 1.3772e-02, PNorm = 34.4561, GNorm = 1.3429, lr_0 = 9.7391e-04
Loss = 1.3202e-02, PNorm = 34.5212, GNorm = 0.7049, lr_0 = 9.5972e-04
Loss = 1.1651e-02, PNorm = 34.5916, GNorm = 8.0237, lr_0 = 9.4573e-04
Loss = 1.1607e-02, PNorm = 34.6707, GNorm = 3.0554, lr_0 = 9.3194e-04
Validation rmse = 0.870576
Epoch 3
Loss = 1.0373e-02, PNorm = 34.7531, GNorm = 2.8605, lr_0 = 9.1835e-04
Loss = 1.0058e-02, PNorm = 34.8288, GNorm = 4.2503, lr_0 = 9.0497e-04
Loss = 1.1859e-02, PNorm = 34.8979, GNorm = 2.0367, lr_0 = 8.9177e-04
Loss = 1.2594e-02, PNorm = 34.9685, GNorm = 2.7524, lr_0 = 8.7877e-04
Loss = 1.0540e-02, PNorm = 35.0414, GNorm = 2.1676, lr_0 = 8.6596e-04
Loss = 1.1145e-02, PNorm = 35.1055, GNorm = 4.4978, lr_0 = 8.5334e-04
Validation rmse = 0.847508
Epoch 4
Loss = 1.0066e-02, PNorm = 35.1721, GNorm = 2.0796, lr_0 = 8.4090e-04
Loss = 1.1158e-02, PNorm = 35.2513, GNorm = 8.4164, lr_0 = 8.2864e-04
Loss = 1.0597e-02, PNorm = 35.3030, GNorm = 2.3271, lr_0 = 8.1656e-04
Loss = 8.7220e-03, PNorm = 35.3487, GNorm = 3.7988, lr_0 = 8.0466e-04
Loss = 8.8507e-03, PNorm = 35.4008, GNorm = 2.7494, lr_0 = 7.9293e-04
Loss = 1.0056e-02, PNorm = 35.4522, GNorm = 1.5032, lr_0 = 7.8137e-04
Validation rmse = 0.881046
Epoch 5
Loss = 9.1258e-03, PNorm = 35.5064, GNorm = 0.9238, lr_0 = 7.6998e-04
Loss = 9.2573e-03, PNorm = 35.5632, GNorm = 2.8374, lr_0 = 7.5876e-04
Loss = 9.6791e-03, PNorm = 35.6240, GNorm = 1.4496, lr_0 = 7.4770e-04
Loss = 9.7257e-03, PNorm = 35.6748, GNorm = 4.3042, lr_0 = 7.3680e-04
Loss = 9.3614e-03, PNorm = 35.7249, GNorm = 1.5653, lr_0 = 7.2605e-04
Validation rmse = 0.805784
Epoch 6
Loss = 9.7822e-03, PNorm = 35.7704, GNorm = 7.3638, lr_0 = 7.1547e-04
Loss = 8.5154e-03, PNorm = 35.8146, GNorm = 1.4967, lr_0 = 7.0504e-04
Loss = 8.5048e-03, PNorm = 35.8591, GNorm = 3.7414, lr_0 = 6.9476e-04
Loss = 9.1670e-03, PNorm = 35.9130, GNorm = 3.6160, lr_0 = 6.8464e-04
Loss = 1.0045e-02, PNorm = 35.9702, GNorm = 1.9418, lr_0 = 6.7465e-04
Loss = 8.5885e-03, PNorm = 36.0155, GNorm = 1.8545, lr_0 = 6.6482e-04
Validation rmse = 0.820716
Epoch 7
Loss = 8.0675e-03, PNorm = 36.0521, GNorm = 1.1775, lr_0 = 6.5513e-04
Loss = 8.3650e-03, PNorm = 36.0925, GNorm = 1.0658, lr_0 = 6.4558e-04
Loss = 8.9497e-03, PNorm = 36.1318, GNorm = 1.1624, lr_0 = 6.3617e-04
Loss = 7.7465e-03, PNorm = 36.1635, GNorm = 1.9551, lr_0 = 6.2689e-04
Loss = 8.1346e-03, PNorm = 36.1959, GNorm = 1.8252, lr_0 = 6.1776e-04
Validation rmse = 0.796196
Epoch 8
Loss = 9.0172e-03, PNorm = 36.2387, GNorm = 1.1947, lr_0 = 6.0875e-04
Loss = 7.1814e-03, PNorm = 36.2775, GNorm = 1.6152, lr_0 = 5.9988e-04
Loss = 7.7080e-03, PNorm = 36.3053, GNorm = 1.4446, lr_0 = 5.9113e-04
Loss = 7.6915e-03, PNorm = 36.3347, GNorm = 2.5947, lr_0 = 5.8251e-04
Loss = 7.7437e-03, PNorm = 36.3683, GNorm = 1.6734, lr_0 = 5.7402e-04
Loss = 7.8339e-03, PNorm = 36.4052, GNorm = 3.1796, lr_0 = 5.6565e-04
Validation rmse = 0.775299
Epoch 9
Loss = 7.9131e-03, PNorm = 36.4379, GNorm = 2.4330, lr_0 = 5.5741e-04
Loss = 7.6980e-03, PNorm = 36.4717, GNorm = 2.1421, lr_0 = 5.4928e-04
Loss = 7.0105e-03, PNorm = 36.5105, GNorm = 2.7096, lr_0 = 5.4128e-04
Loss = 7.2644e-03, PNorm = 36.5423, GNorm = 1.1966, lr_0 = 5.3339e-04
Loss = 6.0999e-03, PNorm = 36.5719, GNorm = 2.1687, lr_0 = 5.2561e-04
Loss = 7.6022e-03, PNorm = 36.5900, GNorm = 1.8396, lr_0 = 5.1795e-04
Validation rmse = 0.758339
Epoch 10
Loss = 7.4831e-03, PNorm = 36.6203, GNorm = 1.2716, lr_0 = 5.1040e-04
Loss = 6.9472e-03, PNorm = 36.6517, GNorm = 4.6552, lr_0 = 5.0296e-04
Loss = 7.2467e-03, PNorm = 36.6803, GNorm = 6.1995, lr_0 = 4.9562e-04
Loss = 6.1316e-03, PNorm = 36.7083, GNorm = 0.9833, lr_0 = 4.8840e-04
Loss = 6.3713e-03, PNorm = 36.7380, GNorm = 2.0144, lr_0 = 4.8128e-04
Validation rmse = 0.763611
Epoch 11
Loss = 6.9103e-03, PNorm = 36.7611, GNorm = 4.4529, lr_0 = 4.7426e-04
Loss = 6.0741e-03, PNorm = 36.7913, GNorm = 1.2934, lr_0 = 4.6735e-04
Loss = 6.4084e-03, PNorm = 36.8221, GNorm = 1.1631, lr_0 = 4.6054e-04
Loss = 5.8036e-03, PNorm = 36.8552, GNorm = 2.1146, lr_0 = 4.5382e-04
Loss = 6.4718e-03, PNorm = 36.8776, GNorm = 2.5935, lr_0 = 4.4721e-04
Loss = 6.9769e-03, PNorm = 36.8904, GNorm = 4.3197, lr_0 = 4.4069e-04
Validation rmse = 0.793657
Epoch 12
Loss = 6.7925e-03, PNorm = 36.9031, GNorm = 1.5557, lr_0 = 4.3427e-04
Loss = 6.2575e-03, PNorm = 36.9210, GNorm = 1.3034, lr_0 = 4.2793e-04
Loss = 5.8812e-03, PNorm = 36.9469, GNorm = 1.6497, lr_0 = 4.2170e-04
Loss = 5.9526e-03, PNorm = 36.9769, GNorm = 4.1649, lr_0 = 4.1555e-04
Loss = 7.4730e-03, PNorm = 36.9977, GNorm = 2.8936, lr_0 = 4.0949e-04
Validation rmse = 0.753681
Epoch 13
Loss = 5.9602e-03, PNorm = 37.0187, GNorm = 1.7862, lr_0 = 4.0352e-04
Loss = 6.4679e-03, PNorm = 37.0374, GNorm = 1.5483, lr_0 = 3.9764e-04
Loss = 6.8061e-03, PNorm = 37.0616, GNorm = 1.0891, lr_0 = 3.9184e-04
Loss = 6.1060e-03, PNorm = 37.0801, GNorm = 3.0923, lr_0 = 3.8613e-04
Loss = 6.2229e-03, PNorm = 37.1042, GNorm = 3.7663, lr_0 = 3.8050e-04
Loss = 5.8978e-03, PNorm = 37.1284, GNorm = 1.6367, lr_0 = 3.7496e-04
Validation rmse = 0.732278
Epoch 14
Loss = 5.2591e-03, PNorm = 37.1526, GNorm = 2.7896, lr_0 = 3.6949e-04
Loss = 5.7159e-03, PNorm = 37.1737, GNorm = 1.8780, lr_0 = 3.6410e-04
Loss = 6.2291e-03, PNorm = 37.1886, GNorm = 1.1745, lr_0 = 3.5880e-04
Loss = 6.6183e-03, PNorm = 37.2065, GNorm = 3.0585, lr_0 = 3.5357e-04
Loss = 6.1291e-03, PNorm = 37.2270, GNorm = 2.7205, lr_0 = 3.4841e-04
Loss = 4.9147e-03, PNorm = 37.2407, GNorm = 2.6858, lr_0 = 3.4333e-04
Validation rmse = 0.721393
Epoch 15
Loss = 5.9641e-03, PNorm = 37.2540, GNorm = 4.0433, lr_0 = 3.3833e-04
Loss = 5.7814e-03, PNorm = 37.2748, GNorm = 1.0213, lr_0 = 3.3340e-04
Loss = 6.1378e-03, PNorm = 37.2948, GNorm = 2.1158, lr_0 = 3.2853e-04
Loss = 5.3874e-03, PNorm = 37.3114, GNorm = 3.1328, lr_0 = 3.2375e-04
Loss = 5.5670e-03, PNorm = 37.3264, GNorm = 1.2226, lr_0 = 3.1903e-04
Validation rmse = 0.696777
Epoch 16
Loss = 4.5199e-03, PNorm = 37.3408, GNorm = 3.2866, lr_0 = 3.1438e-04
Loss = 5.6693e-03, PNorm = 37.3568, GNorm = 1.6406, lr_0 = 3.0979e-04
Loss = 5.2693e-03, PNorm = 37.3713, GNorm = 1.6648, lr_0 = 3.0528e-04
Loss = 5.7365e-03, PNorm = 37.3883, GNorm = 2.8101, lr_0 = 3.0083e-04
Loss = 5.5765e-03, PNorm = 37.4026, GNorm = 1.9362, lr_0 = 2.9644e-04
Loss = 5.7068e-03, PNorm = 37.4199, GNorm = 1.5750, lr_0 = 2.9212e-04
Validation rmse = 0.702029
Epoch 17
Loss = 4.8580e-03, PNorm = 37.4331, GNorm = 1.6093, lr_0 = 2.8786e-04
Loss = 5.5444e-03, PNorm = 37.4504, GNorm = 1.5748, lr_0 = 2.8367e-04
Loss = 4.9898e-03, PNorm = 37.4639, GNorm = 3.2355, lr_0 = 2.7953e-04
Loss = 5.5270e-03, PNorm = 37.4779, GNorm = 1.3711, lr_0 = 2.7546e-04
Loss = 5.7492e-03, PNorm = 37.4927, GNorm = 2.0779, lr_0 = 2.7144e-04
Validation rmse = 0.691616
Epoch 18
Loss = 3.4686e-03, PNorm = 37.5061, GNorm = 1.2367, lr_0 = 2.6748e-04
Loss = 5.6951e-03, PNorm = 37.5184, GNorm = 2.7821, lr_0 = 2.6358e-04
Loss = 5.5007e-03, PNorm = 37.5299, GNorm = 2.9309, lr_0 = 2.5974e-04
Loss = 4.9193e-03, PNorm = 37.5433, GNorm = 2.2379, lr_0 = 2.5595e-04
Loss = 5.9586e-03, PNorm = 37.5577, GNorm = 2.2335, lr_0 = 2.5222e-04
Loss = 4.6033e-03, PNorm = 37.5666, GNorm = 1.3167, lr_0 = 2.4855e-04
Validation rmse = 0.690583
Epoch 19
Loss = 5.0063e-03, PNorm = 37.5784, GNorm = 2.3031, lr_0 = 2.4492e-04
Loss = 4.9468e-03, PNorm = 37.5915, GNorm = 3.4129, lr_0 = 2.4135e-04
Loss = 5.5938e-03, PNorm = 37.6007, GNorm = 2.1296, lr_0 = 2.3783e-04
Loss = 5.7194e-03, PNorm = 37.6150, GNorm = 0.9818, lr_0 = 2.3437e-04
Loss = 4.4582e-03, PNorm = 37.6283, GNorm = 1.4268, lr_0 = 2.3095e-04
Loss = 4.8968e-03, PNorm = 37.6395, GNorm = 1.6687, lr_0 = 2.2758e-04
Validation rmse = 0.696895
Epoch 20
Loss = 4.6384e-03, PNorm = 37.6508, GNorm = 1.4472, lr_0 = 2.2427e-04
Loss = 5.1310e-03, PNorm = 37.6562, GNorm = 1.7987, lr_0 = 2.2100e-04
Loss = 5.0985e-03, PNorm = 37.6647, GNorm = 1.1162, lr_0 = 2.1778e-04
Loss = 5.4991e-03, PNorm = 37.6783, GNorm = 1.2120, lr_0 = 2.1460e-04
Loss = 4.7335e-03, PNorm = 37.6899, GNorm = 1.8169, lr_0 = 2.1147e-04
Validation rmse = 0.697845
Epoch 21
Loss = 4.8331e-03, PNorm = 37.7010, GNorm = 2.3059, lr_0 = 2.0839e-04
Loss = 4.8280e-03, PNorm = 37.7110, GNorm = 1.5657, lr_0 = 2.0535e-04
Loss = 5.0077e-03, PNorm = 37.7164, GNorm = 0.9350, lr_0 = 2.0236e-04
Loss = 4.6991e-03, PNorm = 37.7307, GNorm = 1.2916, lr_0 = 1.9941e-04
Loss = 4.7191e-03, PNorm = 37.7443, GNorm = 2.2249, lr_0 = 1.9650e-04
Loss = 4.5883e-03, PNorm = 37.7534, GNorm = 1.3331, lr_0 = 1.9364e-04
Validation rmse = 0.685014
Epoch 22
Loss = 4.5646e-03, PNorm = 37.7617, GNorm = 1.4893, lr_0 = 1.9081e-04
Loss = 4.8047e-03, PNorm = 37.7698, GNorm = 2.4705, lr_0 = 1.8803e-04
Loss = 5.6902e-03, PNorm = 37.7792, GNorm = 3.1691, lr_0 = 1.8529e-04
Loss = 4.9510e-03, PNorm = 37.7869, GNorm = 2.3383, lr_0 = 1.8259e-04
Loss = 5.0161e-03, PNorm = 37.7972, GNorm = 1.2980, lr_0 = 1.7993e-04
Validation rmse = 0.675641
Epoch 23
Loss = 4.0857e-03, PNorm = 37.8080, GNorm = 1.0364, lr_0 = 1.7731e-04
Loss = 4.1564e-03, PNorm = 37.8199, GNorm = 1.4466, lr_0 = 1.7472e-04
Loss = 5.1006e-03, PNorm = 37.8304, GNorm = 3.0541, lr_0 = 1.7217e-04
Loss = 5.0287e-03, PNorm = 37.8357, GNorm = 1.1497, lr_0 = 1.6966e-04
Loss = 4.0445e-03, PNorm = 37.8402, GNorm = 2.9002, lr_0 = 1.6719e-04
Loss = 5.1185e-03, PNorm = 37.8464, GNorm = 3.3121, lr_0 = 1.6475e-04
Validation rmse = 0.677816
Epoch 24
Loss = 5.0219e-03, PNorm = 37.8555, GNorm = 1.8756, lr_0 = 1.6235e-04
Loss = 5.0720e-03, PNorm = 37.8647, GNorm = 3.5740, lr_0 = 1.5999e-04
Loss = 4.7157e-03, PNorm = 37.8752, GNorm = 2.8695, lr_0 = 1.5765e-04
Loss = 4.2081e-03, PNorm = 37.8829, GNorm = 1.0939, lr_0 = 1.5536e-04
Loss = 3.9534e-03, PNorm = 37.8884, GNorm = 3.2326, lr_0 = 1.5309e-04
Loss = 5.0113e-03, PNorm = 37.8933, GNorm = 2.4203, lr_0 = 1.5086e-04
Validation rmse = 0.678662
Epoch 25
Loss = 4.6299e-03, PNorm = 37.8998, GNorm = 2.3499, lr_0 = 1.4866e-04
Loss = 5.0364e-03, PNorm = 37.9064, GNorm = 1.1419, lr_0 = 1.4649e-04
Loss = 4.4949e-03, PNorm = 37.9127, GNorm = 2.5986, lr_0 = 1.4436e-04
Loss = 4.3941e-03, PNorm = 37.9200, GNorm = 1.8793, lr_0 = 1.4225e-04
Loss = 4.2061e-03, PNorm = 37.9268, GNorm = 1.6358, lr_0 = 1.4018e-04
Validation rmse = 0.673482
Epoch 26
Loss = 4.7329e-03, PNorm = 37.9330, GNorm = 1.3152, lr_0 = 1.3814e-04
Loss = 4.4423e-03, PNorm = 37.9394, GNorm = 1.3882, lr_0 = 1.3612e-04
Loss = 4.3291e-03, PNorm = 37.9449, GNorm = 3.6715, lr_0 = 1.3414e-04
Loss = 4.3780e-03, PNorm = 37.9510, GNorm = 2.3355, lr_0 = 1.3218e-04
Loss = 4.7014e-03, PNorm = 37.9579, GNorm = 4.7863, lr_0 = 1.3026e-04
Loss = 4.6247e-03, PNorm = 37.9637, GNorm = 5.0035, lr_0 = 1.2836e-04
Validation rmse = 0.666652
Epoch 27
Loss = 4.0153e-03, PNorm = 37.9704, GNorm = 1.0774, lr_0 = 1.2649e-04
Loss = 4.1933e-03, PNorm = 37.9755, GNorm = 2.3318, lr_0 = 1.2464e-04
Loss = 3.8014e-03, PNorm = 37.9812, GNorm = 0.8798, lr_0 = 1.2282e-04
Loss = 4.3982e-03, PNorm = 37.9867, GNorm = 1.2098, lr_0 = 1.2103e-04
Loss = 5.8554e-03, PNorm = 37.9899, GNorm = 4.7842, lr_0 = 1.1927e-04
Validation rmse = 0.671155
Epoch 28
Loss = 5.4761e-03, PNorm = 37.9962, GNorm = 1.6226, lr_0 = 1.1753e-04
Loss = 4.2561e-03, PNorm = 38.0015, GNorm = 2.3234, lr_0 = 1.1582e-04
Loss = 4.3104e-03, PNorm = 38.0070, GNorm = 1.0540, lr_0 = 1.1413e-04
Loss = 4.3723e-03, PNorm = 38.0123, GNorm = 1.1817, lr_0 = 1.1247e-04
Loss = 4.0995e-03, PNorm = 38.0185, GNorm = 1.5560, lr_0 = 1.1083e-04
Loss = 4.2737e-03, PNorm = 38.0240, GNorm = 2.0114, lr_0 = 1.0921e-04
Validation rmse = 0.673469
Epoch 29
Loss = 4.1423e-03, PNorm = 38.0304, GNorm = 1.9803, lr_0 = 1.0762e-04
Loss = 3.9809e-03, PNorm = 38.0367, GNorm = 1.2692, lr_0 = 1.0605e-04
Loss = 4.5952e-03, PNorm = 38.0418, GNorm = 1.4331, lr_0 = 1.0450e-04
Loss = 4.3026e-03, PNorm = 38.0453, GNorm = 2.5318, lr_0 = 1.0298e-04
Loss = 4.0070e-03, PNorm = 38.0487, GNorm = 1.7172, lr_0 = 1.0148e-04
Loss = 4.3439e-03, PNorm = 38.0523, GNorm = 1.5131, lr_0 = 1.0000e-04
Validation rmse = 0.659324
Model 0 best validation rmse = 0.659324 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.662008
Ensemble test rmse = 0.662008
Fold 1
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'cuda': True,
 'data_path': 'dopamine.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cache': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'output_size': 1,
 'quiet': False,
 'save_dir': 'runs\\fold_1',
 'save_smiles_splits': False,
 'seed': 43,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'task_names': ['1.2218487496163564'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 2803,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': None,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 43
Total size = 3,504 | train size = 2,803 | val size = 350 | test size = 351
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Moving model to cuda
Epoch 0
Loss = 2.0513e-02, PNorm = 34.0038, GNorm = 4.7355, lr_0 = 1.8036e-04
Loss = 1.7396e-02, PNorm = 34.0076, GNorm = 2.2594, lr_0 = 2.6071e-04
Loss = 1.9008e-02, PNorm = 34.0183, GNorm = 1.0274, lr_0 = 3.4107e-04
Loss = 1.8387e-02, PNorm = 34.0399, GNorm = 0.7614, lr_0 = 4.2143e-04
Loss = 1.8035e-02, PNorm = 34.0546, GNorm = 3.4985, lr_0 = 5.0179e-04
Validation rmse = 1.107790
Epoch 1
Loss = 1.6482e-02, PNorm = 34.0759, GNorm = 2.0710, lr_0 = 5.8214e-04
Loss = 1.5927e-02, PNorm = 34.1122, GNorm = 2.5896, lr_0 = 6.6250e-04
Loss = 1.4862e-02, PNorm = 34.1518, GNorm = 3.3892, lr_0 = 7.4286e-04
Loss = 1.6177e-02, PNorm = 34.1936, GNorm = 3.7313, lr_0 = 8.2321e-04
Loss = 1.6966e-02, PNorm = 34.2435, GNorm = 0.9017, lr_0 = 9.0357e-04
Loss = 1.5852e-02, PNorm = 34.3000, GNorm = 1.3667, lr_0 = 9.8393e-04
Validation rmse = 1.026230
Epoch 2
Loss = 1.5496e-02, PNorm = 34.3853, GNorm = 0.6140, lr_0 = 9.8832e-04
Loss = 1.3645e-02, PNorm = 34.4542, GNorm = 4.5964, lr_0 = 9.7391e-04
Loss = 1.4048e-02, PNorm = 34.5389, GNorm = 2.9266, lr_0 = 9.5972e-04
Loss = 1.1348e-02, PNorm = 34.6124, GNorm = 2.4093, lr_0 = 9.4573e-04
Loss = 1.2436e-02, PNorm = 34.6797, GNorm = 1.1321, lr_0 = 9.3194e-04
Validation rmse = 0.916834
Epoch 3
Loss = 1.4087e-02, PNorm = 34.7514, GNorm = 5.8096, lr_0 = 9.1835e-04
Loss = 1.2953e-02, PNorm = 34.8322, GNorm = 4.7307, lr_0 = 9.0497e-04
Loss = 1.3908e-02, PNorm = 34.9114, GNorm = 2.6542, lr_0 = 8.9177e-04
Loss = 1.2502e-02, PNorm = 34.9946, GNorm = 2.8426, lr_0 = 8.7877e-04
Loss = 1.0766e-02, PNorm = 35.0784, GNorm = 0.8874, lr_0 = 8.6596e-04
Loss = 1.1152e-02, PNorm = 35.1547, GNorm = 2.3312, lr_0 = 8.5334e-04
Validation rmse = 0.858603
Epoch 4
Loss = 1.1328e-02, PNorm = 35.2104, GNorm = 2.6629, lr_0 = 8.4090e-04
Loss = 9.8649e-03, PNorm = 35.2809, GNorm = 1.9084, lr_0 = 8.2864e-04
Loss = 9.1699e-03, PNorm = 35.3516, GNorm = 1.5104, lr_0 = 8.1656e-04
Loss = 1.1526e-02, PNorm = 35.4212, GNorm = 4.5682, lr_0 = 8.0466e-04
Loss = 9.7804e-03, PNorm = 35.4828, GNorm = 0.9322, lr_0 = 7.9293e-04
Loss = 1.0760e-02, PNorm = 35.5323, GNorm = 1.9856, lr_0 = 7.8137e-04
Validation rmse = 0.840516
Epoch 5
Loss = 1.0707e-02, PNorm = 35.5770, GNorm = 2.3465, lr_0 = 7.6998e-04
Loss = 9.1590e-03, PNorm = 35.6345, GNorm = 2.8881, lr_0 = 7.5876e-04
Loss = 9.1507e-03, PNorm = 35.6816, GNorm = 0.9240, lr_0 = 7.4770e-04
Loss = 1.0090e-02, PNorm = 35.7365, GNorm = 3.6002, lr_0 = 7.3680e-04
Loss = 9.1204e-03, PNorm = 35.7854, GNorm = 0.8540, lr_0 = 7.2605e-04
Validation rmse = 0.826215
Epoch 6
Loss = 8.9998e-03, PNorm = 35.8432, GNorm = 0.8418, lr_0 = 7.1547e-04
Loss = 9.4158e-03, PNorm = 35.8976, GNorm = 2.4693, lr_0 = 7.0504e-04
Loss = 8.5792e-03, PNorm = 35.9487, GNorm = 2.1717, lr_0 = 6.9476e-04
Loss = 8.8114e-03, PNorm = 35.9916, GNorm = 1.8214, lr_0 = 6.8464e-04
Loss = 8.0099e-03, PNorm = 36.0248, GNorm = 0.8615, lr_0 = 6.7465e-04
Loss = 9.5442e-03, PNorm = 36.0712, GNorm = 0.9782, lr_0 = 6.6482e-04
Validation rmse = 0.803048
Epoch 7
Loss = 7.9445e-03, PNorm = 36.0991, GNorm = 2.1745, lr_0 = 6.5513e-04
Loss = 8.2755e-03, PNorm = 36.1286, GNorm = 0.8526, lr_0 = 6.4558e-04
Loss = 8.0418e-03, PNorm = 36.1626, GNorm = 1.7768, lr_0 = 6.3617e-04
Loss = 9.1231e-03, PNorm = 36.1991, GNorm = 3.3095, lr_0 = 6.2689e-04
Loss = 8.0214e-03, PNorm = 36.2284, GNorm = 1.6009, lr_0 = 6.1776e-04
Validation rmse = 0.743773
Epoch 8
Loss = 6.7650e-03, PNorm = 36.2773, GNorm = 1.6293, lr_0 = 6.0875e-04
Loss = 7.2376e-03, PNorm = 36.3143, GNorm = 1.2892, lr_0 = 5.9988e-04
Loss = 8.4790e-03, PNorm = 36.3428, GNorm = 5.1330, lr_0 = 5.9113e-04
Loss = 8.1482e-03, PNorm = 36.3744, GNorm = 1.8179, lr_0 = 5.8251e-04
Loss = 7.2510e-03, PNorm = 36.4036, GNorm = 1.1470, lr_0 = 5.7402e-04
Loss = 7.3345e-03, PNorm = 36.4304, GNorm = 3.8982, lr_0 = 5.6565e-04
Validation rmse = 0.725572
Epoch 9
Loss = 7.1723e-03, PNorm = 36.4586, GNorm = 1.5373, lr_0 = 5.5741e-04
Loss = 6.4946e-03, PNorm = 36.4951, GNorm = 1.2094, lr_0 = 5.4928e-04
Loss = 7.0004e-03, PNorm = 36.5282, GNorm = 1.5177, lr_0 = 5.4128e-04
Loss = 8.4266e-03, PNorm = 36.5537, GNorm = 1.0802, lr_0 = 5.3339e-04
Loss = 7.2978e-03, PNorm = 36.5866, GNorm = 3.2041, lr_0 = 5.2561e-04
Loss = 7.4284e-03, PNorm = 36.6113, GNorm = 2.4432, lr_0 = 5.1795e-04
Validation rmse = 0.747914
Epoch 10
Loss = 6.2964e-03, PNorm = 36.6395, GNorm = 1.5358, lr_0 = 5.1040e-04
Loss = 6.7222e-03, PNorm = 36.6682, GNorm = 2.4591, lr_0 = 5.0296e-04
Loss = 8.2541e-03, PNorm = 36.7029, GNorm = 2.2954, lr_0 = 4.9562e-04
Loss = 7.5389e-03, PNorm = 36.7203, GNorm = 2.9526, lr_0 = 4.8840e-04
Loss = 7.4150e-03, PNorm = 36.7426, GNorm = 1.1915, lr_0 = 4.8128e-04
Validation rmse = 0.758299
Epoch 11
Loss = 6.2200e-03, PNorm = 36.7734, GNorm = 1.4644, lr_0 = 4.7426e-04
Loss = 6.5050e-03, PNorm = 36.8030, GNorm = 1.6565, lr_0 = 4.6735e-04
Loss = 5.8123e-03, PNorm = 36.8258, GNorm = 2.5809, lr_0 = 4.6054e-04
Loss = 6.9873e-03, PNorm = 36.8502, GNorm = 0.8793, lr_0 = 4.5382e-04
Loss = 7.5318e-03, PNorm = 36.8746, GNorm = 5.3548, lr_0 = 4.4721e-04
Loss = 7.1689e-03, PNorm = 36.8991, GNorm = 1.8179, lr_0 = 4.4069e-04
Validation rmse = 0.742620
Epoch 12
Loss = 6.7055e-03, PNorm = 36.9210, GNorm = 3.0650, lr_0 = 4.3427e-04
Loss = 5.6847e-03, PNorm = 36.9539, GNorm = 1.1773, lr_0 = 4.2793e-04
Loss = 6.5729e-03, PNorm = 36.9743, GNorm = 1.0987, lr_0 = 4.2170e-04
Loss = 7.2418e-03, PNorm = 36.9935, GNorm = 3.0170, lr_0 = 4.1555e-04
Loss = 5.9200e-03, PNorm = 37.0212, GNorm = 1.6147, lr_0 = 4.0949e-04
Validation rmse = 0.709189
Epoch 13
Loss = 6.2098e-03, PNorm = 37.0426, GNorm = 2.5568, lr_0 = 4.0352e-04
Loss = 5.6843e-03, PNorm = 37.0630, GNorm = 2.4007, lr_0 = 3.9764e-04
Loss = 6.3197e-03, PNorm = 37.0777, GNorm = 1.3407, lr_0 = 3.9184e-04
Loss = 5.8046e-03, PNorm = 37.0974, GNorm = 1.4687, lr_0 = 3.8613e-04
Loss = 6.4554e-03, PNorm = 37.1169, GNorm = 1.1963, lr_0 = 3.8050e-04
Loss = 6.8932e-03, PNorm = 37.1377, GNorm = 1.6588, lr_0 = 3.7496e-04
Validation rmse = 0.719224
Epoch 14
Loss = 5.7208e-03, PNorm = 37.1642, GNorm = 1.4199, lr_0 = 3.6949e-04
Loss = 6.0169e-03, PNorm = 37.1886, GNorm = 4.6631, lr_0 = 3.6410e-04
Loss = 6.6136e-03, PNorm = 37.2063, GNorm = 3.2017, lr_0 = 3.5880e-04
Loss = 5.6999e-03, PNorm = 37.2247, GNorm = 1.6185, lr_0 = 3.5357e-04
Loss = 6.3799e-03, PNorm = 37.2428, GNorm = 1.1015, lr_0 = 3.4841e-04
Loss = 6.1685e-03, PNorm = 37.2552, GNorm = 1.1978, lr_0 = 3.4333e-04
Validation rmse = 0.691979
Epoch 15
Loss = 5.2506e-03, PNorm = 37.2741, GNorm = 3.3137, lr_0 = 3.3833e-04
Loss = 6.4170e-03, PNorm = 37.2885, GNorm = 2.6569, lr_0 = 3.3340e-04
Loss = 5.6930e-03, PNorm = 37.3057, GNorm = 1.2536, lr_0 = 3.2853e-04
Loss = 5.4963e-03, PNorm = 37.3233, GNorm = 2.9129, lr_0 = 3.2375e-04
Loss = 5.9924e-03, PNorm = 37.3429, GNorm = 1.9418, lr_0 = 3.1903e-04
Validation rmse = 0.707610
Epoch 16
Loss = 6.0062e-03, PNorm = 37.3577, GNorm = 4.4427, lr_0 = 3.1438e-04
Loss = 4.7238e-03, PNorm = 37.3679, GNorm = 2.0201, lr_0 = 3.0979e-04
Loss = 6.2729e-03, PNorm = 37.3786, GNorm = 2.4988, lr_0 = 3.0528e-04
Loss = 4.8637e-03, PNorm = 37.3961, GNorm = 1.9273, lr_0 = 3.0083e-04
Loss = 5.6898e-03, PNorm = 37.4141, GNorm = 2.3769, lr_0 = 2.9644e-04
Loss = 5.9207e-03, PNorm = 37.4308, GNorm = 3.7890, lr_0 = 2.9212e-04
Validation rmse = 0.693420
Epoch 17
Loss = 5.5622e-03, PNorm = 37.4447, GNorm = 2.6148, lr_0 = 2.8786e-04
Loss = 5.1727e-03, PNorm = 37.4553, GNorm = 1.6312, lr_0 = 2.8367e-04
Loss = 5.4108e-03, PNorm = 37.4663, GNorm = 2.0004, lr_0 = 2.7953e-04
Loss = 5.2633e-03, PNorm = 37.4786, GNorm = 1.7551, lr_0 = 2.7546e-04
Loss = 5.6093e-03, PNorm = 37.4933, GNorm = 1.8186, lr_0 = 2.7144e-04
Validation rmse = 0.704832
Epoch 18
Loss = 5.6125e-03, PNorm = 37.5080, GNorm = 1.6205, lr_0 = 2.6748e-04
Loss = 4.9440e-03, PNorm = 37.5225, GNorm = 2.5642, lr_0 = 2.6358e-04
Loss = 5.4528e-03, PNorm = 37.5363, GNorm = 2.6110, lr_0 = 2.5974e-04
Loss = 5.0389e-03, PNorm = 37.5461, GNorm = 1.5120, lr_0 = 2.5595e-04
Loss = 5.3094e-03, PNorm = 37.5569, GNorm = 2.2306, lr_0 = 2.5222e-04
Loss = 5.4574e-03, PNorm = 37.5676, GNorm = 1.6940, lr_0 = 2.4855e-04
Validation rmse = 0.678078
Epoch 19
Loss = 5.4542e-03, PNorm = 37.5797, GNorm = 3.7874, lr_0 = 2.4492e-04
Loss = 5.3292e-03, PNorm = 37.5920, GNorm = 0.8649, lr_0 = 2.4135e-04
Loss = 4.9574e-03, PNorm = 37.6021, GNorm = 1.1492, lr_0 = 2.3783e-04
Loss = 4.9195e-03, PNorm = 37.6128, GNorm = 1.5867, lr_0 = 2.3437e-04
Loss = 4.8427e-03, PNorm = 37.6244, GNorm = 2.6153, lr_0 = 2.3095e-04
Loss = 5.2040e-03, PNorm = 37.6351, GNorm = 1.8513, lr_0 = 2.2758e-04
Validation rmse = 0.682228
Epoch 20
Loss = 5.3271e-03, PNorm = 37.6453, GNorm = 2.9360, lr_0 = 2.2427e-04
Loss = 4.5667e-03, PNorm = 37.6560, GNorm = 1.4949, lr_0 = 2.2100e-04
Loss = 4.3574e-03, PNorm = 37.6666, GNorm = 1.6935, lr_0 = 2.1778e-04
Loss = 5.0425e-03, PNorm = 37.6736, GNorm = 4.2470, lr_0 = 2.1460e-04
Loss = 5.0958e-03, PNorm = 37.6813, GNorm = 3.0877, lr_0 = 2.1147e-04
Validation rmse = 0.702551
Epoch 21
Loss = 5.4943e-03, PNorm = 37.6894, GNorm = 1.3158, lr_0 = 2.0839e-04
Loss = 4.5820e-03, PNorm = 37.7009, GNorm = 3.2553, lr_0 = 2.0535e-04
Loss = 5.4685e-03, PNorm = 37.7124, GNorm = 3.3702, lr_0 = 2.0236e-04
Loss = 4.9100e-03, PNorm = 37.7203, GNorm = 3.8418, lr_0 = 1.9941e-04
Loss = 4.9829e-03, PNorm = 37.7261, GNorm = 2.8273, lr_0 = 1.9650e-04
Loss = 5.0389e-03, PNorm = 37.7348, GNorm = 2.2129, lr_0 = 1.9364e-04
Validation rmse = 0.672649
Epoch 22
Loss = 4.3561e-03, PNorm = 37.7431, GNorm = 1.0283, lr_0 = 1.9081e-04
Loss = 4.7782e-03, PNorm = 37.7525, GNorm = 2.6997, lr_0 = 1.8803e-04
Loss = 5.1865e-03, PNorm = 37.7604, GNorm = 1.5082, lr_0 = 1.8529e-04
Loss = 4.3899e-03, PNorm = 37.7697, GNorm = 1.1856, lr_0 = 1.8259e-04
Loss = 5.2083e-03, PNorm = 37.7760, GNorm = 1.1227, lr_0 = 1.7993e-04
Validation rmse = 0.665283
Epoch 23
Loss = 4.8130e-03, PNorm = 37.7840, GNorm = 2.8889, lr_0 = 1.7731e-04
Loss = 4.5888e-03, PNorm = 37.7947, GNorm = 2.5156, lr_0 = 1.7472e-04
Loss = 4.7016e-03, PNorm = 37.8019, GNorm = 1.4597, lr_0 = 1.7217e-04
Loss = 5.0660e-03, PNorm = 37.8077, GNorm = 1.3792, lr_0 = 1.6966e-04
Loss = 4.5039e-03, PNorm = 37.8183, GNorm = 2.8192, lr_0 = 1.6719e-04
Loss = 5.3891e-03, PNorm = 37.8223, GNorm = 1.9507, lr_0 = 1.6475e-04
Validation rmse = 0.673566
Epoch 24
Loss = 4.4890e-03, PNorm = 37.8273, GNorm = 1.0938, lr_0 = 1.6235e-04
Loss = 4.6695e-03, PNorm = 37.8365, GNorm = 0.9360, lr_0 = 1.5999e-04
Loss = 4.1645e-03, PNorm = 37.8436, GNorm = 1.8155, lr_0 = 1.5765e-04
Loss = 4.5157e-03, PNorm = 37.8499, GNorm = 2.4180, lr_0 = 1.5536e-04
Loss = 5.5013e-03, PNorm = 37.8545, GNorm = 2.5500, lr_0 = 1.5309e-04
Loss = 4.3189e-03, PNorm = 37.8582, GNorm = 1.2614, lr_0 = 1.5086e-04
Validation rmse = 0.675282
Epoch 25
Loss = 4.8763e-03, PNorm = 37.8660, GNorm = 1.4560, lr_0 = 1.4866e-04
Loss = 4.1743e-03, PNorm = 37.8729, GNorm = 3.0512, lr_0 = 1.4649e-04
Loss = 4.9790e-03, PNorm = 37.8780, GNorm = 2.6552, lr_0 = 1.4436e-04
Loss = 4.6175e-03, PNorm = 37.8816, GNorm = 1.5337, lr_0 = 1.4225e-04
Loss = 4.7078e-03, PNorm = 37.8879, GNorm = 1.4103, lr_0 = 1.4018e-04
Validation rmse = 0.666087
Epoch 26
Loss = 4.0725e-03, PNorm = 37.8929, GNorm = 2.3263, lr_0 = 1.3814e-04
Loss = 3.9848e-03, PNorm = 37.8995, GNorm = 2.6106, lr_0 = 1.3612e-04
Loss = 4.7051e-03, PNorm = 37.9048, GNorm = 1.0797, lr_0 = 1.3414e-04
Loss = 4.5717e-03, PNorm = 37.9094, GNorm = 1.9489, lr_0 = 1.3218e-04
Loss = 5.3277e-03, PNorm = 37.9151, GNorm = 4.8990, lr_0 = 1.3026e-04
Loss = 5.4387e-03, PNorm = 37.9211, GNorm = 1.4405, lr_0 = 1.2836e-04
Validation rmse = 0.724939
Epoch 27
Loss = 4.6067e-03, PNorm = 37.9276, GNorm = 1.9171, lr_0 = 1.2649e-04
Loss = 4.7168e-03, PNorm = 37.9335, GNorm = 3.2478, lr_0 = 1.2464e-04
Loss = 4.3694e-03, PNorm = 37.9366, GNorm = 3.0008, lr_0 = 1.2282e-04
Loss = 4.3553e-03, PNorm = 37.9419, GNorm = 1.8822, lr_0 = 1.2103e-04
Loss = 4.5786e-03, PNorm = 37.9464, GNorm = 3.4561, lr_0 = 1.1927e-04
Validation rmse = 0.662228
Epoch 28
Loss = 5.1611e-03, PNorm = 37.9510, GNorm = 1.3561, lr_0 = 1.1753e-04
Loss = 4.3178e-03, PNorm = 37.9564, GNorm = 2.6888, lr_0 = 1.1582e-04
Loss = 3.8047e-03, PNorm = 37.9613, GNorm = 2.4037, lr_0 = 1.1413e-04
Loss = 4.3842e-03, PNorm = 37.9674, GNorm = 1.6225, lr_0 = 1.1247e-04
Loss = 4.4108e-03, PNorm = 37.9729, GNorm = 1.2343, lr_0 = 1.1083e-04
Loss = 4.7826e-03, PNorm = 37.9761, GNorm = 3.9208, lr_0 = 1.0921e-04
Validation rmse = 0.699826
Epoch 29
Loss = 4.3131e-03, PNorm = 37.9783, GNorm = 1.5861, lr_0 = 1.0762e-04
Loss = 4.4733e-03, PNorm = 37.9801, GNorm = 1.9450, lr_0 = 1.0605e-04
Loss = 4.7240e-03, PNorm = 37.9847, GNorm = 1.3683, lr_0 = 1.0450e-04
Loss = 3.9522e-03, PNorm = 37.9901, GNorm = 1.4584, lr_0 = 1.0298e-04
Loss = 4.7306e-03, PNorm = 37.9949, GNorm = 3.1874, lr_0 = 1.0148e-04
Loss = 4.2514e-03, PNorm = 37.9989, GNorm = 2.3920, lr_0 = 1.0000e-04
Validation rmse = 0.662206
Model 0 best validation rmse = 0.662206 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.673568
Ensemble test rmse = 0.673568
Fold 2
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'cuda': True,
 'data_path': 'dopamine.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cache': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'output_size': 1,
 'quiet': False,
 'save_dir': 'runs\\fold_2',
 'save_smiles_splits': False,
 'seed': 44,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'task_names': ['1.2218487496163564'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 2803,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': None,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 44
Total size = 3,504 | train size = 2,803 | val size = 350 | test size = 351
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Moving model to cuda
Epoch 0
Loss = 1.9910e-02, PNorm = 34.0562, GNorm = 1.7602, lr_0 = 1.8036e-04
Loss = 1.9118e-02, PNorm = 34.0602, GNorm = 4.9666, lr_0 = 2.6071e-04
Loss = 1.9125e-02, PNorm = 34.0680, GNorm = 7.2475, lr_0 = 3.4107e-04
Loss = 1.8432e-02, PNorm = 34.0786, GNorm = 0.7241, lr_0 = 4.2143e-04
Loss = 1.7683e-02, PNorm = 34.0994, GNorm = 4.5418, lr_0 = 5.0179e-04
Validation rmse = 1.075184
Epoch 1
Loss = 1.5627e-02, PNorm = 34.1309, GNorm = 4.5744, lr_0 = 5.8214e-04
Loss = 1.4914e-02, PNorm = 34.1602, GNorm = 2.8173, lr_0 = 6.6250e-04
Loss = 1.6978e-02, PNorm = 34.2018, GNorm = 6.8056, lr_0 = 7.4286e-04
Loss = 1.4174e-02, PNorm = 34.2571, GNorm = 4.4521, lr_0 = 8.2321e-04
Loss = 1.7815e-02, PNorm = 34.3144, GNorm = 0.7908, lr_0 = 9.0357e-04
Loss = 1.4659e-02, PNorm = 34.3849, GNorm = 0.8096, lr_0 = 9.8393e-04
Validation rmse = 1.047524
Epoch 2
Loss = 1.2098e-02, PNorm = 34.4673, GNorm = 0.9544, lr_0 = 9.8832e-04
Loss = 1.3231e-02, PNorm = 34.5437, GNorm = 0.6352, lr_0 = 9.7391e-04
Loss = 1.2765e-02, PNorm = 34.6162, GNorm = 1.9682, lr_0 = 9.5972e-04
Loss = 1.3183e-02, PNorm = 34.6800, GNorm = 1.3900, lr_0 = 9.4573e-04
Loss = 1.4794e-02, PNorm = 34.7682, GNorm = 1.4736, lr_0 = 9.3194e-04
Validation rmse = 0.919629
Epoch 3
Loss = 1.0608e-02, PNorm = 34.8399, GNorm = 3.7562, lr_0 = 9.1835e-04
Loss = 1.1002e-02, PNorm = 34.9152, GNorm = 6.0520, lr_0 = 9.0497e-04
Loss = 1.5645e-02, PNorm = 34.9985, GNorm = 1.6074, lr_0 = 8.9177e-04
Loss = 1.2397e-02, PNorm = 35.0928, GNorm = 1.0046, lr_0 = 8.7877e-04
Loss = 1.2531e-02, PNorm = 35.1716, GNorm = 1.3092, lr_0 = 8.6596e-04
Loss = 1.0253e-02, PNorm = 35.2498, GNorm = 0.9598, lr_0 = 8.5334e-04
Validation rmse = 0.892303
Epoch 4
Loss = 1.1780e-02, PNorm = 35.3166, GNorm = 3.0347, lr_0 = 8.4090e-04
Loss = 1.2800e-02, PNorm = 35.3818, GNorm = 3.2348, lr_0 = 8.2864e-04
Loss = 1.1734e-02, PNorm = 35.4721, GNorm = 2.2200, lr_0 = 8.1656e-04
Loss = 9.5636e-03, PNorm = 35.5458, GNorm = 2.0564, lr_0 = 8.0466e-04
Loss = 1.0383e-02, PNorm = 35.5997, GNorm = 1.0472, lr_0 = 7.9293e-04
Loss = 1.0231e-02, PNorm = 35.6524, GNorm = 1.8905, lr_0 = 7.8137e-04
Validation rmse = 0.879551
Epoch 5
Loss = 1.1780e-02, PNorm = 35.7072, GNorm = 1.4278, lr_0 = 7.6998e-04
Loss = 9.8906e-03, PNorm = 35.7584, GNorm = 1.5899, lr_0 = 7.5876e-04
Loss = 9.7852e-03, PNorm = 35.8158, GNorm = 2.1867, lr_0 = 7.4770e-04
Loss = 8.2164e-03, PNorm = 35.8585, GNorm = 3.3136, lr_0 = 7.3680e-04
Loss = 8.6039e-03, PNorm = 35.9121, GNorm = 1.5324, lr_0 = 7.2605e-04
Validation rmse = 0.784680
Epoch 6
Loss = 7.3142e-03, PNorm = 35.9633, GNorm = 2.9282, lr_0 = 7.1547e-04
Loss = 9.1533e-03, PNorm = 36.0106, GNorm = 1.3604, lr_0 = 7.0504e-04
Loss = 8.2905e-03, PNorm = 36.0592, GNorm = 1.2516, lr_0 = 6.9476e-04
Loss = 1.0202e-02, PNorm = 36.1067, GNorm = 3.8749, lr_0 = 6.8464e-04
Loss = 8.0511e-03, PNorm = 36.1493, GNorm = 0.7862, lr_0 = 6.7465e-04
Loss = 8.5028e-03, PNorm = 36.1897, GNorm = 3.5283, lr_0 = 6.6482e-04
Validation rmse = 0.851737
Epoch 7
Loss = 9.4287e-03, PNorm = 36.2365, GNorm = 0.9550, lr_0 = 6.5513e-04
Loss = 6.4244e-03, PNorm = 36.2821, GNorm = 0.7668, lr_0 = 6.4558e-04
Loss = 7.8564e-03, PNorm = 36.3223, GNorm = 3.1467, lr_0 = 6.3617e-04
Loss = 8.8978e-03, PNorm = 36.3653, GNorm = 1.2301, lr_0 = 6.2689e-04
Loss = 9.1139e-03, PNorm = 36.4011, GNorm = 2.4892, lr_0 = 6.1776e-04
Validation rmse = 0.770787
Epoch 8
Loss = 8.2877e-03, PNorm = 36.4434, GNorm = 4.8180, lr_0 = 6.0875e-04
Loss = 7.4942e-03, PNorm = 36.4961, GNorm = 2.2182, lr_0 = 5.9988e-04
Loss = 7.9381e-03, PNorm = 36.5321, GNorm = 1.5898, lr_0 = 5.9113e-04
Loss = 7.7628e-03, PNorm = 36.5568, GNorm = 1.6656, lr_0 = 5.8251e-04
Loss = 7.7375e-03, PNorm = 36.5882, GNorm = 1.4619, lr_0 = 5.7402e-04
Loss = 8.2886e-03, PNorm = 36.6250, GNorm = 3.6422, lr_0 = 5.6565e-04
Validation rmse = 0.763860
Epoch 9
Loss = 6.9841e-03, PNorm = 36.6609, GNorm = 1.3278, lr_0 = 5.5741e-04
Loss = 7.1917e-03, PNorm = 36.6923, GNorm = 2.2479, lr_0 = 5.4928e-04
Loss = 7.0727e-03, PNorm = 36.7330, GNorm = 0.9018, lr_0 = 5.4128e-04
Loss = 8.2040e-03, PNorm = 36.7587, GNorm = 3.7508, lr_0 = 5.3339e-04
Loss = 9.4382e-03, PNorm = 36.7808, GNorm = 5.4225, lr_0 = 5.2561e-04
Loss = 7.4212e-03, PNorm = 36.8146, GNorm = 1.2708, lr_0 = 5.1795e-04
Validation rmse = 0.761474
Epoch 10
Loss = 8.0171e-03, PNorm = 36.8478, GNorm = 2.3332, lr_0 = 5.1040e-04
Loss = 8.2032e-03, PNorm = 36.8856, GNorm = 6.1047, lr_0 = 5.0296e-04
Loss = 8.1029e-03, PNorm = 36.9094, GNorm = 1.0367, lr_0 = 4.9562e-04
Loss = 6.0550e-03, PNorm = 36.9336, GNorm = 0.8914, lr_0 = 4.8840e-04
Loss = 7.1625e-03, PNorm = 36.9626, GNorm = 0.7911, lr_0 = 4.8128e-04
Validation rmse = 0.715583
Epoch 11
Loss = 6.0906e-03, PNorm = 36.9867, GNorm = 1.2526, lr_0 = 4.7426e-04
Loss = 7.0540e-03, PNorm = 37.0057, GNorm = 1.2767, lr_0 = 4.6735e-04
Loss = 6.8696e-03, PNorm = 37.0228, GNorm = 3.1299, lr_0 = 4.6054e-04
Loss = 6.3330e-03, PNorm = 37.0484, GNorm = 2.8511, lr_0 = 4.5382e-04
Loss = 7.2499e-03, PNorm = 37.0753, GNorm = 1.8795, lr_0 = 4.4721e-04
Loss = 6.9214e-03, PNorm = 37.0952, GNorm = 2.7334, lr_0 = 4.4069e-04
Validation rmse = 0.706531
Epoch 12
Loss = 6.3232e-03, PNorm = 37.1201, GNorm = 1.2767, lr_0 = 4.3427e-04
Loss = 7.2288e-03, PNorm = 37.1519, GNorm = 2.2919, lr_0 = 4.2793e-04
Loss = 6.5940e-03, PNorm = 37.1781, GNorm = 1.3301, lr_0 = 4.2170e-04
Loss = 6.7309e-03, PNorm = 37.1963, GNorm = 1.6169, lr_0 = 4.1555e-04
Loss = 6.2150e-03, PNorm = 37.2134, GNorm = 2.8867, lr_0 = 4.0949e-04
Validation rmse = 0.722094
Epoch 13
Loss = 6.0958e-03, PNorm = 37.2377, GNorm = 1.3975, lr_0 = 4.0352e-04
Loss = 6.3554e-03, PNorm = 37.2666, GNorm = 1.9417, lr_0 = 3.9764e-04
Loss = 6.3166e-03, PNorm = 37.2798, GNorm = 1.7498, lr_0 = 3.9184e-04
Loss = 6.5569e-03, PNorm = 37.3020, GNorm = 1.8534, lr_0 = 3.8613e-04
Loss = 6.2087e-03, PNorm = 37.3282, GNorm = 3.0717, lr_0 = 3.8050e-04
Loss = 5.8839e-03, PNorm = 37.3481, GNorm = 2.1146, lr_0 = 3.7496e-04
Validation rmse = 0.693232
Epoch 14
Loss = 5.6338e-03, PNorm = 37.3702, GNorm = 1.9146, lr_0 = 3.6949e-04
Loss = 6.6044e-03, PNorm = 37.3900, GNorm = 3.7324, lr_0 = 3.6410e-04
Loss = 6.1988e-03, PNorm = 37.4097, GNorm = 1.1721, lr_0 = 3.5880e-04
Loss = 6.4491e-03, PNorm = 37.4246, GNorm = 2.4831, lr_0 = 3.5357e-04
Loss = 6.2396e-03, PNorm = 37.4478, GNorm = 1.2042, lr_0 = 3.4841e-04
Loss = 5.6028e-03, PNorm = 37.4650, GNorm = 1.3818, lr_0 = 3.4333e-04
Validation rmse = 0.679997
Epoch 15
Loss = 6.0104e-03, PNorm = 37.4872, GNorm = 2.9827, lr_0 = 3.3833e-04
Loss = 5.9467e-03, PNorm = 37.5063, GNorm = 2.1187, lr_0 = 3.3340e-04
Loss = 5.9572e-03, PNorm = 37.5174, GNorm = 3.1601, lr_0 = 3.2853e-04
Loss = 5.8599e-03, PNorm = 37.5343, GNorm = 1.6281, lr_0 = 3.2375e-04
Loss = 6.3742e-03, PNorm = 37.5503, GNorm = 3.7289, lr_0 = 3.1903e-04
Validation rmse = 0.680273
Epoch 16
Loss = 5.3629e-03, PNorm = 37.5682, GNorm = 1.9083, lr_0 = 3.1438e-04
Loss = 5.7048e-03, PNorm = 37.5866, GNorm = 2.3867, lr_0 = 3.0979e-04
Loss = 5.1583e-03, PNorm = 37.6032, GNorm = 2.5021, lr_0 = 3.0528e-04
Loss = 5.6321e-03, PNorm = 37.6190, GNorm = 1.1146, lr_0 = 3.0083e-04
Loss = 5.9083e-03, PNorm = 37.6337, GNorm = 2.4164, lr_0 = 2.9644e-04
Loss = 5.8530e-03, PNorm = 37.6441, GNorm = 0.8908, lr_0 = 2.9212e-04
Validation rmse = 0.676360
Epoch 17
Loss = 4.9000e-03, PNorm = 37.6608, GNorm = 1.9728, lr_0 = 2.8786e-04
Loss = 5.9939e-03, PNorm = 37.6751, GNorm = 1.4174, lr_0 = 2.8367e-04
Loss = 4.8974e-03, PNorm = 37.6888, GNorm = 2.6169, lr_0 = 2.7953e-04
Loss = 6.2242e-03, PNorm = 37.6999, GNorm = 2.1223, lr_0 = 2.7546e-04
Loss = 5.5396e-03, PNorm = 37.7145, GNorm = 2.3270, lr_0 = 2.7144e-04
Validation rmse = 0.663726
Epoch 18
Loss = 5.4506e-03, PNorm = 37.7271, GNorm = 2.3067, lr_0 = 2.6748e-04
Loss = 5.6267e-03, PNorm = 37.7392, GNorm = 2.0935, lr_0 = 2.6358e-04
Loss = 4.7705e-03, PNorm = 37.7508, GNorm = 1.5848, lr_0 = 2.5974e-04
Loss = 5.8214e-03, PNorm = 37.7636, GNorm = 1.9373, lr_0 = 2.5595e-04
Loss = 5.6542e-03, PNorm = 37.7784, GNorm = 2.8557, lr_0 = 2.5222e-04
Loss = 5.4754e-03, PNorm = 37.7906, GNorm = 1.7717, lr_0 = 2.4855e-04
Validation rmse = 0.664074
Epoch 19
Loss = 4.8828e-03, PNorm = 37.8040, GNorm = 2.3389, lr_0 = 2.4492e-04
Loss = 5.3706e-03, PNorm = 37.8147, GNorm = 1.1465, lr_0 = 2.4135e-04
Loss = 5.0875e-03, PNorm = 37.8289, GNorm = 2.4034, lr_0 = 2.3783e-04
Loss = 5.5368e-03, PNorm = 37.8420, GNorm = 1.3279, lr_0 = 2.3437e-04
Loss = 6.2395e-03, PNorm = 37.8513, GNorm = 1.8378, lr_0 = 2.3095e-04
Loss = 4.4027e-03, PNorm = 37.8597, GNorm = 0.8818, lr_0 = 2.2758e-04
Validation rmse = 0.664019
Epoch 20
Loss = 4.5234e-03, PNorm = 37.8730, GNorm = 1.0862, lr_0 = 2.2427e-04
Loss = 4.7757e-03, PNorm = 37.8854, GNorm = 1.4417, lr_0 = 2.2100e-04
Loss = 5.7885e-03, PNorm = 37.8948, GNorm = 3.2528, lr_0 = 2.1778e-04
Loss = 5.2660e-03, PNorm = 37.9029, GNorm = 1.5081, lr_0 = 2.1460e-04
Loss = 5.4714e-03, PNorm = 37.9117, GNorm = 1.7104, lr_0 = 2.1147e-04
Validation rmse = 0.670198
Epoch 21
Loss = 5.5215e-03, PNorm = 37.9216, GNorm = 3.1483, lr_0 = 2.0839e-04
Loss = 5.3844e-03, PNorm = 37.9307, GNorm = 1.4215, lr_0 = 2.0535e-04
Loss = 4.1701e-03, PNorm = 37.9409, GNorm = 2.3062, lr_0 = 2.0236e-04
Loss = 5.0145e-03, PNorm = 37.9493, GNorm = 1.1174, lr_0 = 1.9941e-04
Loss = 5.3062e-03, PNorm = 37.9591, GNorm = 1.7967, lr_0 = 1.9650e-04
Loss = 5.6061e-03, PNorm = 37.9653, GNorm = 3.8046, lr_0 = 1.9364e-04
Validation rmse = 0.653583
Epoch 22
Loss = 4.1140e-03, PNorm = 37.9761, GNorm = 1.9189, lr_0 = 1.9081e-04
Loss = 5.0522e-03, PNorm = 37.9848, GNorm = 2.8339, lr_0 = 1.8803e-04
Loss = 5.3290e-03, PNorm = 37.9921, GNorm = 1.2134, lr_0 = 1.8529e-04
Loss = 5.6194e-03, PNorm = 38.0002, GNorm = 1.6054, lr_0 = 1.8259e-04
Loss = 4.5040e-03, PNorm = 38.0091, GNorm = 2.6429, lr_0 = 1.7993e-04
Validation rmse = 0.644740
Epoch 23
Loss = 5.3768e-03, PNorm = 38.0184, GNorm = 2.3479, lr_0 = 1.7731e-04
Loss = 4.8522e-03, PNorm = 38.0275, GNorm = 1.3642, lr_0 = 1.7472e-04
Loss = 5.7311e-03, PNorm = 38.0337, GNorm = 2.8690, lr_0 = 1.7217e-04
Loss = 4.9286e-03, PNorm = 38.0410, GNorm = 3.3788, lr_0 = 1.6966e-04
Loss = 4.1005e-03, PNorm = 38.0505, GNorm = 1.9735, lr_0 = 1.6719e-04
Loss = 4.5794e-03, PNorm = 38.0561, GNorm = 1.1218, lr_0 = 1.6475e-04
Validation rmse = 0.664595
Epoch 24
Loss = 4.5951e-03, PNorm = 38.0636, GNorm = 1.7308, lr_0 = 1.6235e-04
Loss = 4.5947e-03, PNorm = 38.0718, GNorm = 1.2095, lr_0 = 1.5999e-04
Loss = 4.9172e-03, PNorm = 38.0792, GNorm = 2.9361, lr_0 = 1.5765e-04
Loss = 5.1472e-03, PNorm = 38.0863, GNorm = 0.9817, lr_0 = 1.5536e-04
Loss = 4.6086e-03, PNorm = 38.0951, GNorm = 1.1879, lr_0 = 1.5309e-04
Loss = 5.3619e-03, PNorm = 38.1000, GNorm = 3.6629, lr_0 = 1.5086e-04
Validation rmse = 0.668746
Epoch 25
Loss = 4.5937e-03, PNorm = 38.1065, GNorm = 1.4393, lr_0 = 1.4866e-04
Loss = 4.5085e-03, PNorm = 38.1139, GNorm = 1.3461, lr_0 = 1.4649e-04
Loss = 4.6744e-03, PNorm = 38.1198, GNorm = 1.5982, lr_0 = 1.4436e-04
Loss = 4.9983e-03, PNorm = 38.1268, GNorm = 1.4988, lr_0 = 1.4225e-04
Loss = 5.2215e-03, PNorm = 38.1308, GNorm = 3.1048, lr_0 = 1.4018e-04
Validation rmse = 0.657462
Epoch 26
Loss = 3.7901e-03, PNorm = 38.1367, GNorm = 1.3952, lr_0 = 1.3814e-04
Loss = 4.3427e-03, PNorm = 38.1436, GNorm = 1.1932, lr_0 = 1.3612e-04
Loss = 4.2763e-03, PNorm = 38.1492, GNorm = 1.3334, lr_0 = 1.3414e-04
Loss = 4.3951e-03, PNorm = 38.1547, GNorm = 2.8538, lr_0 = 1.3218e-04
Loss = 5.0736e-03, PNorm = 38.1585, GNorm = 2.4820, lr_0 = 1.3026e-04
Loss = 4.5934e-03, PNorm = 38.1630, GNorm = 1.4274, lr_0 = 1.2836e-04
Validation rmse = 0.653006
Epoch 27
Loss = 4.8639e-03, PNorm = 38.1694, GNorm = 1.2333, lr_0 = 1.2649e-04
Loss = 4.2089e-03, PNorm = 38.1748, GNorm = 1.9680, lr_0 = 1.2464e-04
Loss = 3.5976e-03, PNorm = 38.1805, GNorm = 1.5720, lr_0 = 1.2282e-04
Loss = 5.1115e-03, PNorm = 38.1864, GNorm = 1.3692, lr_0 = 1.2103e-04
Loss = 4.4043e-03, PNorm = 38.1909, GNorm = 1.2848, lr_0 = 1.1927e-04
Validation rmse = 0.639180
Epoch 28
Loss = 4.0105e-03, PNorm = 38.1957, GNorm = 1.3668, lr_0 = 1.1753e-04
Loss = 4.1150e-03, PNorm = 38.2007, GNorm = 1.5110, lr_0 = 1.1582e-04
Loss = 4.5106e-03, PNorm = 38.2054, GNorm = 1.7093, lr_0 = 1.1413e-04
Loss = 4.3389e-03, PNorm = 38.2102, GNorm = 1.7778, lr_0 = 1.1247e-04
Loss = 5.0282e-03, PNorm = 38.2136, GNorm = 2.0354, lr_0 = 1.1083e-04
Loss = 4.5221e-03, PNorm = 38.2184, GNorm = 1.5991, lr_0 = 1.0921e-04
Validation rmse = 0.642264
Epoch 29
Loss = 4.9242e-03, PNorm = 38.2234, GNorm = 1.1323, lr_0 = 1.0762e-04
Loss = 3.7979e-03, PNorm = 38.2287, GNorm = 0.9789, lr_0 = 1.0605e-04
Loss = 4.5236e-03, PNorm = 38.2324, GNorm = 2.1189, lr_0 = 1.0450e-04
Loss = 3.9198e-03, PNorm = 38.2371, GNorm = 1.7568, lr_0 = 1.0298e-04
Loss = 4.5304e-03, PNorm = 38.2403, GNorm = 2.4019, lr_0 = 1.0148e-04
Loss = 4.5733e-03, PNorm = 38.2440, GNorm = 2.5084, lr_0 = 1.0000e-04
Validation rmse = 0.629639
Model 0 best validation rmse = 0.629639 on epoch 29
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.673049
Ensemble test rmse = 0.673049
Fold 3
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'cuda': True,
 'data_path': 'dopamine.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cache': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'output_size': 1,
 'quiet': False,
 'save_dir': 'runs\\fold_3',
 'save_smiles_splits': False,
 'seed': 45,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'task_names': ['1.2218487496163564'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 2803,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': None,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 45
Total size = 3,504 | train size = 2,803 | val size = 350 | test size = 351
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Moving model to cuda
Epoch 0
Loss = 2.0301e-02, PNorm = 34.0449, GNorm = 0.7724, lr_0 = 1.8036e-04
Loss = 1.8549e-02, PNorm = 34.0495, GNorm = 1.6701, lr_0 = 2.6071e-04
Loss = 2.0028e-02, PNorm = 34.0577, GNorm = 1.4366, lr_0 = 3.4107e-04
Loss = 1.6634e-02, PNorm = 34.0751, GNorm = 0.5828, lr_0 = 4.2143e-04
Loss = 1.8012e-02, PNorm = 34.0981, GNorm = 3.1351, lr_0 = 5.0179e-04
Validation rmse = 1.046022
Epoch 1
Loss = 1.6925e-02, PNorm = 34.1249, GNorm = 1.2796, lr_0 = 5.8214e-04
Loss = 1.5039e-02, PNorm = 34.1597, GNorm = 5.7968, lr_0 = 6.6250e-04
Loss = 1.5361e-02, PNorm = 34.2041, GNorm = 6.0519, lr_0 = 7.4286e-04
Loss = 1.5019e-02, PNorm = 34.2602, GNorm = 5.7375, lr_0 = 8.2321e-04
Loss = 1.5490e-02, PNorm = 34.3331, GNorm = 4.8316, lr_0 = 9.0357e-04
Loss = 1.4115e-02, PNorm = 34.4160, GNorm = 11.3069, lr_0 = 9.8393e-04
Validation rmse = 0.981886
Epoch 2
Loss = 1.4131e-02, PNorm = 34.5054, GNorm = 1.8588, lr_0 = 9.8832e-04
Loss = 1.3441e-02, PNorm = 34.5944, GNorm = 2.7793, lr_0 = 9.7391e-04
Loss = 1.2995e-02, PNorm = 34.6951, GNorm = 0.7915, lr_0 = 9.5972e-04
Loss = 1.2055e-02, PNorm = 34.7835, GNorm = 3.8618, lr_0 = 9.4573e-04
Loss = 1.3564e-02, PNorm = 34.8778, GNorm = 2.8239, lr_0 = 9.3194e-04
Validation rmse = 0.927796
Epoch 3
Loss = 1.0865e-02, PNorm = 34.9618, GNorm = 4.8063, lr_0 = 9.1835e-04
Loss = 1.2822e-02, PNorm = 35.0434, GNorm = 2.2300, lr_0 = 9.0497e-04
Loss = 1.1323e-02, PNorm = 35.1602, GNorm = 1.5274, lr_0 = 8.9177e-04
Loss = 9.6281e-03, PNorm = 35.2436, GNorm = 0.9706, lr_0 = 8.7877e-04
Loss = 1.1696e-02, PNorm = 35.3061, GNorm = 0.9276, lr_0 = 8.6596e-04
Loss = 1.1827e-02, PNorm = 35.3807, GNorm = 1.6861, lr_0 = 8.5334e-04
Validation rmse = 0.837985
Epoch 4
Loss = 8.7810e-03, PNorm = 35.4606, GNorm = 2.4713, lr_0 = 8.4090e-04
Loss = 9.8504e-03, PNorm = 35.5353, GNorm = 2.8239, lr_0 = 8.2864e-04
Loss = 1.0243e-02, PNorm = 35.5954, GNorm = 2.7876, lr_0 = 8.1656e-04
Loss = 1.0749e-02, PNorm = 35.6559, GNorm = 6.1540, lr_0 = 8.0466e-04
Loss = 1.0719e-02, PNorm = 35.7235, GNorm = 0.6700, lr_0 = 7.9293e-04
Loss = 1.0304e-02, PNorm = 35.7925, GNorm = 5.3265, lr_0 = 7.8137e-04
Validation rmse = 0.833045
Epoch 5
Loss = 1.1823e-02, PNorm = 35.8487, GNorm = 5.8333, lr_0 = 7.6998e-04
Loss = 9.7801e-03, PNorm = 35.9166, GNorm = 1.3307, lr_0 = 7.5876e-04
Loss = 9.1630e-03, PNorm = 35.9844, GNorm = 2.5262, lr_0 = 7.4770e-04
Loss = 7.8450e-03, PNorm = 36.0364, GNorm = 1.5736, lr_0 = 7.3680e-04
Loss = 9.2463e-03, PNorm = 36.0857, GNorm = 4.3502, lr_0 = 7.2605e-04
Validation rmse = 0.784185
Epoch 6
Loss = 9.4931e-03, PNorm = 36.1301, GNorm = 1.4855, lr_0 = 7.1547e-04
Loss = 8.1191e-03, PNorm = 36.1714, GNorm = 2.6935, lr_0 = 7.0504e-04
Loss = 8.9780e-03, PNorm = 36.2154, GNorm = 1.9936, lr_0 = 6.9476e-04
Loss = 8.3237e-03, PNorm = 36.2598, GNorm = 0.9364, lr_0 = 6.8464e-04
Loss = 1.0125e-02, PNorm = 36.3077, GNorm = 1.1043, lr_0 = 6.7465e-04
Loss = 7.1025e-03, PNorm = 36.3543, GNorm = 1.3249, lr_0 = 6.6482e-04
Validation rmse = 0.756439
Epoch 7
Loss = 8.3349e-03, PNorm = 36.3927, GNorm = 3.3566, lr_0 = 6.5513e-04
Loss = 8.6617e-03, PNorm = 36.4271, GNorm = 1.0764, lr_0 = 6.4558e-04
Loss = 8.4292e-03, PNorm = 36.4849, GNorm = 2.5998, lr_0 = 6.3617e-04
Loss = 7.5959e-03, PNorm = 36.5342, GNorm = 2.1642, lr_0 = 6.2689e-04
Loss = 7.5121e-03, PNorm = 36.5668, GNorm = 0.9265, lr_0 = 6.1776e-04
Validation rmse = 0.727126
Epoch 8
Loss = 5.6643e-03, PNorm = 36.6001, GNorm = 1.5391, lr_0 = 6.0875e-04
Loss = 6.8739e-03, PNorm = 36.6412, GNorm = 2.6108, lr_0 = 5.9988e-04
Loss = 8.0987e-03, PNorm = 36.6805, GNorm = 1.4329, lr_0 = 5.9113e-04
Loss = 7.9280e-03, PNorm = 36.7375, GNorm = 3.0090, lr_0 = 5.8251e-04
Loss = 8.4453e-03, PNorm = 36.7715, GNorm = 1.2215, lr_0 = 5.7402e-04
Loss = 7.2922e-03, PNorm = 36.8067, GNorm = 1.1162, lr_0 = 5.6565e-04
Validation rmse = 0.722355
Epoch 9
Loss = 6.3894e-03, PNorm = 36.8351, GNorm = 1.2333, lr_0 = 5.5741e-04
Loss = 7.2673e-03, PNorm = 36.8772, GNorm = 2.6970, lr_0 = 5.4928e-04
Loss = 6.9749e-03, PNorm = 36.9146, GNorm = 1.8184, lr_0 = 5.4128e-04
Loss = 6.8695e-03, PNorm = 36.9469, GNorm = 2.0048, lr_0 = 5.3339e-04
Loss = 7.6690e-03, PNorm = 36.9773, GNorm = 3.5240, lr_0 = 5.2561e-04
Loss = 7.4128e-03, PNorm = 37.0071, GNorm = 1.6026, lr_0 = 5.1795e-04
Validation rmse = 0.701386
Epoch 10
Loss = 6.9882e-03, PNorm = 37.0371, GNorm = 2.6419, lr_0 = 5.1040e-04
Loss = 6.8981e-03, PNorm = 37.0740, GNorm = 1.1296, lr_0 = 5.0296e-04
Loss = 6.8721e-03, PNorm = 37.1061, GNorm = 1.6126, lr_0 = 4.9562e-04
Loss = 7.4283e-03, PNorm = 37.1426, GNorm = 1.0683, lr_0 = 4.8840e-04
Loss = 6.9351e-03, PNorm = 37.1775, GNorm = 1.9500, lr_0 = 4.8128e-04
Validation rmse = 0.703370
Epoch 11
Loss = 5.3123e-03, PNorm = 37.2057, GNorm = 0.8779, lr_0 = 4.7426e-04
Loss = 6.7038e-03, PNorm = 37.2357, GNorm = 1.7319, lr_0 = 4.6735e-04
Loss = 6.2152e-03, PNorm = 37.2604, GNorm = 1.0455, lr_0 = 4.6054e-04
Loss = 6.3663e-03, PNorm = 37.2852, GNorm = 0.9932, lr_0 = 4.5382e-04
Loss = 6.8913e-03, PNorm = 37.3129, GNorm = 1.6861, lr_0 = 4.4721e-04
Loss = 7.0897e-03, PNorm = 37.3434, GNorm = 2.0383, lr_0 = 4.4069e-04
Validation rmse = 0.694991
Epoch 12
Loss = 6.4838e-03, PNorm = 37.3660, GNorm = 1.6124, lr_0 = 4.3427e-04
Loss = 6.5148e-03, PNorm = 37.3924, GNorm = 3.1332, lr_0 = 4.2793e-04
Loss = 5.6530e-03, PNorm = 37.4124, GNorm = 1.6117, lr_0 = 4.2170e-04
Loss = 5.7500e-03, PNorm = 37.4333, GNorm = 1.3770, lr_0 = 4.1555e-04
Loss = 6.9729e-03, PNorm = 37.4560, GNorm = 2.9137, lr_0 = 4.0949e-04
Validation rmse = 0.682398
Epoch 13
Loss = 5.6674e-03, PNorm = 37.4769, GNorm = 0.8734, lr_0 = 4.0352e-04
Loss = 6.1605e-03, PNorm = 37.5027, GNorm = 1.1756, lr_0 = 3.9764e-04
Loss = 6.5843e-03, PNorm = 37.5310, GNorm = 0.9736, lr_0 = 3.9184e-04
Loss = 6.3552e-03, PNorm = 37.5561, GNorm = 1.2564, lr_0 = 3.8613e-04
Loss = 5.9009e-03, PNorm = 37.5744, GNorm = 0.8882, lr_0 = 3.8050e-04
Loss = 5.5705e-03, PNorm = 37.5951, GNorm = 0.8158, lr_0 = 3.7496e-04
Validation rmse = 0.673542
Epoch 14
Loss = 5.9282e-03, PNorm = 37.6144, GNorm = 1.0564, lr_0 = 3.6949e-04
Loss = 6.0984e-03, PNorm = 37.6336, GNorm = 1.2072, lr_0 = 3.6410e-04
Loss = 5.8625e-03, PNorm = 37.6552, GNorm = 2.1796, lr_0 = 3.5880e-04
Loss = 5.5150e-03, PNorm = 37.6738, GNorm = 1.0513, lr_0 = 3.5357e-04
Loss = 5.4258e-03, PNorm = 37.6915, GNorm = 1.7673, lr_0 = 3.4841e-04
Loss = 6.0490e-03, PNorm = 37.7092, GNorm = 2.7095, lr_0 = 3.4333e-04
Validation rmse = 0.663266
Epoch 15
Loss = 5.6360e-03, PNorm = 37.7289, GNorm = 1.2869, lr_0 = 3.3833e-04
Loss = 6.0110e-03, PNorm = 37.7508, GNorm = 1.2456, lr_0 = 3.3340e-04
Loss = 5.8335e-03, PNorm = 37.7677, GNorm = 1.4452, lr_0 = 3.2853e-04
Loss = 5.1507e-03, PNorm = 37.7875, GNorm = 1.4979, lr_0 = 3.2375e-04
Loss = 5.5634e-03, PNorm = 37.8056, GNorm = 1.2589, lr_0 = 3.1903e-04
Validation rmse = 0.652195
Epoch 16
Loss = 4.9887e-03, PNorm = 37.8221, GNorm = 1.6521, lr_0 = 3.1438e-04
Loss = 5.3039e-03, PNorm = 37.8335, GNorm = 0.8931, lr_0 = 3.0979e-04
Loss = 5.3123e-03, PNorm = 37.8478, GNorm = 1.5621, lr_0 = 3.0528e-04
Loss = 4.8286e-03, PNorm = 37.8681, GNorm = 2.4865, lr_0 = 3.0083e-04
Loss = 5.8889e-03, PNorm = 37.8856, GNorm = 1.5040, lr_0 = 2.9644e-04
Loss = 5.5685e-03, PNorm = 37.8966, GNorm = 2.2556, lr_0 = 2.9212e-04
Validation rmse = 0.640670
Epoch 17
Loss = 5.5918e-03, PNorm = 37.9087, GNorm = 1.8980, lr_0 = 2.8786e-04
Loss = 5.5328e-03, PNorm = 37.9202, GNorm = 2.1682, lr_0 = 2.8367e-04
Loss = 5.1736e-03, PNorm = 37.9352, GNorm = 2.0068, lr_0 = 2.7953e-04
Loss = 4.5902e-03, PNorm = 37.9500, GNorm = 1.3965, lr_0 = 2.7546e-04
Loss = 5.2525e-03, PNorm = 37.9637, GNorm = 1.5072, lr_0 = 2.7144e-04
Validation rmse = 0.639003
Epoch 18
Loss = 3.1651e-03, PNorm = 37.9781, GNorm = 0.8833, lr_0 = 2.6748e-04
Loss = 5.1258e-03, PNorm = 37.9949, GNorm = 1.3283, lr_0 = 2.6358e-04
Loss = 5.1482e-03, PNorm = 38.0076, GNorm = 2.2554, lr_0 = 2.5974e-04
Loss = 5.8896e-03, PNorm = 38.0218, GNorm = 1.5667, lr_0 = 2.5595e-04
Loss = 4.9027e-03, PNorm = 38.0354, GNorm = 1.3308, lr_0 = 2.5222e-04
Loss = 4.7871e-03, PNorm = 38.0440, GNorm = 1.3975, lr_0 = 2.4855e-04
Validation rmse = 0.651407
Epoch 19
Loss = 4.5541e-03, PNorm = 38.0528, GNorm = 2.5402, lr_0 = 2.4492e-04
Loss = 4.9757e-03, PNorm = 38.0641, GNorm = 1.5477, lr_0 = 2.4135e-04
Loss = 4.9448e-03, PNorm = 38.0779, GNorm = 2.1285, lr_0 = 2.3783e-04
Loss = 5.4463e-03, PNorm = 38.0916, GNorm = 1.2204, lr_0 = 2.3437e-04
Loss = 5.0381e-03, PNorm = 38.1034, GNorm = 1.3526, lr_0 = 2.3095e-04
Loss = 4.7733e-03, PNorm = 38.1110, GNorm = 1.3240, lr_0 = 2.2758e-04
Validation rmse = 0.628126
Epoch 20
Loss = 4.8833e-03, PNorm = 38.1217, GNorm = 1.3655, lr_0 = 2.2427e-04
Loss = 4.7619e-03, PNorm = 38.1341, GNorm = 1.3238, lr_0 = 2.2100e-04
Loss = 4.6742e-03, PNorm = 38.1424, GNorm = 1.8007, lr_0 = 2.1778e-04
Loss = 5.0512e-03, PNorm = 38.1525, GNorm = 2.0111, lr_0 = 2.1460e-04
Loss = 5.1780e-03, PNorm = 38.1621, GNorm = 2.2773, lr_0 = 2.1147e-04
Validation rmse = 0.641459
Epoch 21
Loss = 5.1102e-03, PNorm = 38.1705, GNorm = 1.1350, lr_0 = 2.0839e-04
Loss = 4.8909e-03, PNorm = 38.1790, GNorm = 1.1307, lr_0 = 2.0535e-04
Loss = 5.3380e-03, PNorm = 38.1867, GNorm = 1.9851, lr_0 = 2.0236e-04
Loss = 4.3900e-03, PNorm = 38.1970, GNorm = 1.0159, lr_0 = 1.9941e-04
Loss = 4.9577e-03, PNorm = 38.2068, GNorm = 1.2996, lr_0 = 1.9650e-04
Loss = 4.2269e-03, PNorm = 38.2169, GNorm = 1.2565, lr_0 = 1.9364e-04
Validation rmse = 0.638034
Epoch 22
Loss = 4.8603e-03, PNorm = 38.2271, GNorm = 1.2542, lr_0 = 1.9081e-04
Loss = 5.2225e-03, PNorm = 38.2356, GNorm = 1.8270, lr_0 = 1.8803e-04
Loss = 4.2562e-03, PNorm = 38.2433, GNorm = 1.5266, lr_0 = 1.8529e-04
Loss = 5.1835e-03, PNorm = 38.2499, GNorm = 1.8768, lr_0 = 1.8259e-04
Loss = 4.5321e-03, PNorm = 38.2592, GNorm = 2.3900, lr_0 = 1.7993e-04
Validation rmse = 0.634262
Epoch 23
Loss = 4.7012e-03, PNorm = 38.2680, GNorm = 1.7470, lr_0 = 1.7731e-04
Loss = 4.7660e-03, PNorm = 38.2745, GNorm = 2.2855, lr_0 = 1.7472e-04
Loss = 4.7795e-03, PNorm = 38.2822, GNorm = 1.6841, lr_0 = 1.7217e-04
Loss = 4.3329e-03, PNorm = 38.2916, GNorm = 1.2396, lr_0 = 1.6966e-04
Loss = 4.4624e-03, PNorm = 38.3003, GNorm = 1.7772, lr_0 = 1.6719e-04
Loss = 4.0655e-03, PNorm = 38.3098, GNorm = 2.4220, lr_0 = 1.6475e-04
Validation rmse = 0.636406
Epoch 24
Loss = 5.0620e-03, PNorm = 38.3154, GNorm = 2.0886, lr_0 = 1.6235e-04
Loss = 4.6826e-03, PNorm = 38.3223, GNorm = 3.2292, lr_0 = 1.5999e-04
Loss = 4.3165e-03, PNorm = 38.3307, GNorm = 1.1202, lr_0 = 1.5765e-04
Loss = 4.2886e-03, PNorm = 38.3378, GNorm = 1.1660, lr_0 = 1.5536e-04
Loss = 4.4077e-03, PNorm = 38.3442, GNorm = 5.9292, lr_0 = 1.5309e-04
Loss = 4.5835e-03, PNorm = 38.3485, GNorm = 1.7195, lr_0 = 1.5086e-04
Validation rmse = 0.628349
Epoch 25
Loss = 4.5281e-03, PNorm = 38.3553, GNorm = 1.7470, lr_0 = 1.4866e-04
Loss = 5.3984e-03, PNorm = 38.3619, GNorm = 1.9808, lr_0 = 1.4649e-04
Loss = 4.0688e-03, PNorm = 38.3695, GNorm = 2.3082, lr_0 = 1.4436e-04
Loss = 4.2087e-03, PNorm = 38.3750, GNorm = 1.4023, lr_0 = 1.4225e-04
Loss = 3.9898e-03, PNorm = 38.3812, GNorm = 1.7576, lr_0 = 1.4018e-04
Validation rmse = 0.619830
Epoch 26
Loss = 4.3984e-03, PNorm = 38.3877, GNorm = 1.7944, lr_0 = 1.3814e-04
Loss = 3.9337e-03, PNorm = 38.3944, GNorm = 0.9922, lr_0 = 1.3612e-04
Loss = 3.8488e-03, PNorm = 38.4008, GNorm = 2.6169, lr_0 = 1.3414e-04
Loss = 4.2907e-03, PNorm = 38.4058, GNorm = 1.3718, lr_0 = 1.3218e-04
Loss = 4.9482e-03, PNorm = 38.4118, GNorm = 1.8204, lr_0 = 1.3026e-04
Loss = 4.2110e-03, PNorm = 38.4171, GNorm = 1.5768, lr_0 = 1.2836e-04
Validation rmse = 0.628311
Epoch 27
Loss = 4.6274e-03, PNorm = 38.4224, GNorm = 1.4096, lr_0 = 1.2649e-04
Loss = 3.8946e-03, PNorm = 38.4293, GNorm = 1.3166, lr_0 = 1.2464e-04
Loss = 4.4850e-03, PNorm = 38.4344, GNorm = 1.2214, lr_0 = 1.2282e-04
Loss = 3.9271e-03, PNorm = 38.4389, GNorm = 1.0279, lr_0 = 1.2103e-04
Loss = 4.0936e-03, PNorm = 38.4414, GNorm = 0.9254, lr_0 = 1.1927e-04
Validation rmse = 0.623592
Epoch 28
Loss = 3.7408e-03, PNorm = 38.4455, GNorm = 1.5862, lr_0 = 1.1753e-04
Loss = 3.7154e-03, PNorm = 38.4505, GNorm = 2.0324, lr_0 = 1.1582e-04
Loss = 3.8979e-03, PNorm = 38.4544, GNorm = 1.2622, lr_0 = 1.1413e-04
Loss = 5.3251e-03, PNorm = 38.4608, GNorm = 1.4283, lr_0 = 1.1247e-04
Loss = 4.5650e-03, PNorm = 38.4667, GNorm = 2.8442, lr_0 = 1.1083e-04
Loss = 4.1821e-03, PNorm = 38.4711, GNorm = 1.7033, lr_0 = 1.0921e-04
Validation rmse = 0.632230
Epoch 29
Loss = 3.5840e-03, PNorm = 38.4758, GNorm = 1.3346, lr_0 = 1.0762e-04
Loss = 4.3049e-03, PNorm = 38.4785, GNorm = 2.0188, lr_0 = 1.0605e-04
Loss = 4.5974e-03, PNorm = 38.4821, GNorm = 1.0605, lr_0 = 1.0450e-04
Loss = 4.3483e-03, PNorm = 38.4879, GNorm = 2.8587, lr_0 = 1.0298e-04
Loss = 4.0079e-03, PNorm = 38.4932, GNorm = 4.1805, lr_0 = 1.0148e-04
Loss = 4.1454e-03, PNorm = 38.4965, GNorm = 2.2066, lr_0 = 1.0000e-04
Validation rmse = 0.622084
Model 0 best validation rmse = 0.619830 on epoch 25
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.669234
Ensemble test rmse = 0.669234
Fold 4
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'cuda': True,
 'data_path': 'dopamine.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cache': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'output_size': 1,
 'quiet': False,
 'save_dir': 'runs\\fold_4',
 'save_smiles_splits': False,
 'seed': 46,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'task_names': ['1.2218487496163564'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 2803,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': None,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 46
Total size = 3,504 | train size = 2,803 | val size = 350 | test size = 351
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Moving model to cuda
Epoch 0
Loss = 1.9642e-02, PNorm = 33.9533, GNorm = 2.5490, lr_0 = 1.8036e-04
Loss = 2.0598e-02, PNorm = 33.9567, GNorm = 4.7018, lr_0 = 2.6071e-04
Loss = 1.8919e-02, PNorm = 33.9653, GNorm = 4.9232, lr_0 = 3.4107e-04
Loss = 1.7172e-02, PNorm = 33.9812, GNorm = 8.4845, lr_0 = 4.2143e-04
Loss = 1.5915e-02, PNorm = 33.9982, GNorm = 2.1808, lr_0 = 5.0179e-04
Validation rmse = 1.037664
Epoch 1
Loss = 1.7453e-02, PNorm = 34.0166, GNorm = 1.4501, lr_0 = 5.8214e-04
Loss = 1.6892e-02, PNorm = 34.0420, GNorm = 6.4902, lr_0 = 6.6250e-04
Loss = 1.5386e-02, PNorm = 34.0791, GNorm = 1.0753, lr_0 = 7.4286e-04
Loss = 1.3964e-02, PNorm = 34.1255, GNorm = 1.2175, lr_0 = 8.2321e-04
Loss = 1.5598e-02, PNorm = 34.1749, GNorm = 0.9513, lr_0 = 9.0357e-04
Loss = 1.3556e-02, PNorm = 34.2306, GNorm = 7.2970, lr_0 = 9.8393e-04
Validation rmse = 1.005845
Epoch 2
Loss = 1.3816e-02, PNorm = 34.2974, GNorm = 5.5724, lr_0 = 9.8832e-04
Loss = 1.4612e-02, PNorm = 34.3707, GNorm = 1.0557, lr_0 = 9.7391e-04
Loss = 1.2986e-02, PNorm = 34.4430, GNorm = 3.0110, lr_0 = 9.5972e-04
Loss = 1.2853e-02, PNorm = 34.5060, GNorm = 0.8189, lr_0 = 9.4573e-04
Loss = 1.1337e-02, PNorm = 34.5734, GNorm = 1.8550, lr_0 = 9.3194e-04
Validation rmse = 0.974014
Epoch 3
Loss = 9.9003e-03, PNorm = 34.6352, GNorm = 1.6432, lr_0 = 9.1835e-04
Loss = 1.1870e-02, PNorm = 34.7045, GNorm = 2.5292, lr_0 = 9.0497e-04
Loss = 1.1577e-02, PNorm = 34.7693, GNorm = 6.7965, lr_0 = 8.9177e-04
Loss = 1.0970e-02, PNorm = 34.8366, GNorm = 4.1744, lr_0 = 8.7877e-04
Loss = 1.1706e-02, PNorm = 34.8968, GNorm = 3.6286, lr_0 = 8.6596e-04
Loss = 1.0509e-02, PNorm = 34.9608, GNorm = 3.0291, lr_0 = 8.5334e-04
Validation rmse = 0.892244
Epoch 4
Loss = 1.0678e-02, PNorm = 35.0122, GNorm = 7.0029, lr_0 = 8.4090e-04
Loss = 1.0438e-02, PNorm = 35.0766, GNorm = 3.4180, lr_0 = 8.2864e-04
Loss = 8.8928e-03, PNorm = 35.1310, GNorm = 2.2489, lr_0 = 8.1656e-04
Loss = 9.9301e-03, PNorm = 35.1850, GNorm = 8.5404, lr_0 = 8.0466e-04
Loss = 1.1742e-02, PNorm = 35.2221, GNorm = 0.8012, lr_0 = 7.9293e-04
Loss = 1.1323e-02, PNorm = 35.2810, GNorm = 2.7269, lr_0 = 7.8137e-04
Validation rmse = 0.953281
Epoch 5
Loss = 1.0659e-02, PNorm = 35.3403, GNorm = 2.5856, lr_0 = 7.6998e-04
Loss = 8.6712e-03, PNorm = 35.3950, GNorm = 3.0560, lr_0 = 7.5876e-04
Loss = 8.7463e-03, PNorm = 35.4348, GNorm = 5.6961, lr_0 = 7.4770e-04
Loss = 9.8976e-03, PNorm = 35.4802, GNorm = 1.3256, lr_0 = 7.3680e-04
Loss = 1.0384e-02, PNorm = 35.5214, GNorm = 5.0509, lr_0 = 7.2605e-04
Validation rmse = 0.832713
Epoch 6
Loss = 9.3976e-03, PNorm = 35.5652, GNorm = 2.5240, lr_0 = 7.1547e-04
Loss = 9.4162e-03, PNorm = 35.6151, GNorm = 1.6324, lr_0 = 7.0504e-04
Loss = 8.4217e-03, PNorm = 35.6572, GNorm = 1.4739, lr_0 = 6.9476e-04
Loss = 8.4445e-03, PNorm = 35.6979, GNorm = 1.5314, lr_0 = 6.8464e-04
Loss = 8.0688e-03, PNorm = 35.7374, GNorm = 1.5377, lr_0 = 6.7465e-04
Loss = 9.8148e-03, PNorm = 35.7771, GNorm = 2.3409, lr_0 = 6.6482e-04
Validation rmse = 0.919979
Epoch 7
Loss = 8.4352e-03, PNorm = 35.8182, GNorm = 2.1469, lr_0 = 6.5513e-04
Loss = 8.0697e-03, PNorm = 35.8612, GNorm = 2.7114, lr_0 = 6.4558e-04
Loss = 8.8761e-03, PNorm = 35.9067, GNorm = 2.6276, lr_0 = 6.3617e-04
Loss = 9.6195e-03, PNorm = 35.9314, GNorm = 1.7102, lr_0 = 6.2689e-04
Loss = 8.4012e-03, PNorm = 35.9704, GNorm = 1.9531, lr_0 = 6.1776e-04
Validation rmse = 0.807849
Epoch 8
Loss = 6.5529e-03, PNorm = 36.0018, GNorm = 2.4410, lr_0 = 6.0875e-04
Loss = 6.7780e-03, PNorm = 36.0298, GNorm = 3.3584, lr_0 = 5.9988e-04
Loss = 7.9950e-03, PNorm = 36.0590, GNorm = 1.4081, lr_0 = 5.9113e-04
Loss = 7.9181e-03, PNorm = 36.0921, GNorm = 1.5073, lr_0 = 5.8251e-04
Loss = 8.1521e-03, PNorm = 36.1178, GNorm = 2.1431, lr_0 = 5.7402e-04
Loss = 7.6047e-03, PNorm = 36.1523, GNorm = 0.8019, lr_0 = 5.6565e-04
Validation rmse = 0.803737
Epoch 9
Loss = 7.4303e-03, PNorm = 36.1791, GNorm = 1.7762, lr_0 = 5.5741e-04
Loss = 7.2919e-03, PNorm = 36.2065, GNorm = 1.0851, lr_0 = 5.4928e-04
Loss = 7.2858e-03, PNorm = 36.2346, GNorm = 3.7512, lr_0 = 5.4128e-04
Loss = 7.1463e-03, PNorm = 36.2665, GNorm = 2.6516, lr_0 = 5.3339e-04
Loss = 8.0822e-03, PNorm = 36.2898, GNorm = 2.3161, lr_0 = 5.2561e-04
Loss = 8.1352e-03, PNorm = 36.3146, GNorm = 1.4440, lr_0 = 5.1795e-04
Validation rmse = 0.772739
Epoch 10
Loss = 7.5683e-03, PNorm = 36.3481, GNorm = 1.9359, lr_0 = 5.1040e-04
Loss = 7.2166e-03, PNorm = 36.3776, GNorm = 2.2180, lr_0 = 5.0296e-04
Loss = 6.9858e-03, PNorm = 36.3998, GNorm = 2.1608, lr_0 = 4.9562e-04
Loss = 7.4403e-03, PNorm = 36.4232, GNorm = 2.8741, lr_0 = 4.8840e-04
Loss = 6.5405e-03, PNorm = 36.4458, GNorm = 3.2504, lr_0 = 4.8128e-04
Validation rmse = 0.783780
Epoch 11
Loss = 6.2145e-03, PNorm = 36.4682, GNorm = 1.3865, lr_0 = 4.7426e-04
Loss = 7.0522e-03, PNorm = 36.4897, GNorm = 3.0471, lr_0 = 4.6735e-04
Loss = 6.6376e-03, PNorm = 36.5068, GNorm = 2.0328, lr_0 = 4.6054e-04
Loss = 6.8684e-03, PNorm = 36.5313, GNorm = 1.0109, lr_0 = 4.5382e-04
Loss = 7.1288e-03, PNorm = 36.5566, GNorm = 2.2206, lr_0 = 4.4721e-04
Loss = 6.2247e-03, PNorm = 36.5842, GNorm = 0.9163, lr_0 = 4.4069e-04
Validation rmse = 0.758457
Epoch 12
Loss = 7.0222e-03, PNorm = 36.6100, GNorm = 4.5428, lr_0 = 4.3427e-04
Loss = 5.6020e-03, PNorm = 36.6310, GNorm = 1.5153, lr_0 = 4.2793e-04
Loss = 7.2529e-03, PNorm = 36.6559, GNorm = 1.6115, lr_0 = 4.2170e-04
Loss = 6.7519e-03, PNorm = 36.6812, GNorm = 2.2177, lr_0 = 4.1555e-04
Loss = 7.4971e-03, PNorm = 36.7022, GNorm = 2.1141, lr_0 = 4.0949e-04
Validation rmse = 0.745314
Epoch 13
Loss = 8.2276e-03, PNorm = 36.7191, GNorm = 5.3738, lr_0 = 4.0352e-04
Loss = 6.4634e-03, PNorm = 36.7368, GNorm = 4.7095, lr_0 = 3.9764e-04
Loss = 6.6419e-03, PNorm = 36.7613, GNorm = 2.3910, lr_0 = 3.9184e-04
Loss = 6.8890e-03, PNorm = 36.7880, GNorm = 2.5247, lr_0 = 3.8613e-04
Loss = 6.5992e-03, PNorm = 36.8087, GNorm = 2.7219, lr_0 = 3.8050e-04
Loss = 6.3442e-03, PNorm = 36.8249, GNorm = 2.3466, lr_0 = 3.7496e-04
Validation rmse = 0.732548
Epoch 14
Loss = 5.8754e-03, PNorm = 36.8409, GNorm = 2.7195, lr_0 = 3.6949e-04
Loss = 5.7203e-03, PNorm = 36.8613, GNorm = 1.4391, lr_0 = 3.6410e-04
Loss = 6.3740e-03, PNorm = 36.8795, GNorm = 1.2028, lr_0 = 3.5880e-04
Loss = 6.0321e-03, PNorm = 36.8923, GNorm = 3.4759, lr_0 = 3.5357e-04
Loss = 6.9199e-03, PNorm = 36.9102, GNorm = 1.8655, lr_0 = 3.4841e-04
Loss = 5.7786e-03, PNorm = 36.9304, GNorm = 4.3154, lr_0 = 3.4333e-04
Validation rmse = 0.721337
Epoch 15
Loss = 5.3792e-03, PNorm = 36.9449, GNorm = 2.2344, lr_0 = 3.3833e-04
Loss = 5.2244e-03, PNorm = 36.9623, GNorm = 2.5197, lr_0 = 3.3340e-04
Loss = 6.4184e-03, PNorm = 36.9774, GNorm = 2.2192, lr_0 = 3.2853e-04
Loss = 6.3352e-03, PNorm = 36.9946, GNorm = 1.0611, lr_0 = 3.2375e-04
Loss = 5.8719e-03, PNorm = 37.0100, GNorm = 3.7012, lr_0 = 3.1903e-04
Validation rmse = 0.737221
Epoch 16
Loss = 4.9735e-03, PNorm = 37.0213, GNorm = 1.4545, lr_0 = 3.1438e-04
Loss = 5.7588e-03, PNorm = 37.0348, GNorm = 3.3405, lr_0 = 3.0979e-04
Loss = 5.8668e-03, PNorm = 37.0502, GNorm = 3.0268, lr_0 = 3.0528e-04
Loss = 5.0294e-03, PNorm = 37.0649, GNorm = 0.9981, lr_0 = 3.0083e-04
Loss = 5.8275e-03, PNorm = 37.0777, GNorm = 2.1260, lr_0 = 2.9644e-04
Loss = 6.8470e-03, PNorm = 37.0926, GNorm = 2.7968, lr_0 = 2.9212e-04
Validation rmse = 0.819047
Epoch 17
Loss = 6.1000e-03, PNorm = 37.1028, GNorm = 1.2788, lr_0 = 2.8786e-04
Loss = 5.7545e-03, PNorm = 37.1166, GNorm = 2.5138, lr_0 = 2.8367e-04
Loss = 6.0380e-03, PNorm = 37.1291, GNorm = 2.6560, lr_0 = 2.7953e-04
Loss = 6.7717e-03, PNorm = 37.1423, GNorm = 2.4990, lr_0 = 2.7546e-04
Loss = 5.9961e-03, PNorm = 37.1598, GNorm = 3.0697, lr_0 = 2.7144e-04
Validation rmse = 0.705882
Epoch 18
Loss = 4.6355e-03, PNorm = 37.1739, GNorm = 1.7069, lr_0 = 2.6748e-04
Loss = 5.1245e-03, PNorm = 37.1888, GNorm = 3.5289, lr_0 = 2.6358e-04
Loss = 6.0543e-03, PNorm = 37.2042, GNorm = 1.6022, lr_0 = 2.5974e-04
Loss = 5.6034e-03, PNorm = 37.2132, GNorm = 1.9900, lr_0 = 2.5595e-04
Loss = 5.1440e-03, PNorm = 37.2227, GNorm = 1.6668, lr_0 = 2.5222e-04
Loss = 5.3200e-03, PNorm = 37.2320, GNorm = 2.2153, lr_0 = 2.4855e-04
Validation rmse = 0.705437
Epoch 19
Loss = 4.6180e-03, PNorm = 37.2437, GNorm = 3.1396, lr_0 = 2.4492e-04
Loss = 6.1797e-03, PNorm = 37.2551, GNorm = 1.7831, lr_0 = 2.4135e-04
Loss = 5.1361e-03, PNorm = 37.2648, GNorm = 1.2269, lr_0 = 2.3783e-04
Loss = 5.5966e-03, PNorm = 37.2768, GNorm = 1.9926, lr_0 = 2.3437e-04
Loss = 4.7235e-03, PNorm = 37.2874, GNorm = 1.4078, lr_0 = 2.3095e-04
Loss = 5.6424e-03, PNorm = 37.2942, GNorm = 2.0020, lr_0 = 2.2758e-04
Validation rmse = 0.718838
Epoch 20
Loss = 5.2680e-03, PNorm = 37.3038, GNorm = 1.5057, lr_0 = 2.2427e-04
Loss = 5.5832e-03, PNorm = 37.3143, GNorm = 2.0704, lr_0 = 2.2100e-04
Loss = 5.4258e-03, PNorm = 37.3263, GNorm = 1.1094, lr_0 = 2.1778e-04
Loss = 5.5831e-03, PNorm = 37.3359, GNorm = 2.1561, lr_0 = 2.1460e-04
Loss = 4.2250e-03, PNorm = 37.3447, GNorm = 1.0065, lr_0 = 2.1147e-04
Validation rmse = 0.680748
Epoch 21
Loss = 3.8081e-03, PNorm = 37.3517, GNorm = 2.0895, lr_0 = 2.0839e-04
Loss = 5.0704e-03, PNorm = 37.3592, GNorm = 2.7465, lr_0 = 2.0535e-04
Loss = 5.0790e-03, PNorm = 37.3689, GNorm = 2.8129, lr_0 = 2.0236e-04
Loss = 4.8141e-03, PNorm = 37.3768, GNorm = 2.1681, lr_0 = 1.9941e-04
Loss = 5.3967e-03, PNorm = 37.3839, GNorm = 2.2880, lr_0 = 1.9650e-04
Loss = 5.7197e-03, PNorm = 37.3941, GNorm = 1.6757, lr_0 = 1.9364e-04
Validation rmse = 0.680655
Epoch 22
Loss = 4.6995e-03, PNorm = 37.4037, GNorm = 1.8217, lr_0 = 1.9081e-04
Loss = 5.3468e-03, PNorm = 37.4137, GNorm = 1.2542, lr_0 = 1.8803e-04
Loss = 4.6098e-03, PNorm = 37.4237, GNorm = 2.0156, lr_0 = 1.8529e-04
Loss = 4.9279e-03, PNorm = 37.4291, GNorm = 1.2061, lr_0 = 1.8259e-04
Loss = 5.4375e-03, PNorm = 37.4352, GNorm = 2.0372, lr_0 = 1.7993e-04
Validation rmse = 0.687816
Epoch 23
Loss = 2.6890e-03, PNorm = 37.4435, GNorm = 1.4983, lr_0 = 1.7731e-04
Loss = 4.5153e-03, PNorm = 37.4506, GNorm = 1.5384, lr_0 = 1.7472e-04
Loss = 4.5683e-03, PNorm = 37.4578, GNorm = 1.9433, lr_0 = 1.7217e-04
Loss = 5.1655e-03, PNorm = 37.4651, GNorm = 2.2988, lr_0 = 1.6966e-04
Loss = 5.8317e-03, PNorm = 37.4722, GNorm = 3.4264, lr_0 = 1.6719e-04
Loss = 5.2523e-03, PNorm = 37.4783, GNorm = 3.6879, lr_0 = 1.6475e-04
Validation rmse = 0.685104
Epoch 24
Loss = 4.9325e-03, PNorm = 37.4853, GNorm = 1.4058, lr_0 = 1.6235e-04
Loss = 4.8220e-03, PNorm = 37.4932, GNorm = 1.3154, lr_0 = 1.5999e-04
Loss = 4.4902e-03, PNorm = 37.5004, GNorm = 2.0325, lr_0 = 1.5765e-04
Loss = 4.8900e-03, PNorm = 37.5078, GNorm = 4.6030, lr_0 = 1.5536e-04
Loss = 4.9929e-03, PNorm = 37.5142, GNorm = 2.2412, lr_0 = 1.5309e-04
Loss = 4.8124e-03, PNorm = 37.5196, GNorm = 2.0348, lr_0 = 1.5086e-04
Validation rmse = 0.671498
Epoch 25
Loss = 4.8584e-03, PNorm = 37.5250, GNorm = 2.2736, lr_0 = 1.4866e-04
Loss = 3.9659e-03, PNorm = 37.5296, GNorm = 2.5812, lr_0 = 1.4649e-04
Loss = 4.7149e-03, PNorm = 37.5351, GNorm = 1.6138, lr_0 = 1.4436e-04
Loss = 4.9176e-03, PNorm = 37.5422, GNorm = 1.9976, lr_0 = 1.4225e-04
Loss = 4.8316e-03, PNorm = 37.5475, GNorm = 3.4493, lr_0 = 1.4018e-04
Validation rmse = 0.669509
Epoch 26
Loss = 4.9439e-03, PNorm = 37.5514, GNorm = 2.4812, lr_0 = 1.3814e-04
Loss = 4.6241e-03, PNorm = 37.5574, GNorm = 1.3603, lr_0 = 1.3612e-04
Loss = 4.0924e-03, PNorm = 37.5628, GNorm = 2.1587, lr_0 = 1.3414e-04
Loss = 4.5250e-03, PNorm = 37.5669, GNorm = 1.8443, lr_0 = 1.3218e-04
Loss = 5.1853e-03, PNorm = 37.5711, GNorm = 1.8457, lr_0 = 1.3026e-04
Loss = 4.6849e-03, PNorm = 37.5773, GNorm = 2.1441, lr_0 = 1.2836e-04
Validation rmse = 0.662486
Epoch 27
Loss = 5.2132e-03, PNorm = 37.5832, GNorm = 2.3651, lr_0 = 1.2649e-04
Loss = 4.3926e-03, PNorm = 37.5874, GNorm = 1.8283, lr_0 = 1.2464e-04
Loss = 4.0167e-03, PNorm = 37.5924, GNorm = 1.6192, lr_0 = 1.2282e-04
Loss = 5.2509e-03, PNorm = 37.5971, GNorm = 1.3755, lr_0 = 1.2103e-04
Loss = 4.2032e-03, PNorm = 37.6023, GNorm = 1.1156, lr_0 = 1.1927e-04
Validation rmse = 0.670148
Epoch 28
Loss = 5.0962e-03, PNorm = 37.6081, GNorm = 3.0659, lr_0 = 1.1753e-04
Loss = 4.8011e-03, PNorm = 37.6129, GNorm = 3.0466, lr_0 = 1.1582e-04
Loss = 4.0237e-03, PNorm = 37.6168, GNorm = 3.8018, lr_0 = 1.1413e-04
Loss = 5.0557e-03, PNorm = 37.6215, GNorm = 2.3085, lr_0 = 1.1247e-04
Loss = 4.1710e-03, PNorm = 37.6261, GNorm = 1.3369, lr_0 = 1.1083e-04
Loss = 4.5920e-03, PNorm = 37.6319, GNorm = 3.3400, lr_0 = 1.0921e-04
Validation rmse = 0.702893
Epoch 29
Loss = 4.9368e-03, PNorm = 37.6338, GNorm = 5.0127, lr_0 = 1.0762e-04
Loss = 4.4235e-03, PNorm = 37.6379, GNorm = 1.3262, lr_0 = 1.0605e-04
Loss = 4.0403e-03, PNorm = 37.6429, GNorm = 1.0806, lr_0 = 1.0450e-04
Loss = 4.5819e-03, PNorm = 37.6473, GNorm = 1.0156, lr_0 = 1.0298e-04
Loss = 5.5406e-03, PNorm = 37.6520, GNorm = 4.3756, lr_0 = 1.0148e-04
Loss = 4.3836e-03, PNorm = 37.6548, GNorm = 2.8502, lr_0 = 1.0000e-04
Validation rmse = 0.667435
Model 0 best validation rmse = 0.662486 on epoch 26
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.678928
Ensemble test rmse = 0.678928
5-fold cross validation
Seed 42 ==> test rmse = 0.662008
Seed 43 ==> test rmse = 0.673568
Seed 44 ==> test rmse = 0.673049
Seed 45 ==> test rmse = 0.669234
Seed 46 ==> test rmse = 0.678928
Overall test rmse = 0.671358 +/- 0.005603
Fold 0
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'cuda': True,
 'data_path': 'dopamine.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cache': False,
 'num_folds': 1,
 'num_lrs': 1,
 'quiet': False,
 'save_dir': 'runs\\fold_0',
 'save_smiles_splits': False,
 'seed': 42,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'test': False,
 'test_fold_index': None,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': None,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 42
Total size = 3,357 | train size = 2,685 | val size = 336 | test size = 336
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Moving model to cuda
Epoch 0
Loss = 2.2644e-02, PNorm = 34.0064, GNorm = 3.6621, lr_0 = 1.8491e-04
Loss = 1.9388e-02, PNorm = 34.0077, GNorm = 0.7995, lr_0 = 2.6981e-04
Loss = 1.9186e-02, PNorm = 34.0136, GNorm = 2.9648, lr_0 = 3.5472e-04
Loss = 1.8152e-02, PNorm = 34.0259, GNorm = 1.3787, lr_0 = 4.3962e-04
Loss = 1.7025e-02, PNorm = 34.0476, GNorm = 3.2910, lr_0 = 5.2453e-04
Validation rmse = 0.959590
Epoch 1
Loss = 1.8758e-02, PNorm = 34.0747, GNorm = 4.7505, lr_0 = 6.0943e-04
Loss = 1.8277e-02, PNorm = 34.1101, GNorm = 0.9055, lr_0 = 6.9434e-04
Loss = 1.6724e-02, PNorm = 34.1627, GNorm = 4.1259, lr_0 = 7.7925e-04
Loss = 1.5176e-02, PNorm = 34.2203, GNorm = 2.5550, lr_0 = 8.6415e-04
Loss = 1.4858e-02, PNorm = 34.2820, GNorm = 1.0785, lr_0 = 9.4906e-04
Validation rmse = 0.860374
Epoch 2
Loss = 1.3863e-02, PNorm = 34.3674, GNorm = 1.8226, lr_0 = 9.9381e-04
Loss = 1.4914e-02, PNorm = 34.4616, GNorm = 5.8762, lr_0 = 9.7851e-04
Loss = 1.3138e-02, PNorm = 34.5556, GNorm = 4.3654, lr_0 = 9.6345e-04
Loss = 1.4019e-02, PNorm = 34.6505, GNorm = 3.3122, lr_0 = 9.4861e-04
Loss = 1.3553e-02, PNorm = 34.7410, GNorm = 3.8251, lr_0 = 9.3401e-04
Validation rmse = 0.816106
Epoch 3
Loss = 1.2138e-02, PNorm = 34.8130, GNorm = 1.0700, lr_0 = 9.1963e-04
Loss = 1.2382e-02, PNorm = 34.8925, GNorm = 2.2332, lr_0 = 9.0547e-04
Loss = 1.2329e-02, PNorm = 34.9834, GNorm = 1.2211, lr_0 = 8.9153e-04
Loss = 1.0088e-02, PNorm = 35.0738, GNorm = 1.3261, lr_0 = 8.7780e-04
Loss = 1.2288e-02, PNorm = 35.1547, GNorm = 4.8171, lr_0 = 8.6429e-04
Loss = 1.3890e-02, PNorm = 35.2296, GNorm = 2.4306, lr_0 = 8.5098e-04
Validation rmse = 0.891738
Epoch 4
Loss = 1.1480e-02, PNorm = 35.3258, GNorm = 2.2332, lr_0 = 8.3788e-04
Loss = 1.0447e-02, PNorm = 35.4080, GNorm = 1.9457, lr_0 = 8.2498e-04
Loss = 1.1249e-02, PNorm = 35.4983, GNorm = 3.6272, lr_0 = 8.1228e-04
Loss = 1.0032e-02, PNorm = 35.5785, GNorm = 3.5981, lr_0 = 7.9977e-04
Loss = 1.1436e-02, PNorm = 35.6541, GNorm = 1.0561, lr_0 = 7.8746e-04
Validation rmse = 0.786245
Epoch 5
Loss = 9.4613e-03, PNorm = 35.7296, GNorm = 1.6448, lr_0 = 7.7533e-04
Loss = 1.0345e-02, PNorm = 35.7983, GNorm = 5.5356, lr_0 = 7.6340e-04
Loss = 9.5306e-03, PNorm = 35.8671, GNorm = 2.2831, lr_0 = 7.5164e-04
Loss = 1.0294e-02, PNorm = 35.9236, GNorm = 1.2185, lr_0 = 7.4007e-04
Loss = 9.9649e-03, PNorm = 35.9759, GNorm = 2.2203, lr_0 = 7.2867e-04
Validation rmse = 0.742532
Epoch 6
Loss = 8.5813e-03, PNorm = 36.0246, GNorm = 1.2677, lr_0 = 7.1746e-04
Loss = 8.7879e-03, PNorm = 36.0773, GNorm = 2.2411, lr_0 = 7.0641e-04
Loss = 8.8337e-03, PNorm = 36.1411, GNorm = 3.0875, lr_0 = 6.9553e-04
Loss = 9.8556e-03, PNorm = 36.1963, GNorm = 1.5193, lr_0 = 6.8482e-04
Loss = 8.8139e-03, PNorm = 36.2332, GNorm = 1.4015, lr_0 = 6.7428e-04
Loss = 8.4021e-03, PNorm = 36.2789, GNorm = 3.4739, lr_0 = 6.6390e-04
Validation rmse = 0.711828
Epoch 7
Loss = 8.9445e-03, PNorm = 36.3374, GNorm = 3.6024, lr_0 = 6.5368e-04
Loss = 8.5869e-03, PNorm = 36.3876, GNorm = 1.8413, lr_0 = 6.4361e-04
Loss = 8.0812e-03, PNorm = 36.4433, GNorm = 3.5199, lr_0 = 6.3370e-04
Loss = 8.4918e-03, PNorm = 36.4953, GNorm = 3.6780, lr_0 = 6.2395e-04
Loss = 9.5546e-03, PNorm = 36.5380, GNorm = 1.7172, lr_0 = 6.1434e-04
Validation rmse = 0.772133
Epoch 8
Loss = 9.0176e-03, PNorm = 36.5731, GNorm = 5.6146, lr_0 = 6.0488e-04
Loss = 8.9774e-03, PNorm = 36.6255, GNorm = 4.0037, lr_0 = 5.9557e-04
Loss = 9.3420e-03, PNorm = 36.6759, GNorm = 1.7571, lr_0 = 5.8640e-04
Loss = 8.9216e-03, PNorm = 36.7185, GNorm = 4.6615, lr_0 = 5.7737e-04
Loss = 9.0455e-03, PNorm = 36.7522, GNorm = 3.2340, lr_0 = 5.6848e-04
Validation rmse = 0.704680
Epoch 9
Loss = 6.7759e-03, PNorm = 36.7969, GNorm = 0.9772, lr_0 = 5.5973e-04
Loss = 7.0164e-03, PNorm = 36.8434, GNorm = 1.9554, lr_0 = 5.5111e-04
Loss = 7.6240e-03, PNorm = 36.8832, GNorm = 0.7615, lr_0 = 5.4263e-04
Loss = 7.1893e-03, PNorm = 36.9149, GNorm = 0.9118, lr_0 = 5.3427e-04
Loss = 8.2069e-03, PNorm = 36.9457, GNorm = 2.2082, lr_0 = 5.2605e-04
Loss = 8.1326e-03, PNorm = 36.9762, GNorm = 1.2242, lr_0 = 5.1795e-04
Validation rmse = 0.697751
Epoch 10
Loss = 6.8608e-03, PNorm = 37.0150, GNorm = 2.5179, lr_0 = 5.0997e-04
Loss = 6.4029e-03, PNorm = 37.0508, GNorm = 0.7138, lr_0 = 5.0212e-04
Loss = 8.4971e-03, PNorm = 37.0828, GNorm = 1.5740, lr_0 = 4.9439e-04
Loss = 7.3370e-03, PNorm = 37.1156, GNorm = 3.0146, lr_0 = 4.8678e-04
Loss = 7.3587e-03, PNorm = 37.1417, GNorm = 1.7421, lr_0 = 4.7928e-04
Validation rmse = 0.678399
Epoch 11
Loss = 6.5764e-03, PNorm = 37.1748, GNorm = 1.4039, lr_0 = 4.7190e-04
Loss = 7.3156e-03, PNorm = 37.2146, GNorm = 1.6183, lr_0 = 4.6464e-04
Loss = 7.7564e-03, PNorm = 37.2404, GNorm = 4.3797, lr_0 = 4.5749e-04
Loss = 7.3850e-03, PNorm = 37.2707, GNorm = 2.2284, lr_0 = 4.5044e-04
Loss = 7.3457e-03, PNorm = 37.2988, GNorm = 3.7516, lr_0 = 4.4351e-04
Validation rmse = 0.665573
Epoch 12
Loss = 7.0824e-03, PNorm = 37.3312, GNorm = 2.7538, lr_0 = 4.3668e-04
Loss = 5.9886e-03, PNorm = 37.3650, GNorm = 1.6453, lr_0 = 4.2996e-04
Loss = 7.1781e-03, PNorm = 37.3908, GNorm = 1.3626, lr_0 = 4.2334e-04
Loss = 6.6304e-03, PNorm = 37.4164, GNorm = 1.8344, lr_0 = 4.1682e-04
Loss = 6.9273e-03, PNorm = 37.4408, GNorm = 2.0398, lr_0 = 4.1040e-04
Validation rmse = 0.662960
Epoch 13
Loss = 5.4450e-03, PNorm = 37.4660, GNorm = 1.3554, lr_0 = 4.0408e-04
Loss = 5.7448e-03, PNorm = 37.4860, GNorm = 2.2298, lr_0 = 3.9786e-04
Loss = 6.8720e-03, PNorm = 37.5108, GNorm = 1.8427, lr_0 = 3.9173e-04
Loss = 6.3133e-03, PNorm = 37.5355, GNorm = 2.5954, lr_0 = 3.8570e-04
Loss = 7.0460e-03, PNorm = 37.5594, GNorm = 1.6376, lr_0 = 3.7976e-04
Loss = 6.3107e-03, PNorm = 37.5838, GNorm = 1.1855, lr_0 = 3.7392e-04
Validation rmse = 0.663730
Epoch 14
Loss = 6.6414e-03, PNorm = 37.6037, GNorm = 1.5203, lr_0 = 3.6816e-04
Loss = 6.3714e-03, PNorm = 37.6319, GNorm = 1.1898, lr_0 = 3.6249e-04
Loss = 5.8188e-03, PNorm = 37.6556, GNorm = 1.1715, lr_0 = 3.5691e-04
Loss = 5.3057e-03, PNorm = 37.6721, GNorm = 2.3521, lr_0 = 3.5142e-04
Loss = 6.5078e-03, PNorm = 37.6854, GNorm = 3.8188, lr_0 = 3.4601e-04
Validation rmse = 0.655844
Epoch 15
Loss = 5.4838e-03, PNorm = 37.7050, GNorm = 1.2317, lr_0 = 3.4068e-04
Loss = 6.1117e-03, PNorm = 37.7302, GNorm = 1.1543, lr_0 = 3.3543e-04
Loss = 6.1132e-03, PNorm = 37.7540, GNorm = 1.5284, lr_0 = 3.3027e-04
Loss = 6.7809e-03, PNorm = 37.7750, GNorm = 3.7663, lr_0 = 3.2518e-04
Loss = 5.9184e-03, PNorm = 37.7927, GNorm = 1.5630, lr_0 = 3.2018e-04
Validation rmse = 0.678274
Epoch 16
Loss = 6.5081e-03, PNorm = 37.8108, GNorm = 1.7976, lr_0 = 3.1525e-04
Loss = 5.9199e-03, PNorm = 37.8286, GNorm = 3.4290, lr_0 = 3.1039e-04
Loss = 6.0152e-03, PNorm = 37.8466, GNorm = 1.2348, lr_0 = 3.0562e-04
Loss = 5.6905e-03, PNorm = 37.8654, GNorm = 1.3882, lr_0 = 3.0091e-04
Loss = 5.9839e-03, PNorm = 37.8863, GNorm = 1.6910, lr_0 = 2.9628e-04
Loss = 5.9578e-03, PNorm = 37.8963, GNorm = 1.3078, lr_0 = 2.9172e-04
Validation rmse = 0.652309
Epoch 17
Loss = 4.8538e-03, PNorm = 37.9110, GNorm = 1.1454, lr_0 = 2.8722e-04
Loss = 5.9681e-03, PNorm = 37.9276, GNorm = 1.6812, lr_0 = 2.8280e-04
Loss = 4.8588e-03, PNorm = 37.9463, GNorm = 2.1925, lr_0 = 2.7845e-04
Loss = 5.6749e-03, PNorm = 37.9603, GNorm = 2.2374, lr_0 = 2.7416e-04
Loss = 6.1814e-03, PNorm = 37.9742, GNorm = 2.5246, lr_0 = 2.6994e-04
Validation rmse = 0.639946
Epoch 18
Loss = 5.2149e-03, PNorm = 37.9886, GNorm = 3.3543, lr_0 = 2.6578e-04
Loss = 5.6220e-03, PNorm = 38.0056, GNorm = 2.0959, lr_0 = 2.6169e-04
Loss = 5.3102e-03, PNorm = 38.0195, GNorm = 1.5464, lr_0 = 2.5766e-04
Loss = 6.4505e-03, PNorm = 38.0324, GNorm = 2.7664, lr_0 = 2.5370e-04
Loss = 5.1072e-03, PNorm = 38.0505, GNorm = 1.3124, lr_0 = 2.4979e-04
Validation rmse = 0.635796
Epoch 19
Loss = 5.1333e-03, PNorm = 38.0674, GNorm = 1.8108, lr_0 = 2.4594e-04
Loss = 5.0466e-03, PNorm = 38.0802, GNorm = 1.5978, lr_0 = 2.4216e-04
Loss = 5.1486e-03, PNorm = 38.0991, GNorm = 1.0710, lr_0 = 2.3843e-04
Loss = 5.6343e-03, PNorm = 38.1146, GNorm = 1.1255, lr_0 = 2.3476e-04
Loss = 5.3397e-03, PNorm = 38.1260, GNorm = 1.2727, lr_0 = 2.3114e-04
Loss = 5.6961e-03, PNorm = 38.1346, GNorm = 2.3298, lr_0 = 2.2758e-04
Validation rmse = 0.625878
Epoch 20
Loss = 5.6952e-03, PNorm = 38.1435, GNorm = 1.1545, lr_0 = 2.2408e-04
Loss = 5.1502e-03, PNorm = 38.1583, GNorm = 1.1526, lr_0 = 2.2063e-04
Loss = 5.0334e-03, PNorm = 38.1701, GNorm = 1.9526, lr_0 = 2.1723e-04
Loss = 5.2004e-03, PNorm = 38.1815, GNorm = 1.7182, lr_0 = 2.1389e-04
Loss = 5.1829e-03, PNorm = 38.1930, GNorm = 1.9902, lr_0 = 2.1060e-04
Validation rmse = 0.617919
Epoch 21
Loss = 4.8311e-03, PNorm = 38.2062, GNorm = 1.5678, lr_0 = 2.0735e-04
Loss = 5.3387e-03, PNorm = 38.2188, GNorm = 1.6928, lr_0 = 2.0416e-04
Loss = 5.8607e-03, PNorm = 38.2323, GNorm = 2.7317, lr_0 = 2.0102e-04
Loss = 4.8131e-03, PNorm = 38.2425, GNorm = 1.1361, lr_0 = 1.9792e-04
Loss = 5.1043e-03, PNorm = 38.2506, GNorm = 2.5833, lr_0 = 1.9488e-04
Validation rmse = 0.618351
Epoch 22
Loss = 4.1234e-03, PNorm = 38.2575, GNorm = 1.5404, lr_0 = 1.9188e-04
Loss = 5.0225e-03, PNorm = 38.2680, GNorm = 2.2046, lr_0 = 1.8892e-04
Loss = 5.4511e-03, PNorm = 38.2813, GNorm = 1.6570, lr_0 = 1.8601e-04
Loss = 5.1857e-03, PNorm = 38.2866, GNorm = 1.8227, lr_0 = 1.8315e-04
Loss = 4.6474e-03, PNorm = 38.2955, GNorm = 1.9145, lr_0 = 1.8033e-04
Validation rmse = 0.619064
Epoch 23
Loss = 3.7679e-03, PNorm = 38.3080, GNorm = 1.1132, lr_0 = 1.7755e-04
Loss = 5.3496e-03, PNorm = 38.3220, GNorm = 3.1917, lr_0 = 1.7482e-04
Loss = 4.5581e-03, PNorm = 38.3322, GNorm = 2.2586, lr_0 = 1.7213e-04
Loss = 4.4575e-03, PNorm = 38.3389, GNorm = 2.2630, lr_0 = 1.6948e-04
Loss = 5.4670e-03, PNorm = 38.3478, GNorm = 1.0773, lr_0 = 1.6687e-04
Loss = 5.6954e-03, PNorm = 38.3538, GNorm = 2.3436, lr_0 = 1.6430e-04
Validation rmse = 0.624120
Epoch 24
Loss = 4.8973e-03, PNorm = 38.3634, GNorm = 1.5192, lr_0 = 1.6177e-04
Loss = 5.5915e-03, PNorm = 38.3739, GNorm = 3.7931, lr_0 = 1.5928e-04
Loss = 4.7835e-03, PNorm = 38.3832, GNorm = 1.5779, lr_0 = 1.5683e-04
Loss = 5.1864e-03, PNorm = 38.3911, GNorm = 3.0593, lr_0 = 1.5441e-04
Loss = 4.7934e-03, PNorm = 38.3971, GNorm = 1.6290, lr_0 = 1.5203e-04
Validation rmse = 0.621362
Epoch 25
Loss = 3.4568e-03, PNorm = 38.4046, GNorm = 1.0806, lr_0 = 1.4969e-04
Loss = 5.3897e-03, PNorm = 38.4123, GNorm = 1.5075, lr_0 = 1.4739e-04
Loss = 4.4940e-03, PNorm = 38.4197, GNorm = 1.5925, lr_0 = 1.4512e-04
Loss = 5.7025e-03, PNorm = 38.4262, GNorm = 1.6966, lr_0 = 1.4288e-04
Loss = 4.8812e-03, PNorm = 38.4328, GNorm = 3.1854, lr_0 = 1.4069e-04
Validation rmse = 0.626336
Epoch 26
Loss = 5.6980e-03, PNorm = 38.4412, GNorm = 3.2059, lr_0 = 1.3852e-04
Loss = 5.1264e-03, PNorm = 38.4483, GNorm = 1.4514, lr_0 = 1.3639e-04
Loss = 4.2662e-03, PNorm = 38.4561, GNorm = 1.0304, lr_0 = 1.3429e-04
Loss = 5.3052e-03, PNorm = 38.4618, GNorm = 2.1283, lr_0 = 1.3222e-04
Loss = 4.1536e-03, PNorm = 38.4700, GNorm = 1.7850, lr_0 = 1.3018e-04
Loss = 5.0571e-03, PNorm = 38.4759, GNorm = 3.8451, lr_0 = 1.2818e-04
Validation rmse = 0.607465
Epoch 27
Loss = 4.6689e-03, PNorm = 38.4823, GNorm = 1.5669, lr_0 = 1.2621e-04
Loss = 4.3621e-03, PNorm = 38.4883, GNorm = 2.2805, lr_0 = 1.2426e-04
Loss = 4.5640e-03, PNorm = 38.4934, GNorm = 2.1790, lr_0 = 1.2235e-04
Loss = 5.4292e-03, PNorm = 38.5002, GNorm = 2.4535, lr_0 = 1.2047e-04
Loss = 4.3533e-03, PNorm = 38.5059, GNorm = 1.2847, lr_0 = 1.1861e-04
Validation rmse = 0.605155
Epoch 28
Loss = 4.5191e-03, PNorm = 38.5113, GNorm = 2.8779, lr_0 = 1.1678e-04
Loss = 4.4833e-03, PNorm = 38.5166, GNorm = 1.9531, lr_0 = 1.1499e-04
Loss = 4.6694e-03, PNorm = 38.5226, GNorm = 1.4995, lr_0 = 1.1322e-04
Loss = 5.1135e-03, PNorm = 38.5294, GNorm = 2.3178, lr_0 = 1.1147e-04
Loss = 4.4578e-03, PNorm = 38.5340, GNorm = 2.8996, lr_0 = 1.0976e-04
Validation rmse = 0.610148
Epoch 29
Loss = 4.0221e-03, PNorm = 38.5402, GNorm = 1.3411, lr_0 = 1.0807e-04
Loss = 4.3658e-03, PNorm = 38.5466, GNorm = 2.4782, lr_0 = 1.0640e-04
Loss = 4.1252e-03, PNorm = 38.5511, GNorm = 2.6269, lr_0 = 1.0476e-04
Loss = 4.4208e-03, PNorm = 38.5558, GNorm = 1.6730, lr_0 = 1.0315e-04
Loss = 4.5375e-03, PNorm = 38.5597, GNorm = 1.7284, lr_0 = 1.0156e-04
Loss = 5.4820e-03, PNorm = 38.5651, GNorm = 2.3902, lr_0 = 1.0000e-04
Validation rmse = 0.606490
Model 0 best validation rmse = 0.605155 on epoch 27
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.583515
Ensemble test rmse = 0.583515
1-fold cross validation
Seed 42 ==> test rmse = 0.583515
Overall test rmse = 0.583515 +/- 0.000000
Fold 0
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'cuda': True,
 'data_path': 'dopamine_new.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cache': False,
 'num_folds': 1,
 'num_lrs': 1,
 'quiet': False,
 'save_dir': 'runs\\fold_0',
 'save_smiles_splits': False,
 'seed': 42,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'test': False,
 'test_fold_index': None,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': None,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 42
Total size = 7,199 | train size = 5,759 | val size = 720 | test size = 720
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Moving model to cuda
Epoch 0
Loss = 2.0327e-02, PNorm = 33.9268, GNorm = 2.6244, lr_0 = 1.3913e-04
Loss = 1.7740e-02, PNorm = 33.9299, GNorm = 4.9664, lr_0 = 1.7826e-04
Loss = 1.9996e-02, PNorm = 33.9333, GNorm = 3.2356, lr_0 = 2.1739e-04
Loss = 1.8474e-02, PNorm = 33.9388, GNorm = 0.6332, lr_0 = 2.5652e-04
Loss = 1.6428e-02, PNorm = 33.9472, GNorm = 4.0731, lr_0 = 2.9565e-04
Loss = 1.6592e-02, PNorm = 33.9602, GNorm = 5.8761, lr_0 = 3.3478e-04
Loss = 2.0873e-02, PNorm = 33.9777, GNorm = 3.4439, lr_0 = 3.7391e-04
Loss = 1.7776e-02, PNorm = 33.9958, GNorm = 1.4389, lr_0 = 4.1304e-04
Loss = 1.5437e-02, PNorm = 34.0198, GNorm = 2.7139, lr_0 = 4.5217e-04
Loss = 1.6334e-02, PNorm = 34.0478, GNorm = 3.8179, lr_0 = 4.9130e-04
Loss = 1.5875e-02, PNorm = 34.0727, GNorm = 3.1883, lr_0 = 5.3043e-04
Validation rmse = 1.040869
Epoch 1
Loss = 1.7414e-02, PNorm = 34.1047, GNorm = 5.0171, lr_0 = 5.6957e-04
Loss = 1.4607e-02, PNorm = 34.1396, GNorm = 3.9948, lr_0 = 6.0870e-04
Loss = 1.5355e-02, PNorm = 34.1807, GNorm = 1.2533, lr_0 = 6.4783e-04
Loss = 1.5381e-02, PNorm = 34.2246, GNorm = 4.0630, lr_0 = 6.8696e-04
Loss = 1.6319e-02, PNorm = 34.2833, GNorm = 10.3897, lr_0 = 7.2609e-04
Loss = 1.5799e-02, PNorm = 34.3378, GNorm = 2.1440, lr_0 = 7.6522e-04
Loss = 1.4173e-02, PNorm = 34.4030, GNorm = 3.7219, lr_0 = 8.0435e-04
Loss = 1.5582e-02, PNorm = 34.4602, GNorm = 1.7488, lr_0 = 8.4348e-04
Loss = 1.4072e-02, PNorm = 34.5316, GNorm = 1.3364, lr_0 = 8.8261e-04
Loss = 1.3056e-02, PNorm = 34.6211, GNorm = 0.9354, lr_0 = 9.2174e-04
Loss = 9.9136e-03, PNorm = 34.7107, GNorm = 4.3744, lr_0 = 9.6087e-04
Loss = 1.2073e-02, PNorm = 34.7944, GNorm = 2.7275, lr_0 = 1.0000e-03
Validation rmse = 1.083315
Epoch 2
Loss = 1.1602e-02, PNorm = 34.8784, GNorm = 1.5569, lr_0 = 9.9287e-04
Loss = 1.1947e-02, PNorm = 34.9593, GNorm = 3.6571, lr_0 = 9.8580e-04
Loss = 1.1781e-02, PNorm = 35.0501, GNorm = 2.7708, lr_0 = 9.7878e-04
Loss = 1.0845e-02, PNorm = 35.1402, GNorm = 2.3668, lr_0 = 9.7180e-04
Loss = 1.0889e-02, PNorm = 35.2127, GNorm = 3.0353, lr_0 = 9.6488e-04
Loss = 1.1024e-02, PNorm = 35.2845, GNorm = 3.6064, lr_0 = 9.5800e-04
Loss = 1.2128e-02, PNorm = 35.3623, GNorm = 3.7895, lr_0 = 9.5118e-04
Loss = 1.2082e-02, PNorm = 35.4226, GNorm = 1.9060, lr_0 = 9.4440e-04
Loss = 1.1300e-02, PNorm = 35.4802, GNorm = 2.0875, lr_0 = 9.3767e-04
Loss = 1.0841e-02, PNorm = 35.5376, GNorm = 3.3946, lr_0 = 9.3099e-04
Loss = 1.0830e-02, PNorm = 35.5768, GNorm = 4.9142, lr_0 = 9.2435e-04
Validation rmse = 0.946826
Epoch 3
Loss = 1.1788e-02, PNorm = 35.6283, GNorm = 1.8185, lr_0 = 9.1777e-04
Loss = 1.1437e-02, PNorm = 35.6992, GNorm = 1.2752, lr_0 = 9.1123e-04
Loss = 1.0044e-02, PNorm = 35.7730, GNorm = 1.7998, lr_0 = 9.0474e-04
Loss = 9.1176e-03, PNorm = 35.8393, GNorm = 1.8646, lr_0 = 8.9829e-04
Loss = 1.3540e-02, PNorm = 35.8863, GNorm = 3.5560, lr_0 = 8.9189e-04
Loss = 1.0542e-02, PNorm = 35.9465, GNorm = 4.4855, lr_0 = 8.8553e-04
Loss = 9.5340e-03, PNorm = 35.9883, GNorm = 2.2683, lr_0 = 8.7922e-04
Loss = 1.0777e-02, PNorm = 36.0441, GNorm = 4.5900, lr_0 = 8.7296e-04
Loss = 1.0228e-02, PNorm = 36.0983, GNorm = 1.7322, lr_0 = 8.6674e-04
Loss = 9.2182e-03, PNorm = 36.1517, GNorm = 2.2786, lr_0 = 8.6056e-04
Loss = 9.2401e-03, PNorm = 36.1991, GNorm = 1.3066, lr_0 = 8.5443e-04
Loss = 8.3889e-03, PNorm = 36.2309, GNorm = 0.8291, lr_0 = 8.4834e-04
Validation rmse = 0.824483
Epoch 4
Loss = 8.3477e-03, PNorm = 36.2668, GNorm = 1.4873, lr_0 = 8.4230e-04
Loss = 8.9443e-03, PNorm = 36.3074, GNorm = 2.9014, lr_0 = 8.3630e-04
Loss = 8.2837e-03, PNorm = 36.3393, GNorm = 3.6270, lr_0 = 8.3034e-04
Loss = 9.1183e-03, PNorm = 36.3748, GNorm = 1.5908, lr_0 = 8.2442e-04
Loss = 9.1703e-03, PNorm = 36.4166, GNorm = 1.0123, lr_0 = 8.1855e-04
Loss = 1.0080e-02, PNorm = 36.4583, GNorm = 1.6323, lr_0 = 8.1271e-04
Loss = 8.0990e-03, PNorm = 36.4973, GNorm = 2.5072, lr_0 = 8.0692e-04
Loss = 8.6461e-03, PNorm = 36.5397, GNorm = 2.7422, lr_0 = 8.0117e-04
Loss = 8.6539e-03, PNorm = 36.5915, GNorm = 1.6710, lr_0 = 7.9547e-04
Loss = 8.7782e-03, PNorm = 36.6406, GNorm = 1.4626, lr_0 = 7.8980e-04
Loss = 8.1438e-03, PNorm = 36.6884, GNorm = 1.6666, lr_0 = 7.8417e-04
Validation rmse = 0.834508
Epoch 5
Loss = 8.4138e-03, PNorm = 36.7443, GNorm = 5.0171, lr_0 = 7.7858e-04
Loss = 7.7145e-03, PNorm = 36.7937, GNorm = 1.3143, lr_0 = 7.7303e-04
Loss = 8.7399e-03, PNorm = 36.8406, GNorm = 1.9677, lr_0 = 7.6753e-04
Loss = 1.0385e-02, PNorm = 36.8836, GNorm = 4.1252, lr_0 = 7.6206e-04
Loss = 9.0775e-03, PNorm = 36.9226, GNorm = 1.5872, lr_0 = 7.5663e-04
Loss = 9.3423e-03, PNorm = 36.9759, GNorm = 2.1611, lr_0 = 7.5124e-04
Loss = 7.9688e-03, PNorm = 37.0123, GNorm = 2.4252, lr_0 = 7.4588e-04
Loss = 7.7488e-03, PNorm = 37.0546, GNorm = 0.7970, lr_0 = 7.4057e-04
Loss = 7.4784e-03, PNorm = 37.0871, GNorm = 1.3675, lr_0 = 7.3529e-04
Loss = 7.7191e-03, PNorm = 37.1001, GNorm = 1.0583, lr_0 = 7.3005e-04
Loss = 8.7008e-03, PNorm = 37.1390, GNorm = 0.8573, lr_0 = 7.2485e-04
Loss = 8.4274e-03, PNorm = 37.1723, GNorm = 1.9620, lr_0 = 7.1969e-04
Validation rmse = 0.784714
Epoch 6
Loss = 6.6720e-03, PNorm = 37.2108, GNorm = 1.6409, lr_0 = 7.1456e-04
Loss = 8.9364e-03, PNorm = 37.2600, GNorm = 3.0593, lr_0 = 7.0947e-04
Loss = 7.2658e-03, PNorm = 37.3005, GNorm = 6.1211, lr_0 = 7.0441e-04
Loss = 7.9527e-03, PNorm = 37.3364, GNorm = 2.3132, lr_0 = 6.9939e-04
Loss = 7.3073e-03, PNorm = 37.3743, GNorm = 2.4387, lr_0 = 6.9441e-04
Loss = 7.6339e-03, PNorm = 37.3988, GNorm = 1.1348, lr_0 = 6.8946e-04
Loss = 8.6381e-03, PNorm = 37.4321, GNorm = 1.8191, lr_0 = 6.8455e-04
Loss = 7.9724e-03, PNorm = 37.4612, GNorm = 1.3809, lr_0 = 6.7967e-04
Loss = 8.4888e-03, PNorm = 37.4864, GNorm = 1.4246, lr_0 = 6.7483e-04
Loss = 8.0526e-03, PNorm = 37.5167, GNorm = 2.1858, lr_0 = 6.7002e-04
Loss = 8.1020e-03, PNorm = 37.5444, GNorm = 1.5687, lr_0 = 6.6524e-04
Validation rmse = 0.758805
Epoch 7
Loss = 7.6267e-03, PNorm = 37.5783, GNorm = 2.2943, lr_0 = 6.6050e-04
Loss = 7.9927e-03, PNorm = 37.6200, GNorm = 2.4975, lr_0 = 6.5580e-04
Loss = 6.5026e-03, PNorm = 37.6464, GNorm = 1.5158, lr_0 = 6.5113e-04
Loss = 6.6507e-03, PNorm = 37.6719, GNorm = 0.9736, lr_0 = 6.4649e-04
Loss = 7.2558e-03, PNorm = 37.7004, GNorm = 0.9219, lr_0 = 6.4188e-04
Loss = 8.1052e-03, PNorm = 37.7335, GNorm = 1.4107, lr_0 = 6.3731e-04
Loss = 7.5234e-03, PNorm = 37.7674, GNorm = 1.3273, lr_0 = 6.3276e-04
Loss = 7.2024e-03, PNorm = 37.7976, GNorm = 2.9312, lr_0 = 6.2826e-04
Loss = 8.5886e-03, PNorm = 37.8365, GNorm = 2.5694, lr_0 = 6.2378e-04
Loss = 7.7878e-03, PNorm = 37.8674, GNorm = 1.4598, lr_0 = 6.1933e-04
Loss = 6.5424e-03, PNorm = 37.8894, GNorm = 1.0960, lr_0 = 6.1492e-04
Loss = 6.5307e-03, PNorm = 37.9142, GNorm = 2.3766, lr_0 = 6.1054e-04
Validation rmse = 0.759548
Epoch 8
Loss = 6.9096e-03, PNorm = 37.9414, GNorm = 1.0475, lr_0 = 6.0619e-04
Loss = 6.9177e-03, PNorm = 37.9729, GNorm = 1.5318, lr_0 = 6.0187e-04
Loss = 6.5909e-03, PNorm = 37.9994, GNorm = 1.0203, lr_0 = 5.9758e-04
Loss = 6.8475e-03, PNorm = 38.0193, GNorm = 1.4787, lr_0 = 5.9332e-04
Loss = 6.3126e-03, PNorm = 38.0444, GNorm = 1.2729, lr_0 = 5.8910e-04
Loss = 6.7993e-03, PNorm = 38.0634, GNorm = 1.8851, lr_0 = 5.8490e-04
Loss = 7.5662e-03, PNorm = 38.0828, GNorm = 2.7959, lr_0 = 5.8073e-04
Loss = 6.7574e-03, PNorm = 38.1089, GNorm = 0.9643, lr_0 = 5.7659e-04
Loss = 7.2003e-03, PNorm = 38.1366, GNorm = 1.6537, lr_0 = 5.7248e-04
Loss = 7.8761e-03, PNorm = 38.1551, GNorm = 1.2714, lr_0 = 5.6841e-04
Loss = 6.1835e-03, PNorm = 38.1785, GNorm = 1.2801, lr_0 = 5.6436e-04
Validation rmse = 0.743999
Epoch 9
Loss = 7.5221e-03, PNorm = 38.2081, GNorm = 2.2634, lr_0 = 5.6033e-04
Loss = 5.9726e-03, PNorm = 38.2277, GNorm = 1.1106, lr_0 = 5.5634e-04
Loss = 6.7274e-03, PNorm = 38.2533, GNorm = 1.5396, lr_0 = 5.5238e-04
Loss = 5.8928e-03, PNorm = 38.2784, GNorm = 1.5742, lr_0 = 5.4844e-04
Loss = 6.6190e-03, PNorm = 38.3068, GNorm = 2.3079, lr_0 = 5.4453e-04
Loss = 6.8153e-03, PNorm = 38.3364, GNorm = 2.5156, lr_0 = 5.4065e-04
Loss = 5.9694e-03, PNorm = 38.3628, GNorm = 2.6506, lr_0 = 5.3680e-04
Loss = 6.9180e-03, PNorm = 38.3782, GNorm = 1.2122, lr_0 = 5.3298e-04
Loss = 6.2610e-03, PNorm = 38.4020, GNorm = 1.7147, lr_0 = 5.2918e-04
Loss = 6.5568e-03, PNorm = 38.4214, GNorm = 1.4768, lr_0 = 5.2541e-04
Loss = 6.8403e-03, PNorm = 38.4381, GNorm = 3.3571, lr_0 = 5.2166e-04
Loss = 6.3657e-03, PNorm = 38.4563, GNorm = 1.2766, lr_0 = 5.1795e-04
Validation rmse = 0.734808
Epoch 10
Loss = 6.6218e-03, PNorm = 38.4832, GNorm = 1.1743, lr_0 = 5.1426e-04
Loss = 6.9956e-03, PNorm = 38.5081, GNorm = 2.5680, lr_0 = 5.1059e-04
Loss = 5.8221e-03, PNorm = 38.5287, GNorm = 1.0079, lr_0 = 5.0695e-04
Loss = 6.6515e-03, PNorm = 38.5472, GNorm = 1.8063, lr_0 = 5.0334e-04
Loss = 5.8314e-03, PNorm = 38.5670, GNorm = 0.8383, lr_0 = 4.9976e-04
Loss = 6.1468e-03, PNorm = 38.5840, GNorm = 1.9465, lr_0 = 4.9619e-04
Loss = 7.1798e-03, PNorm = 38.5957, GNorm = 1.6441, lr_0 = 4.9266e-04
Loss = 6.1902e-03, PNorm = 38.6247, GNorm = 2.3923, lr_0 = 4.8915e-04
Loss = 6.3432e-03, PNorm = 38.6416, GNorm = 3.3139, lr_0 = 4.8566e-04
Loss = 5.9738e-03, PNorm = 38.6589, GNorm = 1.2527, lr_0 = 4.8220e-04
Loss = 4.6477e-03, PNorm = 38.6793, GNorm = 0.9212, lr_0 = 4.7877e-04
Validation rmse = 0.708487
Epoch 11
Loss = 5.4348e-03, PNorm = 38.6952, GNorm = 1.4105, lr_0 = 4.7536e-04
Loss = 6.0419e-03, PNorm = 38.7119, GNorm = 3.0468, lr_0 = 4.7197e-04
Loss = 6.2870e-03, PNorm = 38.7240, GNorm = 1.5705, lr_0 = 4.6861e-04
Loss = 6.6923e-03, PNorm = 38.7461, GNorm = 2.1100, lr_0 = 4.6527e-04
Loss = 5.9128e-03, PNorm = 38.7701, GNorm = 2.2050, lr_0 = 4.6195e-04
Loss = 5.1329e-03, PNorm = 38.7893, GNorm = 1.7570, lr_0 = 4.5866e-04
Loss = 6.2925e-03, PNorm = 38.8078, GNorm = 1.0779, lr_0 = 4.5539e-04
Loss = 5.5678e-03, PNorm = 38.8255, GNorm = 1.0664, lr_0 = 4.5215e-04
Loss = 6.2983e-03, PNorm = 38.8407, GNorm = 1.9977, lr_0 = 4.4893e-04
Loss = 6.1537e-03, PNorm = 38.8550, GNorm = 1.1711, lr_0 = 4.4573e-04
Loss = 6.0981e-03, PNorm = 38.8689, GNorm = 2.3696, lr_0 = 4.4255e-04
Loss = 5.9575e-03, PNorm = 38.8812, GNorm = 1.6075, lr_0 = 4.3940e-04
Validation rmse = 0.702480
Epoch 12
Loss = 5.5119e-03, PNorm = 38.8976, GNorm = 1.9444, lr_0 = 4.3627e-04
Loss = 6.2814e-03, PNorm = 38.9104, GNorm = 1.2118, lr_0 = 4.3316e-04
Loss = 5.4773e-03, PNorm = 38.9229, GNorm = 2.2944, lr_0 = 4.3007e-04
Loss = 4.9105e-03, PNorm = 38.9313, GNorm = 1.1863, lr_0 = 4.2701e-04
Loss = 5.0894e-03, PNorm = 38.9442, GNorm = 1.2699, lr_0 = 4.2396e-04
Loss = 5.9672e-03, PNorm = 38.9595, GNorm = 1.3953, lr_0 = 4.2094e-04
Loss = 5.0370e-03, PNorm = 38.9800, GNorm = 1.5112, lr_0 = 4.1794e-04
Loss = 5.6019e-03, PNorm = 38.9903, GNorm = 1.2184, lr_0 = 4.1497e-04
Loss = 5.6373e-03, PNorm = 39.0037, GNorm = 1.0942, lr_0 = 4.1201e-04
Loss = 5.6695e-03, PNorm = 39.0281, GNorm = 2.5194, lr_0 = 4.0907e-04
Loss = 7.0374e-03, PNorm = 39.0553, GNorm = 3.3602, lr_0 = 4.0616e-04
Validation rmse = 0.703356
Epoch 13
Loss = 6.7524e-03, PNorm = 39.0750, GNorm = 2.5366, lr_0 = 4.0326e-04
Loss = 5.6620e-03, PNorm = 39.0872, GNorm = 1.1675, lr_0 = 4.0039e-04
Loss = 5.7114e-03, PNorm = 39.1124, GNorm = 2.2388, lr_0 = 3.9754e-04
Loss = 5.5082e-03, PNorm = 39.1272, GNorm = 2.3006, lr_0 = 3.9471e-04
Loss = 5.5085e-03, PNorm = 39.1326, GNorm = 2.3311, lr_0 = 3.9189e-04
Loss = 6.3887e-03, PNorm = 39.1434, GNorm = 3.3418, lr_0 = 3.8910e-04
Loss = 5.3496e-03, PNorm = 39.1604, GNorm = 1.0489, lr_0 = 3.8633e-04
Loss = 6.0061e-03, PNorm = 39.1770, GNorm = 1.1033, lr_0 = 3.8358e-04
Loss = 5.6748e-03, PNorm = 39.1861, GNorm = 3.1464, lr_0 = 3.8084e-04
Loss = 4.3387e-03, PNorm = 39.1972, GNorm = 1.0637, lr_0 = 3.7813e-04
Loss = 5.5472e-03, PNorm = 39.2132, GNorm = 1.8047, lr_0 = 3.7543e-04
Loss = 5.5490e-03, PNorm = 39.2252, GNorm = 1.8051, lr_0 = 3.7276e-04
Validation rmse = 0.692288
Epoch 14
Loss = 5.0317e-03, PNorm = 39.2432, GNorm = 1.1927, lr_0 = 3.7010e-04
Loss = 6.1977e-03, PNorm = 39.2567, GNorm = 1.1518, lr_0 = 3.6747e-04
Loss = 4.8598e-03, PNorm = 39.2737, GNorm = 0.8011, lr_0 = 3.6485e-04
Loss = 5.0377e-03, PNorm = 39.2843, GNorm = 1.4863, lr_0 = 3.6225e-04
Loss = 5.7069e-03, PNorm = 39.2922, GNorm = 2.0554, lr_0 = 3.5967e-04
Loss = 5.0492e-03, PNorm = 39.3066, GNorm = 2.9277, lr_0 = 3.5710e-04
Loss = 5.1598e-03, PNorm = 39.3206, GNorm = 1.3258, lr_0 = 3.5456e-04
Loss = 4.8651e-03, PNorm = 39.3314, GNorm = 1.8175, lr_0 = 3.5203e-04
Loss = 5.7838e-03, PNorm = 39.3402, GNorm = 3.0675, lr_0 = 3.4953e-04
Loss = 5.9444e-03, PNorm = 39.3493, GNorm = 3.6780, lr_0 = 3.4703e-04
Loss = 5.9521e-03, PNorm = 39.3591, GNorm = 1.1204, lr_0 = 3.4456e-04
Validation rmse = 0.689400
Epoch 15
Loss = 4.1930e-03, PNorm = 39.3757, GNorm = 1.6039, lr_0 = 3.4211e-04
Loss = 4.9588e-03, PNorm = 39.3952, GNorm = 1.1285, lr_0 = 3.3967e-04
Loss = 5.7476e-03, PNorm = 39.4076, GNorm = 1.2522, lr_0 = 3.3725e-04
Loss = 6.3610e-03, PNorm = 39.4216, GNorm = 2.2218, lr_0 = 3.3485e-04
Loss = 5.2514e-03, PNorm = 39.4365, GNorm = 1.9036, lr_0 = 3.3246e-04
Loss = 4.5702e-03, PNorm = 39.4441, GNorm = 1.7981, lr_0 = 3.3009e-04
Loss = 4.2719e-03, PNorm = 39.4536, GNorm = 0.9583, lr_0 = 3.2774e-04
Loss = 5.7044e-03, PNorm = 39.4637, GNorm = 1.0376, lr_0 = 3.2540e-04
Loss = 4.9239e-03, PNorm = 39.4758, GNorm = 2.2821, lr_0 = 3.2308e-04
Loss = 5.3920e-03, PNorm = 39.4836, GNorm = 2.1333, lr_0 = 3.2078e-04
Loss = 5.7215e-03, PNorm = 39.4935, GNorm = 1.2575, lr_0 = 3.1850e-04
Loss = 5.2544e-03, PNorm = 39.5076, GNorm = 2.1475, lr_0 = 3.1623e-04
Validation rmse = 0.694469
Epoch 16
Loss = 5.5156e-03, PNorm = 39.5182, GNorm = 1.8777, lr_0 = 3.1397e-04
Loss = 4.9720e-03, PNorm = 39.5303, GNorm = 2.9034, lr_0 = 3.1174e-04
Loss = 4.7040e-03, PNorm = 39.5429, GNorm = 2.1750, lr_0 = 3.0952e-04
Loss = 5.1267e-03, PNorm = 39.5565, GNorm = 1.2772, lr_0 = 3.0731e-04
Loss = 5.1522e-03, PNorm = 39.5654, GNorm = 1.9588, lr_0 = 3.0512e-04
Loss = 5.1627e-03, PNorm = 39.5792, GNorm = 1.6504, lr_0 = 3.0295e-04
Loss = 5.3839e-03, PNorm = 39.5857, GNorm = 1.1272, lr_0 = 3.0079e-04
Loss = 5.0332e-03, PNorm = 39.5966, GNorm = 1.3553, lr_0 = 2.9865e-04
Loss = 4.9148e-03, PNorm = 39.6091, GNorm = 2.3979, lr_0 = 2.9652e-04
Loss = 5.4386e-03, PNorm = 39.6204, GNorm = 1.4321, lr_0 = 2.9440e-04
Loss = 4.8455e-03, PNorm = 39.6310, GNorm = 1.3341, lr_0 = 2.9231e-04
Validation rmse = 0.674072
Epoch 17
Loss = 3.4869e-03, PNorm = 39.6393, GNorm = 1.7983, lr_0 = 2.9022e-04
Loss = 5.3619e-03, PNorm = 39.6444, GNorm = 1.4455, lr_0 = 2.8816e-04
Loss = 4.9248e-03, PNorm = 39.6560, GNorm = 2.3665, lr_0 = 2.8610e-04
Loss = 4.3098e-03, PNorm = 39.6644, GNorm = 1.0184, lr_0 = 2.8406e-04
Loss = 4.9100e-03, PNorm = 39.6732, GNorm = 3.1134, lr_0 = 2.8204e-04
Loss = 4.7666e-03, PNorm = 39.6791, GNorm = 1.0008, lr_0 = 2.8003e-04
Loss = 4.7123e-03, PNorm = 39.6899, GNorm = 1.6187, lr_0 = 2.7803e-04
Loss = 5.7061e-03, PNorm = 39.6998, GNorm = 2.3125, lr_0 = 2.7605e-04
Loss = 6.0299e-03, PNorm = 39.7096, GNorm = 2.8574, lr_0 = 2.7409e-04
Loss = 5.0197e-03, PNorm = 39.7170, GNorm = 1.5010, lr_0 = 2.7213e-04
Loss = 5.1939e-03, PNorm = 39.7235, GNorm = 1.4689, lr_0 = 2.7019e-04
Loss = 4.3253e-03, PNorm = 39.7282, GNorm = 1.6392, lr_0 = 2.6827e-04
Validation rmse = 0.673974
Epoch 18
Loss = 5.3282e-03, PNorm = 39.7380, GNorm = 1.4714, lr_0 = 2.6636e-04
Loss = 4.6660e-03, PNorm = 39.7480, GNorm = 1.3313, lr_0 = 2.6446e-04
Loss = 4.5547e-03, PNorm = 39.7561, GNorm = 2.0220, lr_0 = 2.6258e-04
Loss = 3.9200e-03, PNorm = 39.7680, GNorm = 1.3394, lr_0 = 2.6070e-04
Loss = 5.0507e-03, PNorm = 39.7721, GNorm = 1.0790, lr_0 = 2.5885e-04
Loss = 4.0354e-03, PNorm = 39.7789, GNorm = 1.0886, lr_0 = 2.5700e-04
Loss = 5.2462e-03, PNorm = 39.7904, GNorm = 3.0530, lr_0 = 2.5517e-04
Loss = 4.6219e-03, PNorm = 39.7990, GNorm = 1.5483, lr_0 = 2.5335e-04
Loss = 4.7436e-03, PNorm = 39.8033, GNorm = 1.5460, lr_0 = 2.5155e-04
Loss = 4.8600e-03, PNorm = 39.8122, GNorm = 2.0842, lr_0 = 2.4976e-04
Loss = 5.0227e-03, PNorm = 39.8172, GNorm = 1.5934, lr_0 = 2.4798e-04
Validation rmse = 0.681272
Epoch 19
Loss = 5.8875e-03, PNorm = 39.8262, GNorm = 1.2907, lr_0 = 2.4621e-04
Loss = 5.1827e-03, PNorm = 39.8358, GNorm = 1.0012, lr_0 = 2.4445e-04
Loss = 4.1955e-03, PNorm = 39.8442, GNorm = 1.2981, lr_0 = 2.4271e-04
Loss = 4.4794e-03, PNorm = 39.8498, GNorm = 0.9240, lr_0 = 2.4098e-04
Loss = 4.3300e-03, PNorm = 39.8559, GNorm = 1.6117, lr_0 = 2.3927e-04
Loss = 4.5651e-03, PNorm = 39.8656, GNorm = 1.5688, lr_0 = 2.3756e-04
Loss = 4.0822e-03, PNorm = 39.8723, GNorm = 2.1937, lr_0 = 2.3587e-04
Loss = 4.3602e-03, PNorm = 39.8794, GNorm = 1.6603, lr_0 = 2.3419e-04
Loss = 4.8874e-03, PNorm = 39.8860, GNorm = 2.4303, lr_0 = 2.3252e-04
Loss = 4.4852e-03, PNorm = 39.8898, GNorm = 1.2379, lr_0 = 2.3086e-04
Loss = 4.8342e-03, PNorm = 39.8981, GNorm = 1.6197, lr_0 = 2.2922e-04
Loss = 5.6857e-03, PNorm = 39.9074, GNorm = 1.2935, lr_0 = 2.2758e-04
Validation rmse = 0.666473
Epoch 20
Loss = 4.8179e-03, PNorm = 39.9165, GNorm = 2.3049, lr_0 = 2.2596e-04
Loss = 4.6650e-03, PNorm = 39.9239, GNorm = 2.4197, lr_0 = 2.2435e-04
Loss = 4.8124e-03, PNorm = 39.9323, GNorm = 1.7131, lr_0 = 2.2275e-04
Loss = 4.7693e-03, PNorm = 39.9430, GNorm = 1.5821, lr_0 = 2.2117e-04
Loss = 5.2750e-03, PNorm = 39.9476, GNorm = 1.7819, lr_0 = 2.1959e-04
Loss = 4.8258e-03, PNorm = 39.9511, GNorm = 1.3846, lr_0 = 2.1803e-04
Loss = 4.3076e-03, PNorm = 39.9571, GNorm = 1.0757, lr_0 = 2.1647e-04
Loss = 4.3351e-03, PNorm = 39.9627, GNorm = 2.6059, lr_0 = 2.1493e-04
Loss = 4.7884e-03, PNorm = 39.9710, GNorm = 2.1720, lr_0 = 2.1340e-04
Loss = 4.3323e-03, PNorm = 39.9824, GNorm = 2.7564, lr_0 = 2.1188e-04
Loss = 4.2885e-03, PNorm = 39.9868, GNorm = 2.9966, lr_0 = 2.1037e-04
Validation rmse = 0.661525
Epoch 21
Loss = 4.4930e-03, PNorm = 39.9917, GNorm = 2.3302, lr_0 = 2.0887e-04
Loss = 3.8911e-03, PNorm = 39.9949, GNorm = 1.4604, lr_0 = 2.0738e-04
Loss = 4.3653e-03, PNorm = 40.0028, GNorm = 1.8724, lr_0 = 2.0590e-04
Loss = 4.2710e-03, PNorm = 40.0104, GNorm = 1.4780, lr_0 = 2.0444e-04
Loss = 4.2667e-03, PNorm = 40.0137, GNorm = 0.7530, lr_0 = 2.0298e-04
Loss = 4.6293e-03, PNorm = 40.0191, GNorm = 1.0423, lr_0 = 2.0153e-04
Loss = 4.5132e-03, PNorm = 40.0244, GNorm = 2.7071, lr_0 = 2.0010e-04
Loss = 4.4790e-03, PNorm = 40.0307, GNorm = 1.8431, lr_0 = 1.9867e-04
Loss = 5.0572e-03, PNorm = 40.0368, GNorm = 1.7879, lr_0 = 1.9726e-04
Loss = 4.7353e-03, PNorm = 40.0418, GNorm = 1.9217, lr_0 = 1.9585e-04
Loss = 5.1882e-03, PNorm = 40.0520, GNorm = 2.0705, lr_0 = 1.9446e-04
Loss = 4.4227e-03, PNorm = 40.0600, GNorm = 3.4570, lr_0 = 1.9307e-04
Validation rmse = 0.676555
Epoch 22
Loss = 3.7269e-03, PNorm = 40.0669, GNorm = 1.5017, lr_0 = 1.9169e-04
Loss = 4.4988e-03, PNorm = 40.0738, GNorm = 1.8331, lr_0 = 1.9033e-04
Loss = 4.4509e-03, PNorm = 40.0775, GNorm = 0.9786, lr_0 = 1.8897e-04
Loss = 3.9593e-03, PNorm = 40.0834, GNorm = 2.8502, lr_0 = 1.8763e-04
Loss = 4.0577e-03, PNorm = 40.0896, GNorm = 1.4621, lr_0 = 1.8629e-04
Loss = 4.6889e-03, PNorm = 40.0948, GNorm = 1.5579, lr_0 = 1.8496e-04
Loss = 4.4833e-03, PNorm = 40.1010, GNorm = 2.4150, lr_0 = 1.8364e-04
Loss = 4.0675e-03, PNorm = 40.1063, GNorm = 1.1653, lr_0 = 1.8233e-04
Loss = 4.9461e-03, PNorm = 40.1102, GNorm = 2.0885, lr_0 = 1.8104e-04
Loss = 4.7317e-03, PNorm = 40.1144, GNorm = 1.7879, lr_0 = 1.7975e-04
Loss = 4.7585e-03, PNorm = 40.1196, GNorm = 3.5392, lr_0 = 1.7846e-04
Validation rmse = 0.664395
Epoch 23
Loss = 4.1637e-03, PNorm = 40.1253, GNorm = 1.3488, lr_0 = 1.7719e-04
Loss = 4.7860e-03, PNorm = 40.1324, GNorm = 2.1555, lr_0 = 1.7593e-04
Loss = 4.2703e-03, PNorm = 40.1402, GNorm = 1.0872, lr_0 = 1.7468e-04
Loss = 3.8847e-03, PNorm = 40.1461, GNorm = 1.2691, lr_0 = 1.7343e-04
Loss = 4.2434e-03, PNorm = 40.1510, GNorm = 1.4936, lr_0 = 1.7220e-04
Loss = 4.4921e-03, PNorm = 40.1545, GNorm = 1.3139, lr_0 = 1.7097e-04
Loss = 4.6456e-03, PNorm = 40.1620, GNorm = 1.4372, lr_0 = 1.6975e-04
Loss = 4.2696e-03, PNorm = 40.1671, GNorm = 1.8053, lr_0 = 1.6854e-04
Loss = 3.9189e-03, PNorm = 40.1695, GNorm = 1.4728, lr_0 = 1.6734e-04
Loss = 4.2519e-03, PNorm = 40.1742, GNorm = 1.0930, lr_0 = 1.6615e-04
Loss = 4.1217e-03, PNorm = 40.1779, GNorm = 1.3470, lr_0 = 1.6496e-04
Loss = 4.2762e-03, PNorm = 40.1814, GNorm = 1.8409, lr_0 = 1.6379e-04
Validation rmse = 0.657947
Epoch 24
Loss = 4.3753e-03, PNorm = 40.1867, GNorm = 1.5335, lr_0 = 1.6262e-04
Loss = 3.6684e-03, PNorm = 40.1926, GNorm = 1.6555, lr_0 = 1.6146e-04
Loss = 4.0405e-03, PNorm = 40.1974, GNorm = 1.4607, lr_0 = 1.6031e-04
Loss = 4.0993e-03, PNorm = 40.2028, GNorm = 2.1632, lr_0 = 1.5917e-04
Loss = 4.5514e-03, PNorm = 40.2075, GNorm = 1.2234, lr_0 = 1.5804e-04
Loss = 5.1904e-03, PNorm = 40.2133, GNorm = 2.1260, lr_0 = 1.5691e-04
Loss = 3.7626e-03, PNorm = 40.2200, GNorm = 1.3446, lr_0 = 1.5579e-04
Loss = 3.8014e-03, PNorm = 40.2260, GNorm = 2.3879, lr_0 = 1.5468e-04
Loss = 4.3412e-03, PNorm = 40.2272, GNorm = 2.1718, lr_0 = 1.5358e-04
Loss = 4.8469e-03, PNorm = 40.2287, GNorm = 2.1879, lr_0 = 1.5249e-04
Loss = 4.0694e-03, PNorm = 40.2320, GNorm = 1.3419, lr_0 = 1.5140e-04
Validation rmse = 0.651853
Epoch 25
Loss = 4.3306e-03, PNorm = 40.2379, GNorm = 1.0336, lr_0 = 1.5032e-04
Loss = 4.2586e-03, PNorm = 40.2450, GNorm = 2.8319, lr_0 = 1.4925e-04
Loss = 4.6237e-03, PNorm = 40.2493, GNorm = 2.6648, lr_0 = 1.4819e-04
Loss = 4.4762e-03, PNorm = 40.2543, GNorm = 1.8833, lr_0 = 1.4713e-04
Loss = 3.7240e-03, PNorm = 40.2581, GNorm = 1.7159, lr_0 = 1.4608e-04
Loss = 3.5511e-03, PNorm = 40.2623, GNorm = 1.8953, lr_0 = 1.4504e-04
Loss = 4.2364e-03, PNorm = 40.2668, GNorm = 1.7427, lr_0 = 1.4401e-04
Loss = 4.7505e-03, PNorm = 40.2722, GNorm = 0.8151, lr_0 = 1.4298e-04
Loss = 4.3894e-03, PNorm = 40.2760, GNorm = 1.2291, lr_0 = 1.4196e-04
Loss = 3.9465e-03, PNorm = 40.2785, GNorm = 1.7899, lr_0 = 1.4095e-04
Loss = 3.9747e-03, PNorm = 40.2819, GNorm = 1.0234, lr_0 = 1.3995e-04
Loss = 3.8139e-03, PNorm = 40.2868, GNorm = 1.6279, lr_0 = 1.3895e-04
Validation rmse = 0.653639
Epoch 26
Loss = 3.7519e-03, PNorm = 40.2924, GNorm = 1.3463, lr_0 = 1.3796e-04
Loss = 4.6579e-03, PNorm = 40.2967, GNorm = 1.9033, lr_0 = 1.3698e-04
Loss = 3.6543e-03, PNorm = 40.3014, GNorm = 1.4284, lr_0 = 1.3600e-04
Loss = 4.1407e-03, PNorm = 40.3050, GNorm = 2.8382, lr_0 = 1.3503e-04
Loss = 3.9681e-03, PNorm = 40.3089, GNorm = 1.1291, lr_0 = 1.3407e-04
Loss = 3.9873e-03, PNorm = 40.3129, GNorm = 1.1893, lr_0 = 1.3311e-04
Loss = 3.7321e-03, PNorm = 40.3158, GNorm = 1.7203, lr_0 = 1.3217e-04
Loss = 3.9714e-03, PNorm = 40.3195, GNorm = 2.3803, lr_0 = 1.3122e-04
Loss = 3.9875e-03, PNorm = 40.3234, GNorm = 1.3210, lr_0 = 1.3029e-04
Loss = 4.4419e-03, PNorm = 40.3264, GNorm = 1.0789, lr_0 = 1.2936e-04
Loss = 3.9237e-03, PNorm = 40.3301, GNorm = 1.7744, lr_0 = 1.2844e-04
Validation rmse = 0.664828
Epoch 27
Loss = 4.3859e-03, PNorm = 40.3334, GNorm = 1.7660, lr_0 = 1.2752e-04
Loss = 3.6533e-03, PNorm = 40.3378, GNorm = 1.1191, lr_0 = 1.2661e-04
Loss = 4.3064e-03, PNorm = 40.3415, GNorm = 2.3103, lr_0 = 1.2571e-04
Loss = 3.6452e-03, PNorm = 40.3477, GNorm = 2.6834, lr_0 = 1.2482e-04
Loss = 3.7281e-03, PNorm = 40.3525, GNorm = 1.6460, lr_0 = 1.2393e-04
Loss = 3.5200e-03, PNorm = 40.3556, GNorm = 1.2298, lr_0 = 1.2304e-04
Loss = 4.0426e-03, PNorm = 40.3590, GNorm = 2.9084, lr_0 = 1.2217e-04
Loss = 4.4410e-03, PNorm = 40.3622, GNorm = 1.3529, lr_0 = 1.2130e-04
Loss = 4.5817e-03, PNorm = 40.3649, GNorm = 1.5860, lr_0 = 1.2043e-04
Loss = 4.1325e-03, PNorm = 40.3681, GNorm = 1.2522, lr_0 = 1.1957e-04
Loss = 4.6323e-03, PNorm = 40.3720, GNorm = 1.5845, lr_0 = 1.1872e-04
Loss = 3.4710e-03, PNorm = 40.3742, GNorm = 1.4958, lr_0 = 1.1788e-04
Validation rmse = 0.642567
Epoch 28
Loss = 4.1823e-03, PNorm = 40.3774, GNorm = 1.5075, lr_0 = 1.1704e-04
Loss = 4.2026e-03, PNorm = 40.3795, GNorm = 2.8410, lr_0 = 1.1620e-04
Loss = 3.4938e-03, PNorm = 40.3818, GNorm = 1.1358, lr_0 = 1.1538e-04
Loss = 3.8739e-03, PNorm = 40.3865, GNorm = 1.8719, lr_0 = 1.1455e-04
Loss = 3.9418e-03, PNorm = 40.3920, GNorm = 1.4305, lr_0 = 1.1374e-04
Loss = 4.2065e-03, PNorm = 40.3952, GNorm = 1.1633, lr_0 = 1.1293e-04
Loss = 4.0661e-03, PNorm = 40.3981, GNorm = 2.4778, lr_0 = 1.1212e-04
Loss = 3.7879e-03, PNorm = 40.4017, GNorm = 1.2042, lr_0 = 1.1132e-04
Loss = 3.3549e-03, PNorm = 40.4057, GNorm = 1.5549, lr_0 = 1.1053e-04
Loss = 4.5342e-03, PNorm = 40.4104, GNorm = 1.1648, lr_0 = 1.0974e-04
Loss = 3.8855e-03, PNorm = 40.4119, GNorm = 1.3055, lr_0 = 1.0896e-04
Validation rmse = 0.647053
Epoch 29
Loss = 4.2920e-03, PNorm = 40.4143, GNorm = 1.7937, lr_0 = 1.0818e-04
Loss = 3.4587e-03, PNorm = 40.4180, GNorm = 1.7246, lr_0 = 1.0741e-04
Loss = 4.0364e-03, PNorm = 40.4215, GNorm = 2.7791, lr_0 = 1.0665e-04
Loss = 3.8047e-03, PNorm = 40.4251, GNorm = 1.3066, lr_0 = 1.0589e-04
Loss = 3.7536e-03, PNorm = 40.4289, GNorm = 2.1200, lr_0 = 1.0513e-04
Loss = 3.7112e-03, PNorm = 40.4325, GNorm = 1.1719, lr_0 = 1.0438e-04
Loss = 3.4724e-03, PNorm = 40.4337, GNorm = 1.5817, lr_0 = 1.0364e-04
Loss = 3.8793e-03, PNorm = 40.4356, GNorm = 1.6563, lr_0 = 1.0290e-04
Loss = 3.6770e-03, PNorm = 40.4389, GNorm = 2.2105, lr_0 = 1.0217e-04
Loss = 4.6081e-03, PNorm = 40.4412, GNorm = 1.4732, lr_0 = 1.0144e-04
Loss = 4.4542e-03, PNorm = 40.4447, GNorm = 1.3805, lr_0 = 1.0072e-04
Loss = 4.1392e-03, PNorm = 40.4490, GNorm = 2.7166, lr_0 = 1.0000e-04
Validation rmse = 0.650320
Model 0 best validation rmse = 0.642567 on epoch 27
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.648347
Ensemble test rmse = 0.648347
1-fold cross validation
Seed 42 ==> test rmse = 0.648347
Overall test rmse = 0.648347 +/- 0.000000
Fold 0
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'cuda': True,
 'data_path': 'dopamine_new.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cache': False,
 'num_folds': 5,
 'num_lrs': 1,
 'quiet': False,
 'save_dir': 'runs\\fold_0',
 'save_smiles_splits': False,
 'seed': 42,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'test': False,
 'test_fold_index': None,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': None,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 42
Total size = 7,199 | train size = 5,759 | val size = 720 | test size = 720
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Moving model to cuda
Epoch 0
Loss = 2.0669e-02, PNorm = 33.9879, GNorm = 2.8184, lr_0 = 1.3913e-04
Loss = 1.7778e-02, PNorm = 33.9900, GNorm = 5.0653, lr_0 = 1.7826e-04
Loss = 2.0086e-02, PNorm = 33.9926, GNorm = 3.7361, lr_0 = 2.1739e-04
Loss = 1.8453e-02, PNorm = 33.9972, GNorm = 0.7740, lr_0 = 2.5652e-04
Loss = 1.6247e-02, PNorm = 34.0040, GNorm = 6.1828, lr_0 = 2.9565e-04
Loss = 1.6417e-02, PNorm = 34.0155, GNorm = 3.5831, lr_0 = 3.3478e-04
Loss = 2.0277e-02, PNorm = 34.0304, GNorm = 2.6352, lr_0 = 3.7391e-04
Loss = 1.7572e-02, PNorm = 34.0458, GNorm = 5.0634, lr_0 = 4.1304e-04
Loss = 1.4988e-02, PNorm = 34.0673, GNorm = 0.8613, lr_0 = 4.5217e-04
Loss = 1.6529e-02, PNorm = 34.0908, GNorm = 3.2168, lr_0 = 4.9130e-04
Loss = 1.5930e-02, PNorm = 34.1129, GNorm = 5.8915, lr_0 = 5.3043e-04
Validation rmse = 1.056373
Epoch 1
Loss = 1.7559e-02, PNorm = 34.1411, GNorm = 5.5236, lr_0 = 5.6957e-04
Loss = 1.4022e-02, PNorm = 34.1737, GNorm = 3.8377, lr_0 = 6.0870e-04
Loss = 1.5141e-02, PNorm = 34.2111, GNorm = 5.9927, lr_0 = 6.4783e-04
Loss = 1.4936e-02, PNorm = 34.2558, GNorm = 9.0364, lr_0 = 6.8696e-04
Loss = 1.5451e-02, PNorm = 34.3117, GNorm = 11.4046, lr_0 = 7.2609e-04
Loss = 1.5618e-02, PNorm = 34.3547, GNorm = 4.9047, lr_0 = 7.6522e-04
Loss = 1.3939e-02, PNorm = 34.4145, GNorm = 2.2153, lr_0 = 8.0435e-04
Loss = 1.5273e-02, PNorm = 34.4702, GNorm = 2.3999, lr_0 = 8.4348e-04
Loss = 1.3746e-02, PNorm = 34.5389, GNorm = 1.0286, lr_0 = 8.8261e-04
Loss = 1.2810e-02, PNorm = 34.6250, GNorm = 5.8572, lr_0 = 9.2174e-04
Loss = 9.8521e-03, PNorm = 34.7020, GNorm = 1.5667, lr_0 = 9.6087e-04
Loss = 1.2602e-02, PNorm = 34.7691, GNorm = 1.3292, lr_0 = 1.0000e-03
Validation rmse = 1.091455
Epoch 2
Loss = 1.1984e-02, PNorm = 34.8506, GNorm = 1.0892, lr_0 = 9.9287e-04
Loss = 1.2366e-02, PNorm = 34.9309, GNorm = 5.8146, lr_0 = 9.8580e-04
Loss = 1.1786e-02, PNorm = 35.0228, GNorm = 1.5470, lr_0 = 9.7878e-04
Loss = 1.1237e-02, PNorm = 35.1054, GNorm = 1.7000, lr_0 = 9.7180e-04
Loss = 1.1030e-02, PNorm = 35.1735, GNorm = 4.3993, lr_0 = 9.6488e-04
Loss = 1.1708e-02, PNorm = 35.2447, GNorm = 3.8756, lr_0 = 9.5800e-04
Loss = 1.2822e-02, PNorm = 35.3258, GNorm = 6.9840, lr_0 = 9.5118e-04
Loss = 1.2651e-02, PNorm = 35.3926, GNorm = 4.2264, lr_0 = 9.4440e-04
Loss = 1.2360e-02, PNorm = 35.4478, GNorm = 5.0594, lr_0 = 9.3767e-04
Loss = 1.1119e-02, PNorm = 35.5098, GNorm = 3.1510, lr_0 = 9.3099e-04
Loss = 1.0581e-02, PNorm = 35.5553, GNorm = 2.9901, lr_0 = 9.2435e-04
Validation rmse = 0.908512
Epoch 3
Loss = 1.1263e-02, PNorm = 35.5967, GNorm = 1.5833, lr_0 = 9.1777e-04
Loss = 1.1045e-02, PNorm = 35.6720, GNorm = 1.8257, lr_0 = 9.1123e-04
Loss = 1.0585e-02, PNorm = 35.7388, GNorm = 4.9305, lr_0 = 9.0474e-04
Loss = 9.6942e-03, PNorm = 35.7997, GNorm = 1.2746, lr_0 = 8.9829e-04
Loss = 1.3948e-02, PNorm = 35.8500, GNorm = 2.4761, lr_0 = 8.9189e-04
Loss = 9.8225e-03, PNorm = 35.9148, GNorm = 2.4672, lr_0 = 8.8553e-04
Loss = 1.0022e-02, PNorm = 35.9487, GNorm = 2.9447, lr_0 = 8.7922e-04
Loss = 1.0872e-02, PNorm = 35.9883, GNorm = 2.7666, lr_0 = 8.7296e-04
Loss = 1.1246e-02, PNorm = 36.0428, GNorm = 5.7931, lr_0 = 8.6674e-04
Loss = 9.6241e-03, PNorm = 36.1033, GNorm = 1.4304, lr_0 = 8.6056e-04
Loss = 9.8912e-03, PNorm = 36.1597, GNorm = 2.1806, lr_0 = 8.5443e-04
Loss = 9.0991e-03, PNorm = 36.1918, GNorm = 1.2154, lr_0 = 8.4834e-04
Validation rmse = 0.834496
Epoch 4
Loss = 8.5849e-03, PNorm = 36.2275, GNorm = 2.1232, lr_0 = 8.4230e-04
Loss = 9.1183e-03, PNorm = 36.2653, GNorm = 1.9007, lr_0 = 8.3630e-04
Loss = 8.6436e-03, PNorm = 36.3015, GNorm = 5.0920, lr_0 = 8.3034e-04
Loss = 9.3584e-03, PNorm = 36.3329, GNorm = 1.1688, lr_0 = 8.2442e-04
Loss = 9.2969e-03, PNorm = 36.3743, GNorm = 1.0424, lr_0 = 8.1855e-04
Loss = 1.0277e-02, PNorm = 36.4168, GNorm = 1.2704, lr_0 = 8.1271e-04
Loss = 8.5784e-03, PNorm = 36.4584, GNorm = 2.8488, lr_0 = 8.0692e-04
Loss = 9.0256e-03, PNorm = 36.5056, GNorm = 3.6243, lr_0 = 8.0117e-04
Loss = 8.6477e-03, PNorm = 36.5594, GNorm = 1.7619, lr_0 = 7.9547e-04
Loss = 8.9632e-03, PNorm = 36.6004, GNorm = 1.2951, lr_0 = 7.8980e-04
Loss = 8.2685e-03, PNorm = 36.6415, GNorm = 1.8188, lr_0 = 7.8417e-04
Validation rmse = 0.839682
Epoch 5
Loss = 8.2321e-03, PNorm = 36.6932, GNorm = 4.3983, lr_0 = 7.7858e-04
Loss = 7.8043e-03, PNorm = 36.7418, GNorm = 1.7598, lr_0 = 7.7303e-04
Loss = 8.5276e-03, PNorm = 36.7828, GNorm = 1.2828, lr_0 = 7.6753e-04
Loss = 9.9907e-03, PNorm = 36.8276, GNorm = 4.3216, lr_0 = 7.6206e-04
Loss = 8.9729e-03, PNorm = 36.8714, GNorm = 2.4916, lr_0 = 7.5663e-04
Loss = 9.6030e-03, PNorm = 36.9322, GNorm = 1.5083, lr_0 = 7.5124e-04
Loss = 8.7472e-03, PNorm = 36.9683, GNorm = 2.5348, lr_0 = 7.4588e-04
Loss = 8.1794e-03, PNorm = 37.0132, GNorm = 1.6747, lr_0 = 7.4057e-04
Loss = 7.7657e-03, PNorm = 37.0499, GNorm = 1.9668, lr_0 = 7.3529e-04
Loss = 7.8229e-03, PNorm = 37.0634, GNorm = 1.0309, lr_0 = 7.3005e-04
Loss = 8.9219e-03, PNorm = 37.1004, GNorm = 1.0673, lr_0 = 7.2485e-04
Loss = 8.4784e-03, PNorm = 37.1394, GNorm = 1.7282, lr_0 = 7.1969e-04
Validation rmse = 0.785438
Epoch 6
Loss = 6.8987e-03, PNorm = 37.1763, GNorm = 1.5803, lr_0 = 7.1456e-04
Loss = 9.3699e-03, PNorm = 37.2210, GNorm = 4.1293, lr_0 = 7.0947e-04
Loss = 7.6154e-03, PNorm = 37.2690, GNorm = 5.4090, lr_0 = 7.0441e-04
Loss = 7.8553e-03, PNorm = 37.3170, GNorm = 2.0281, lr_0 = 6.9939e-04
Loss = 7.3156e-03, PNorm = 37.3564, GNorm = 2.2736, lr_0 = 6.9441e-04
Loss = 7.6145e-03, PNorm = 37.3751, GNorm = 2.6577, lr_0 = 6.8946e-04
Loss = 8.4551e-03, PNorm = 37.4041, GNorm = 1.3805, lr_0 = 6.8455e-04
Loss = 8.1202e-03, PNorm = 37.4282, GNorm = 3.9743, lr_0 = 6.7967e-04
Loss = 8.6766e-03, PNorm = 37.4573, GNorm = 3.2865, lr_0 = 6.7483e-04
Loss = 8.5265e-03, PNorm = 37.4836, GNorm = 3.3019, lr_0 = 6.7002e-04
Loss = 8.1930e-03, PNorm = 37.5175, GNorm = 1.0064, lr_0 = 6.6524e-04
Validation rmse = 0.759998
Epoch 7
Loss = 7.7946e-03, PNorm = 37.5664, GNorm = 2.2118, lr_0 = 6.6050e-04
Loss = 8.2885e-03, PNorm = 37.6204, GNorm = 2.9311, lr_0 = 6.5580e-04
Loss = 6.4973e-03, PNorm = 37.6516, GNorm = 1.7629, lr_0 = 6.5113e-04
Loss = 6.6690e-03, PNorm = 37.6760, GNorm = 1.4672, lr_0 = 6.4649e-04
Loss = 7.5551e-03, PNorm = 37.7081, GNorm = 1.0425, lr_0 = 6.4188e-04
Loss = 8.3163e-03, PNorm = 37.7471, GNorm = 1.3949, lr_0 = 6.3731e-04
Loss = 7.5913e-03, PNorm = 37.7846, GNorm = 1.3628, lr_0 = 6.3276e-04
Loss = 7.7035e-03, PNorm = 37.8195, GNorm = 5.4513, lr_0 = 6.2826e-04
Loss = 8.9573e-03, PNorm = 37.8520, GNorm = 4.4590, lr_0 = 6.2378e-04
Loss = 8.5882e-03, PNorm = 37.8877, GNorm = 1.9014, lr_0 = 6.1933e-04
Loss = 7.0542e-03, PNorm = 37.9127, GNorm = 1.2577, lr_0 = 6.1492e-04
Loss = 6.8885e-03, PNorm = 37.9444, GNorm = 2.7850, lr_0 = 6.1054e-04
Validation rmse = 0.797706
Epoch 8
Loss = 7.2298e-03, PNorm = 37.9788, GNorm = 1.0132, lr_0 = 6.0619e-04
Loss = 7.2348e-03, PNorm = 38.0145, GNorm = 2.2381, lr_0 = 6.0187e-04
Loss = 6.9082e-03, PNorm = 38.0470, GNorm = 1.3927, lr_0 = 5.9758e-04
Loss = 6.8079e-03, PNorm = 38.0756, GNorm = 1.2272, lr_0 = 5.9332e-04
Loss = 6.5877e-03, PNorm = 38.0997, GNorm = 1.2685, lr_0 = 5.8910e-04
Loss = 6.8686e-03, PNorm = 38.1258, GNorm = 2.1144, lr_0 = 5.8490e-04
Loss = 7.8200e-03, PNorm = 38.1530, GNorm = 3.0822, lr_0 = 5.8073e-04
Loss = 7.0696e-03, PNorm = 38.1804, GNorm = 1.1900, lr_0 = 5.7659e-04
Loss = 7.2403e-03, PNorm = 38.2124, GNorm = 1.5168, lr_0 = 5.7248e-04
Loss = 7.7978e-03, PNorm = 38.2354, GNorm = 1.5061, lr_0 = 5.6841e-04
Loss = 6.2309e-03, PNorm = 38.2555, GNorm = 1.4876, lr_0 = 5.6436e-04
Validation rmse = 0.760056
Epoch 9
Loss = 7.9572e-03, PNorm = 38.2848, GNorm = 2.7856, lr_0 = 5.6033e-04
Loss = 6.2813e-03, PNorm = 38.3104, GNorm = 1.4685, lr_0 = 5.5634e-04
Loss = 6.7998e-03, PNorm = 38.3405, GNorm = 1.5617, lr_0 = 5.5238e-04
Loss = 5.9852e-03, PNorm = 38.3633, GNorm = 1.4091, lr_0 = 5.4844e-04
Loss = 6.8308e-03, PNorm = 38.3932, GNorm = 2.0909, lr_0 = 5.4453e-04
Loss = 7.2420e-03, PNorm = 38.4260, GNorm = 2.4435, lr_0 = 5.4065e-04
Loss = 6.2528e-03, PNorm = 38.4542, GNorm = 3.1143, lr_0 = 5.3680e-04
Loss = 7.0243e-03, PNorm = 38.4694, GNorm = 1.7895, lr_0 = 5.3298e-04
Loss = 6.2612e-03, PNorm = 38.4897, GNorm = 1.5017, lr_0 = 5.2918e-04
Loss = 6.8043e-03, PNorm = 38.5086, GNorm = 1.2814, lr_0 = 5.2541e-04
Loss = 6.7169e-03, PNorm = 38.5288, GNorm = 2.5304, lr_0 = 5.2166e-04
Loss = 6.3169e-03, PNorm = 38.5490, GNorm = 1.2486, lr_0 = 5.1795e-04
Validation rmse = 0.725798
Epoch 10
Loss = 6.7303e-03, PNorm = 38.5750, GNorm = 1.2925, lr_0 = 5.1426e-04
Loss = 7.0623e-03, PNorm = 38.6041, GNorm = 2.3579, lr_0 = 5.1059e-04
Loss = 6.0668e-03, PNorm = 38.6289, GNorm = 1.2027, lr_0 = 5.0695e-04
Loss = 6.6729e-03, PNorm = 38.6567, GNorm = 1.5438, lr_0 = 5.0334e-04
Loss = 5.9662e-03, PNorm = 38.6804, GNorm = 1.1524, lr_0 = 4.9976e-04
Loss = 6.5323e-03, PNorm = 38.6984, GNorm = 2.2428, lr_0 = 4.9619e-04
Loss = 7.3204e-03, PNorm = 38.7088, GNorm = 1.5790, lr_0 = 4.9266e-04
Loss = 6.3171e-03, PNorm = 38.7361, GNorm = 2.5674, lr_0 = 4.8915e-04
Loss = 6.3466e-03, PNorm = 38.7605, GNorm = 3.3048, lr_0 = 4.8566e-04
Loss = 5.9771e-03, PNorm = 38.7818, GNorm = 1.2816, lr_0 = 4.8220e-04
Loss = 4.8908e-03, PNorm = 38.7991, GNorm = 1.1025, lr_0 = 4.7877e-04
Validation rmse = 0.714165
Epoch 11
Loss = 5.6179e-03, PNorm = 38.8168, GNorm = 1.4473, lr_0 = 4.7536e-04
Loss = 6.1263e-03, PNorm = 38.8367, GNorm = 3.4299, lr_0 = 4.7197e-04
Loss = 6.1708e-03, PNorm = 38.8530, GNorm = 2.1202, lr_0 = 4.6861e-04
Loss = 6.7788e-03, PNorm = 38.8725, GNorm = 3.0653, lr_0 = 4.6527e-04
Loss = 6.0797e-03, PNorm = 38.9047, GNorm = 2.3306, lr_0 = 4.6195e-04
Loss = 5.3390e-03, PNorm = 38.9268, GNorm = 1.3611, lr_0 = 4.5866e-04
Loss = 6.3759e-03, PNorm = 38.9484, GNorm = 1.6202, lr_0 = 4.5539e-04
Loss = 5.5103e-03, PNorm = 38.9655, GNorm = 1.5198, lr_0 = 4.5215e-04
Loss = 6.3868e-03, PNorm = 38.9795, GNorm = 3.5328, lr_0 = 4.4893e-04
Loss = 6.5184e-03, PNorm = 38.9904, GNorm = 1.2060, lr_0 = 4.4573e-04
Loss = 6.2511e-03, PNorm = 39.0070, GNorm = 2.3601, lr_0 = 4.4255e-04
Loss = 6.1183e-03, PNorm = 39.0261, GNorm = 1.6743, lr_0 = 4.3940e-04
Validation rmse = 0.703241
Epoch 12
Loss = 5.5726e-03, PNorm = 39.0443, GNorm = 2.6106, lr_0 = 4.3627e-04
Loss = 6.6802e-03, PNorm = 39.0567, GNorm = 1.5169, lr_0 = 4.3316e-04
Loss = 5.4875e-03, PNorm = 39.0727, GNorm = 2.8105, lr_0 = 4.3007e-04
Loss = 5.1675e-03, PNorm = 39.0837, GNorm = 1.3054, lr_0 = 4.2701e-04
Loss = 5.3301e-03, PNorm = 39.1007, GNorm = 1.6294, lr_0 = 4.2396e-04
Loss = 6.0216e-03, PNorm = 39.1188, GNorm = 1.5405, lr_0 = 4.2094e-04
Loss = 4.9247e-03, PNorm = 39.1383, GNorm = 1.5846, lr_0 = 4.1794e-04
Loss = 5.7366e-03, PNorm = 39.1491, GNorm = 1.7609, lr_0 = 4.1497e-04
Loss = 5.8525e-03, PNorm = 39.1629, GNorm = 1.8065, lr_0 = 4.1201e-04
Loss = 6.0665e-03, PNorm = 39.1890, GNorm = 2.5391, lr_0 = 4.0907e-04
Loss = 6.8627e-03, PNorm = 39.2142, GNorm = 2.8756, lr_0 = 4.0616e-04
Validation rmse = 0.708149
Epoch 13
Loss = 6.6478e-03, PNorm = 39.2276, GNorm = 1.6420, lr_0 = 4.0326e-04
Loss = 5.6439e-03, PNorm = 39.2426, GNorm = 1.0720, lr_0 = 4.0039e-04
Loss = 5.8496e-03, PNorm = 39.2730, GNorm = 3.1904, lr_0 = 3.9754e-04
Loss = 5.4956e-03, PNorm = 39.2943, GNorm = 2.3138, lr_0 = 3.9471e-04
Loss = 5.6838e-03, PNorm = 39.3017, GNorm = 2.0909, lr_0 = 3.9189e-04
Loss = 6.6812e-03, PNorm = 39.3098, GNorm = 3.9901, lr_0 = 3.8910e-04
Loss = 5.2606e-03, PNorm = 39.3273, GNorm = 1.0712, lr_0 = 3.8633e-04
Loss = 6.1133e-03, PNorm = 39.3428, GNorm = 1.8456, lr_0 = 3.8358e-04
Loss = 5.9574e-03, PNorm = 39.3509, GNorm = 4.0522, lr_0 = 3.8084e-04
Loss = 4.3454e-03, PNorm = 39.3658, GNorm = 1.1208, lr_0 = 3.7813e-04
Loss = 5.6027e-03, PNorm = 39.3851, GNorm = 1.3764, lr_0 = 3.7543e-04
Loss = 5.7650e-03, PNorm = 39.4003, GNorm = 1.5383, lr_0 = 3.7276e-04
Validation rmse = 0.701230
Epoch 14
Loss = 4.8669e-03, PNorm = 39.4166, GNorm = 1.1809, lr_0 = 3.7010e-04
Loss = 6.2515e-03, PNorm = 39.4301, GNorm = 1.1510, lr_0 = 3.6747e-04
Loss = 5.2059e-03, PNorm = 39.4460, GNorm = 1.1089, lr_0 = 3.6485e-04
Loss = 5.4246e-03, PNorm = 39.4547, GNorm = 1.8158, lr_0 = 3.6225e-04
Loss = 5.8827e-03, PNorm = 39.4642, GNorm = 2.2302, lr_0 = 3.5967e-04
Loss = 4.8766e-03, PNorm = 39.4809, GNorm = 2.6030, lr_0 = 3.5710e-04
Loss = 5.2573e-03, PNorm = 39.4987, GNorm = 1.8984, lr_0 = 3.5456e-04
Loss = 5.0207e-03, PNorm = 39.5104, GNorm = 1.6109, lr_0 = 3.5203e-04
Loss = 6.0412e-03, PNorm = 39.5209, GNorm = 3.8688, lr_0 = 3.4953e-04
Loss = 6.2363e-03, PNorm = 39.5331, GNorm = 4.5036, lr_0 = 3.4703e-04
Loss = 6.1388e-03, PNorm = 39.5458, GNorm = 1.5234, lr_0 = 3.4456e-04
Validation rmse = 0.698366
Epoch 15
Loss = 4.2742e-03, PNorm = 39.5684, GNorm = 1.6105, lr_0 = 3.4211e-04
Loss = 5.1665e-03, PNorm = 39.5897, GNorm = 1.0963, lr_0 = 3.3967e-04
Loss = 5.9008e-03, PNorm = 39.6056, GNorm = 1.3086, lr_0 = 3.3725e-04
Loss = 6.7810e-03, PNorm = 39.6208, GNorm = 3.7175, lr_0 = 3.3485e-04
Loss = 5.3851e-03, PNorm = 39.6362, GNorm = 2.9505, lr_0 = 3.3246e-04
Loss = 4.8391e-03, PNorm = 39.6458, GNorm = 1.9795, lr_0 = 3.3009e-04
Loss = 4.4639e-03, PNorm = 39.6548, GNorm = 1.2120, lr_0 = 3.2774e-04
Loss = 5.7809e-03, PNorm = 39.6671, GNorm = 0.9519, lr_0 = 3.2540e-04
Loss = 5.2695e-03, PNorm = 39.6849, GNorm = 2.9585, lr_0 = 3.2308e-04
Loss = 5.4509e-03, PNorm = 39.6934, GNorm = 2.0091, lr_0 = 3.2078e-04
Loss = 5.7732e-03, PNorm = 39.6988, GNorm = 1.5625, lr_0 = 3.1850e-04
Loss = 5.4235e-03, PNorm = 39.7115, GNorm = 1.7361, lr_0 = 3.1623e-04
Validation rmse = 0.696730
Epoch 16
Loss = 5.4838e-03, PNorm = 39.7259, GNorm = 1.9105, lr_0 = 3.1397e-04
Loss = 5.0546e-03, PNorm = 39.7419, GNorm = 2.5366, lr_0 = 3.1174e-04
Loss = 4.6671e-03, PNorm = 39.7562, GNorm = 2.4463, lr_0 = 3.0952e-04
Loss = 5.0743e-03, PNorm = 39.7699, GNorm = 1.3384, lr_0 = 3.0731e-04
Loss = 5.4594e-03, PNorm = 39.7772, GNorm = 2.4345, lr_0 = 3.0512e-04
Loss = 5.0081e-03, PNorm = 39.7871, GNorm = 1.6792, lr_0 = 3.0295e-04
Loss = 5.5850e-03, PNorm = 39.7947, GNorm = 1.1082, lr_0 = 3.0079e-04
Loss = 5.3027e-03, PNorm = 39.8084, GNorm = 1.4756, lr_0 = 2.9865e-04
Loss = 5.0666e-03, PNorm = 39.8220, GNorm = 2.7105, lr_0 = 2.9652e-04
Loss = 5.6136e-03, PNorm = 39.8329, GNorm = 1.5030, lr_0 = 2.9440e-04
Loss = 4.8469e-03, PNorm = 39.8444, GNorm = 1.3979, lr_0 = 2.9231e-04
Validation rmse = 0.681834
Epoch 17
Loss = 3.6114e-03, PNorm = 39.8522, GNorm = 1.7880, lr_0 = 2.9022e-04
Loss = 5.4776e-03, PNorm = 39.8584, GNorm = 1.4295, lr_0 = 2.8816e-04
Loss = 4.9174e-03, PNorm = 39.8727, GNorm = 2.1477, lr_0 = 2.8610e-04
Loss = 4.4180e-03, PNorm = 39.8825, GNorm = 1.0622, lr_0 = 2.8406e-04
Loss = 4.9881e-03, PNorm = 39.8923, GNorm = 3.1506, lr_0 = 2.8204e-04
Loss = 5.0783e-03, PNorm = 39.9035, GNorm = 1.1015, lr_0 = 2.8003e-04
Loss = 4.7790e-03, PNorm = 39.9190, GNorm = 1.5656, lr_0 = 2.7803e-04
Loss = 5.7243e-03, PNorm = 39.9300, GNorm = 1.9313, lr_0 = 2.7605e-04
Loss = 5.9528e-03, PNorm = 39.9399, GNorm = 3.0703, lr_0 = 2.7409e-04
Loss = 5.0826e-03, PNorm = 39.9471, GNorm = 1.3136, lr_0 = 2.7213e-04
Loss = 5.1437e-03, PNorm = 39.9523, GNorm = 1.4919, lr_0 = 2.7019e-04
Loss = 4.3939e-03, PNorm = 39.9577, GNorm = 1.5088, lr_0 = 2.6827e-04
Validation rmse = 0.678996
Epoch 18
Loss = 5.3540e-03, PNorm = 39.9694, GNorm = 1.5335, lr_0 = 2.6636e-04
Loss = 4.6880e-03, PNorm = 39.9808, GNorm = 1.8371, lr_0 = 2.6446e-04
Loss = 4.6484e-03, PNorm = 39.9891, GNorm = 2.3739, lr_0 = 2.6258e-04
Loss = 3.8945e-03, PNorm = 40.0013, GNorm = 1.5344, lr_0 = 2.6070e-04
Loss = 5.1623e-03, PNorm = 40.0091, GNorm = 1.0151, lr_0 = 2.5885e-04
Loss = 4.3648e-03, PNorm = 40.0152, GNorm = 1.3508, lr_0 = 2.5700e-04
Loss = 5.2788e-03, PNorm = 40.0260, GNorm = 3.1768, lr_0 = 2.5517e-04
Loss = 4.6758e-03, PNorm = 40.0342, GNorm = 1.3856, lr_0 = 2.5335e-04
Loss = 4.9304e-03, PNorm = 40.0411, GNorm = 1.4125, lr_0 = 2.5155e-04
Loss = 5.2038e-03, PNorm = 40.0508, GNorm = 2.5551, lr_0 = 2.4976e-04
Loss = 5.1040e-03, PNorm = 40.0565, GNorm = 1.9438, lr_0 = 2.4798e-04
Validation rmse = 0.687517
Epoch 19
Loss = 5.5159e-03, PNorm = 40.0667, GNorm = 1.4022, lr_0 = 2.4621e-04
Loss = 5.4077e-03, PNorm = 40.0779, GNorm = 1.2727, lr_0 = 2.4445e-04
Loss = 4.2809e-03, PNorm = 40.0873, GNorm = 1.4139, lr_0 = 2.4271e-04
Loss = 4.3727e-03, PNorm = 40.0949, GNorm = 1.0267, lr_0 = 2.4098e-04
Loss = 4.2236e-03, PNorm = 40.1033, GNorm = 1.3690, lr_0 = 2.3927e-04
Loss = 4.6741e-03, PNorm = 40.1154, GNorm = 1.6355, lr_0 = 2.3756e-04
Loss = 4.3977e-03, PNorm = 40.1196, GNorm = 2.7835, lr_0 = 2.3587e-04
Loss = 4.3141e-03, PNorm = 40.1259, GNorm = 1.8723, lr_0 = 2.3419e-04
Loss = 4.9769e-03, PNorm = 40.1324, GNorm = 2.3133, lr_0 = 2.3252e-04
Loss = 4.7926e-03, PNorm = 40.1381, GNorm = 1.3599, lr_0 = 2.3086e-04
Loss = 5.0673e-03, PNorm = 40.1471, GNorm = 1.4815, lr_0 = 2.2922e-04
Loss = 5.5483e-03, PNorm = 40.1573, GNorm = 1.5795, lr_0 = 2.2758e-04
Validation rmse = 0.669902
Epoch 20
Loss = 4.8531e-03, PNorm = 40.1657, GNorm = 2.9315, lr_0 = 2.2596e-04
Loss = 4.8202e-03, PNorm = 40.1724, GNorm = 2.5385, lr_0 = 2.2435e-04
Loss = 4.9634e-03, PNorm = 40.1824, GNorm = 1.6642, lr_0 = 2.2275e-04
Loss = 4.9866e-03, PNorm = 40.1943, GNorm = 2.2212, lr_0 = 2.2117e-04
Loss = 5.1645e-03, PNorm = 40.2020, GNorm = 1.7733, lr_0 = 2.1959e-04
Loss = 5.0300e-03, PNorm = 40.2073, GNorm = 1.5336, lr_0 = 2.1803e-04
Loss = 4.4698e-03, PNorm = 40.2127, GNorm = 1.4144, lr_0 = 2.1647e-04
Loss = 4.3671e-03, PNorm = 40.2210, GNorm = 2.5853, lr_0 = 2.1493e-04
Loss = 4.7117e-03, PNorm = 40.2329, GNorm = 2.6230, lr_0 = 2.1340e-04
Loss = 4.4749e-03, PNorm = 40.2460, GNorm = 3.1520, lr_0 = 2.1188e-04
Loss = 4.3233e-03, PNorm = 40.2509, GNorm = 3.2145, lr_0 = 2.1037e-04
Validation rmse = 0.671882
Epoch 21
Loss = 4.3735e-03, PNorm = 40.2556, GNorm = 1.9525, lr_0 = 2.0887e-04
Loss = 3.8999e-03, PNorm = 40.2589, GNorm = 1.6277, lr_0 = 2.0738e-04
Loss = 4.4949e-03, PNorm = 40.2677, GNorm = 1.6003, lr_0 = 2.0590e-04
Loss = 4.3377e-03, PNorm = 40.2757, GNorm = 2.1208, lr_0 = 2.0444e-04
Loss = 4.2079e-03, PNorm = 40.2809, GNorm = 0.9246, lr_0 = 2.0298e-04
Loss = 4.7507e-03, PNorm = 40.2871, GNorm = 1.5123, lr_0 = 2.0153e-04
Loss = 4.5141e-03, PNorm = 40.2935, GNorm = 2.1959, lr_0 = 2.0010e-04
Loss = 4.4512e-03, PNorm = 40.3011, GNorm = 1.9726, lr_0 = 1.9867e-04
Loss = 4.9852e-03, PNorm = 40.3074, GNorm = 1.8099, lr_0 = 1.9726e-04
Loss = 4.8128e-03, PNorm = 40.3107, GNorm = 1.8518, lr_0 = 1.9585e-04
Loss = 5.3249e-03, PNorm = 40.3198, GNorm = 2.3040, lr_0 = 1.9446e-04
Loss = 4.5195e-03, PNorm = 40.3293, GNorm = 3.6531, lr_0 = 1.9307e-04
Validation rmse = 0.680037
Epoch 22
Loss = 3.8413e-03, PNorm = 40.3374, GNorm = 1.9268, lr_0 = 1.9169e-04
Loss = 4.5730e-03, PNorm = 40.3440, GNorm = 1.8232, lr_0 = 1.9033e-04
Loss = 4.3202e-03, PNorm = 40.3478, GNorm = 1.0310, lr_0 = 1.8897e-04
Loss = 4.0812e-03, PNorm = 40.3531, GNorm = 2.6345, lr_0 = 1.8763e-04
Loss = 3.9626e-03, PNorm = 40.3609, GNorm = 1.6406, lr_0 = 1.8629e-04
Loss = 4.6639e-03, PNorm = 40.3685, GNorm = 2.5598, lr_0 = 1.8496e-04
Loss = 4.8612e-03, PNorm = 40.3752, GNorm = 3.6254, lr_0 = 1.8364e-04
Loss = 4.1938e-03, PNorm = 40.3795, GNorm = 0.8315, lr_0 = 1.8233e-04
Loss = 4.9622e-03, PNorm = 40.3846, GNorm = 1.5788, lr_0 = 1.8104e-04
Loss = 4.8273e-03, PNorm = 40.3906, GNorm = 1.7562, lr_0 = 1.7975e-04
Loss = 4.7984e-03, PNorm = 40.3966, GNorm = 4.0906, lr_0 = 1.7846e-04
Validation rmse = 0.668544
Epoch 23
Loss = 4.3308e-03, PNorm = 40.4022, GNorm = 1.5264, lr_0 = 1.7719e-04
Loss = 5.0401e-03, PNorm = 40.4083, GNorm = 2.5619, lr_0 = 1.7593e-04
Loss = 4.4450e-03, PNorm = 40.4170, GNorm = 1.0982, lr_0 = 1.7468e-04
Loss = 4.1696e-03, PNorm = 40.4235, GNorm = 1.4610, lr_0 = 1.7343e-04
Loss = 4.3526e-03, PNorm = 40.4273, GNorm = 1.5791, lr_0 = 1.7220e-04
Loss = 4.5454e-03, PNorm = 40.4323, GNorm = 1.2565, lr_0 = 1.7097e-04
Loss = 4.7005e-03, PNorm = 40.4420, GNorm = 1.7495, lr_0 = 1.6975e-04
Loss = 4.3960e-03, PNorm = 40.4465, GNorm = 1.6001, lr_0 = 1.6854e-04
Loss = 3.9259e-03, PNorm = 40.4476, GNorm = 1.9492, lr_0 = 1.6734e-04
Loss = 4.1846e-03, PNorm = 40.4531, GNorm = 1.3237, lr_0 = 1.6615e-04
Loss = 3.9653e-03, PNorm = 40.4586, GNorm = 1.3044, lr_0 = 1.6496e-04
Loss = 4.4193e-03, PNorm = 40.4637, GNorm = 1.6124, lr_0 = 1.6379e-04
Validation rmse = 0.663016
Epoch 24
Loss = 4.3802e-03, PNorm = 40.4702, GNorm = 1.6964, lr_0 = 1.6262e-04
Loss = 3.7686e-03, PNorm = 40.4775, GNorm = 2.0198, lr_0 = 1.6146e-04
Loss = 4.1003e-03, PNorm = 40.4825, GNorm = 1.7638, lr_0 = 1.6031e-04
Loss = 4.2013e-03, PNorm = 40.4872, GNorm = 1.7293, lr_0 = 1.5917e-04
Loss = 4.5931e-03, PNorm = 40.4910, GNorm = 1.2339, lr_0 = 1.5804e-04
Loss = 5.2763e-03, PNorm = 40.4977, GNorm = 1.5976, lr_0 = 1.5691e-04
Loss = 3.8437e-03, PNorm = 40.5058, GNorm = 1.5540, lr_0 = 1.5579e-04
Loss = 3.8591e-03, PNorm = 40.5122, GNorm = 2.8891, lr_0 = 1.5468e-04
Loss = 4.2643e-03, PNorm = 40.5154, GNorm = 2.2634, lr_0 = 1.5358e-04
Loss = 4.8486e-03, PNorm = 40.5189, GNorm = 2.4873, lr_0 = 1.5249e-04
Loss = 4.1750e-03, PNorm = 40.5211, GNorm = 1.5940, lr_0 = 1.5140e-04
Validation rmse = 0.659116
Epoch 25
Loss = 4.2395e-03, PNorm = 40.5261, GNorm = 1.2189, lr_0 = 1.5032e-04
Loss = 4.4381e-03, PNorm = 40.5329, GNorm = 2.8813, lr_0 = 1.4925e-04
Loss = 4.5936e-03, PNorm = 40.5381, GNorm = 2.6503, lr_0 = 1.4819e-04
Loss = 4.6793e-03, PNorm = 40.5430, GNorm = 1.7505, lr_0 = 1.4713e-04
Loss = 3.8387e-03, PNorm = 40.5461, GNorm = 1.4767, lr_0 = 1.4608e-04
Loss = 3.7573e-03, PNorm = 40.5503, GNorm = 2.3234, lr_0 = 1.4504e-04
Loss = 4.1104e-03, PNorm = 40.5541, GNorm = 1.5742, lr_0 = 1.4401e-04
Loss = 4.8130e-03, PNorm = 40.5605, GNorm = 1.0340, lr_0 = 1.4298e-04
Loss = 4.5715e-03, PNorm = 40.5670, GNorm = 1.3541, lr_0 = 1.4196e-04
Loss = 3.9933e-03, PNorm = 40.5712, GNorm = 1.9698, lr_0 = 1.4095e-04
Loss = 4.0527e-03, PNorm = 40.5755, GNorm = 1.1289, lr_0 = 1.3995e-04
Loss = 3.9606e-03, PNorm = 40.5815, GNorm = 1.6259, lr_0 = 1.3895e-04
Validation rmse = 0.657067
Epoch 26
Loss = 3.6449e-03, PNorm = 40.5877, GNorm = 1.3615, lr_0 = 1.3796e-04
Loss = 4.8918e-03, PNorm = 40.5942, GNorm = 2.1868, lr_0 = 1.3698e-04
Loss = 3.7224e-03, PNorm = 40.6003, GNorm = 1.5137, lr_0 = 1.3600e-04
Loss = 4.2653e-03, PNorm = 40.6044, GNorm = 2.4479, lr_0 = 1.3503e-04
Loss = 4.1602e-03, PNorm = 40.6076, GNorm = 1.4437, lr_0 = 1.3407e-04
Loss = 3.9569e-03, PNorm = 40.6126, GNorm = 1.1072, lr_0 = 1.3311e-04
Loss = 3.6213e-03, PNorm = 40.6163, GNorm = 1.5378, lr_0 = 1.3217e-04
Loss = 4.0941e-03, PNorm = 40.6205, GNorm = 2.5669, lr_0 = 1.3122e-04
Loss = 4.1157e-03, PNorm = 40.6250, GNorm = 1.3610, lr_0 = 1.3029e-04
Loss = 4.4054e-03, PNorm = 40.6273, GNorm = 1.0562, lr_0 = 1.2936e-04
Loss = 4.0595e-03, PNorm = 40.6289, GNorm = 1.5019, lr_0 = 1.2844e-04
Validation rmse = 0.668202
Epoch 27
Loss = 4.2729e-03, PNorm = 40.6312, GNorm = 1.8116, lr_0 = 1.2752e-04
Loss = 3.8787e-03, PNorm = 40.6355, GNorm = 1.1390, lr_0 = 1.2661e-04
Loss = 4.3041e-03, PNorm = 40.6390, GNorm = 2.2612, lr_0 = 1.2571e-04
Loss = 3.9615e-03, PNorm = 40.6449, GNorm = 3.1127, lr_0 = 1.2482e-04
Loss = 3.9328e-03, PNorm = 40.6497, GNorm = 1.6776, lr_0 = 1.2393e-04
Loss = 3.5871e-03, PNorm = 40.6540, GNorm = 1.0001, lr_0 = 1.2304e-04
Loss = 4.0888e-03, PNorm = 40.6584, GNorm = 3.2371, lr_0 = 1.2217e-04
Loss = 4.3711e-03, PNorm = 40.6614, GNorm = 1.3236, lr_0 = 1.2130e-04
Loss = 4.5744e-03, PNorm = 40.6652, GNorm = 1.3530, lr_0 = 1.2043e-04
Loss = 4.1713e-03, PNorm = 40.6697, GNorm = 1.6220, lr_0 = 1.1957e-04
Loss = 4.5703e-03, PNorm = 40.6749, GNorm = 1.8433, lr_0 = 1.1872e-04
Loss = 3.4745e-03, PNorm = 40.6773, GNorm = 1.9176, lr_0 = 1.1788e-04
Validation rmse = 0.651977
Epoch 28
Loss = 4.1397e-03, PNorm = 40.6811, GNorm = 1.3596, lr_0 = 1.1704e-04
Loss = 4.2904e-03, PNorm = 40.6833, GNorm = 2.7692, lr_0 = 1.1620e-04
Loss = 3.6206e-03, PNorm = 40.6871, GNorm = 1.4786, lr_0 = 1.1538e-04
Loss = 3.9346e-03, PNorm = 40.6927, GNorm = 1.9052, lr_0 = 1.1455e-04
Loss = 4.0447e-03, PNorm = 40.6984, GNorm = 1.3816, lr_0 = 1.1374e-04
Loss = 4.1714e-03, PNorm = 40.7019, GNorm = 1.1640, lr_0 = 1.1293e-04
Loss = 4.0811e-03, PNorm = 40.7052, GNorm = 1.9546, lr_0 = 1.1212e-04
Loss = 3.8702e-03, PNorm = 40.7090, GNorm = 1.2192, lr_0 = 1.1132e-04
Loss = 3.4207e-03, PNorm = 40.7132, GNorm = 1.1343, lr_0 = 1.1053e-04
Loss = 4.6288e-03, PNorm = 40.7180, GNorm = 1.2057, lr_0 = 1.0974e-04
Loss = 3.8645e-03, PNorm = 40.7189, GNorm = 1.4274, lr_0 = 1.0896e-04
Validation rmse = 0.647941
Epoch 29
Loss = 4.3960e-03, PNorm = 40.7211, GNorm = 1.9651, lr_0 = 1.0818e-04
Loss = 3.4307e-03, PNorm = 40.7249, GNorm = 1.8280, lr_0 = 1.0741e-04
Loss = 4.2379e-03, PNorm = 40.7301, GNorm = 2.6115, lr_0 = 1.0665e-04
Loss = 3.9072e-03, PNorm = 40.7344, GNorm = 1.4912, lr_0 = 1.0589e-04
Loss = 3.6919e-03, PNorm = 40.7389, GNorm = 2.3228, lr_0 = 1.0513e-04
Loss = 3.6754e-03, PNorm = 40.7430, GNorm = 1.1912, lr_0 = 1.0438e-04
Loss = 3.4739e-03, PNorm = 40.7447, GNorm = 1.5998, lr_0 = 1.0364e-04
Loss = 3.9604e-03, PNorm = 40.7457, GNorm = 1.7792, lr_0 = 1.0290e-04
Loss = 3.6910e-03, PNorm = 40.7481, GNorm = 2.2880, lr_0 = 1.0217e-04
Loss = 4.4867e-03, PNorm = 40.7519, GNorm = 1.2855, lr_0 = 1.0144e-04
Loss = 4.6602e-03, PNorm = 40.7560, GNorm = 1.1384, lr_0 = 1.0072e-04
Loss = 4.4472e-03, PNorm = 40.7600, GNorm = 2.9172, lr_0 = 1.0000e-04
Validation rmse = 0.659499
Model 0 best validation rmse = 0.647941 on epoch 28
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.645587
Ensemble test rmse = 0.645587
Fold 1
{'activation': 'ReLU',
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'cuda': True,
 'data_path': 'dopamine_new.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 30,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'hidden_size': 300,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cache': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'output_size': 1,
 'quiet': False,
 'save_dir': 'runs\\fold_1',
 'save_smiles_splits': False,
 'seed': 43,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'task_names': ['1.2218487496163564'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 5759,
 'undirected': False,
 'use_compound_names': False,
 'use_input_features': None,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 43
Total size = 7,199 | train size = 5,759 | val size = 720 | test size = 720
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Moving model to cuda
Epoch 0
Loss = 2.0216e-02, PNorm = 34.0609, GNorm = 2.6273, lr_0 = 1.3913e-04
Loss = 2.0206e-02, PNorm = 34.0633, GNorm = 1.7177, lr_0 = 1.7826e-04
Loss = 1.7551e-02, PNorm = 34.0675, GNorm = 1.5998, lr_0 = 2.1739e-04
Loss = 1.7971e-02, PNorm = 34.0742, GNorm = 2.5714, lr_0 = 2.5652e-04
Loss = 1.9957e-02, PNorm = 34.0835, GNorm = 2.0843, lr_0 = 2.9565e-04
Loss = 1.8128e-02, PNorm = 34.0985, GNorm = 5.6041, lr_0 = 3.3478e-04
Loss = 1.7388e-02, PNorm = 34.1153, GNorm = 4.5801, lr_0 = 3.7391e-04
Loss = 1.5016e-02, PNorm = 34.1322, GNorm = 3.3886, lr_0 = 4.1304e-04
Loss = 1.4911e-02, PNorm = 34.1518, GNorm = 4.3056, lr_0 = 4.5217e-04
Loss = 1.5629e-02, PNorm = 34.1740, GNorm = 3.0444, lr_0 = 4.9130e-04
Loss = 1.6417e-02, PNorm = 34.2046, GNorm = 2.5144, lr_0 = 5.3043e-04
Validation rmse = 1.015608
Epoch 1
Loss = 1.5891e-02, PNorm = 34.2404, GNorm = 2.5598, lr_0 = 5.6957e-04
Loss = 1.5982e-02, PNorm = 34.2836, GNorm = 1.2445, lr_0 = 6.0870e-04
Loss = 1.3576e-02, PNorm = 34.3286, GNorm = 2.1430, lr_0 = 6.4783e-04
Loss = 1.4445e-02, PNorm = 34.3759, GNorm = 7.6118, lr_0 = 6.8696e-04
Loss = 1.2618e-02, PNorm = 34.4193, GNorm = 1.3761, lr_0 = 7.2609e-04
Loss = 1.4637e-02, PNorm = 34.4693, GNorm = 2.0034, lr_0 = 7.6522e-04
Loss = 1.3637e-02, PNorm = 34.5274, GNorm = 3.2722, lr_0 = 8.0435e-04
Loss = 1.2700e-02, PNorm = 34.5972, GNorm = 6.8628, lr_0 = 8.4348e-04
Loss = 1.3490e-02, PNorm = 34.6813, GNorm = 6.6320, lr_0 = 8.8261e-04
Loss = 1.2255e-02, PNorm = 34.7500, GNorm = 1.1984, lr_0 = 9.2174e-04
Loss = 1.3547e-02, PNorm = 34.8213, GNorm = 0.6065, lr_0 = 9.6087e-04
Loss = 1.3577e-02, PNorm = 34.8967, GNorm = 2.1823, lr_0 = 1.0000e-03
Validation rmse = 0.938907
Epoch 2
Loss = 1.0955e-02, PNorm = 34.9832, GNorm = 1.3289, lr_0 = 9.9287e-04
Loss = 1.1109e-02, PNorm = 35.0471, GNorm = 1.0751, lr_0 = 9.8580e-04
Loss = 1.1868e-02, PNorm = 35.1180, GNorm = 5.3798, lr_0 = 9.7878e-04
Loss = 1.1515e-02, PNorm = 35.1723, GNorm = 7.5796, lr_0 = 9.7180e-04
Loss = 1.2350e-02, PNorm = 35.2324, GNorm = 5.0345, lr_0 = 9.6488e-04
Loss = 1.2183e-02, PNorm = 35.3080, GNorm = 1.1928, lr_0 = 9.5800e-04
Loss = 1.2697e-02, PNorm = 35.3763, GNorm = 5.0157, lr_0 = 9.5118e-04
Loss = 1.0761e-02, PNorm = 35.4380, GNorm = 4.0472, lr_0 = 9.4440e-04
Loss = 1.2235e-02, PNorm = 35.4945, GNorm = 1.1859, lr_0 = 9.3767e-04
Loss = 1.0939e-02, PNorm = 35.5730, GNorm = 2.1978, lr_0 = 9.3099e-04
Loss = 1.0785e-02, PNorm = 35.6352, GNorm = 5.5846, lr_0 = 9.2435e-04
Validation rmse = 0.888129
Epoch 3
Loss = 9.7281e-03, PNorm = 35.6769, GNorm = 1.1596, lr_0 = 9.1777e-04
Loss = 1.0157e-02, PNorm = 35.7409, GNorm = 1.4395, lr_0 = 9.1123e-04
Loss = 1.1109e-02, PNorm = 35.7860, GNorm = 1.1767, lr_0 = 9.0474e-04
Loss = 9.4246e-03, PNorm = 35.8298, GNorm = 2.1214, lr_0 = 8.9829e-04
Loss = 1.0630e-02, PNorm = 35.8767, GNorm = 2.8946, lr_0 = 8.9189e-04
Loss = 1.0888e-02, PNorm = 35.9303, GNorm = 3.2574, lr_0 = 8.8553e-04
Loss = 1.2417e-02, PNorm = 35.9952, GNorm = 2.1853, lr_0 = 8.7922e-04
Loss = 9.5177e-03, PNorm = 36.0458, GNorm = 4.4757, lr_0 = 8.7296e-04
Loss = 9.0149e-03, PNorm = 36.1035, GNorm = 3.4115, lr_0 = 8.6674e-04
Loss = 8.9851e-03, PNorm = 36.1427, GNorm = 4.7309, lr_0 = 8.6056e-04
Loss = 9.9441e-03, PNorm = 36.1666, GNorm = 1.7223, lr_0 = 8.5443e-04
Loss = 8.8066e-03, PNorm = 36.2043, GNorm = 3.2101, lr_0 = 8.4834e-04
Validation rmse = 0.853202
Epoch 4
Loss = 8.9467e-03, PNorm = 36.2502, GNorm = 6.0867, lr_0 = 8.4230e-04
Loss = 7.7198e-03, PNorm = 36.2774, GNorm = 0.8626, lr_0 = 8.3630e-04
Loss = 8.3067e-03, PNorm = 36.3209, GNorm = 0.6652, lr_0 = 8.3034e-04
Loss = 1.0135e-02, PNorm = 36.3566, GNorm = 4.0630, lr_0 = 8.2442e-04
Loss = 8.8964e-03, PNorm = 36.3862, GNorm = 2.3808, lr_0 = 8.1855e-04
Loss = 9.0150e-03, PNorm = 36.4365, GNorm = 0.7060, lr_0 = 8.1271e-04
Loss = 1.1613e-02, PNorm = 36.4680, GNorm = 3.2000, lr_0 = 8.0692e-04
Loss = 8.5575e-03, PNorm = 36.5103, GNorm = 1.3179, lr_0 = 8.0117e-04
Loss = 1.0907e-02, PNorm = 36.5542, GNorm = 4.0774, lr_0 = 7.9547e-04
Loss = 8.5846e-03, PNorm = 36.5915, GNorm = 0.7854, lr_0 = 7.8980e-04
Loss = 7.6301e-03, PNorm = 36.6430, GNorm = 1.7520, lr_0 = 7.8417e-04
Validation rmse = 0.824652
Epoch 5
Loss = 8.5962e-03, PNorm = 36.6596, GNorm = 2.4331, lr_0 = 7.7858e-04
Loss = 7.3163e-03, PNorm = 36.7026, GNorm = 1.7945, lr_0 = 7.7303e-04
Loss = 8.0620e-03, PNorm = 36.7469, GNorm = 1.4210, lr_0 = 7.6753e-04
Loss = 9.5443e-03, PNorm = 36.7769, GNorm = 1.7415, lr_0 = 7.6206e-04
Loss = 7.9331e-03, PNorm = 36.8184, GNorm = 2.7452, lr_0 = 7.5663e-04
Loss = 7.9291e-03, PNorm = 36.8546, GNorm = 2.1094, lr_0 = 7.5124e-04
Loss = 8.3913e-03, PNorm = 36.8924, GNorm = 1.6750, lr_0 = 7.4588e-04
Loss = 8.3360e-03, PNorm = 36.9414, GNorm = 3.4800, lr_0 = 7.4057e-04
Loss = 9.8048e-03, PNorm = 36.9811, GNorm = 1.6542, lr_0 = 7.3529e-04
Loss = 8.9328e-03, PNorm = 37.0123, GNorm = 1.2584, lr_0 = 7.3005e-04
Loss = 8.2351e-03, PNorm = 37.0405, GNorm = 3.1982, lr_0 = 7.2485e-04
Loss = 8.1974e-03, PNorm = 37.0747, GNorm = 3.0424, lr_0 = 7.1969e-04
Validation rmse = 0.788643
Epoch 6
Loss = 8.1671e-03, PNorm = 37.1056, GNorm = 1.3643, lr_0 = 7.1456e-04
Loss = 6.4141e-03, PNorm = 37.1331, GNorm = 2.4305, lr_0 = 7.0947e-04
Loss = 8.8729e-03, PNorm = 37.1549, GNorm = 2.3063, lr_0 = 7.0441e-04
Loss = 7.3461e-03, PNorm = 37.1812, GNorm = 2.2789, lr_0 = 6.9939e-04
Loss = 7.7986e-03, PNorm = 37.2141, GNorm = 1.1456, lr_0 = 6.9441e-04
Loss = 8.6965e-03, PNorm = 37.2489, GNorm = 2.8969, lr_0 = 6.8946e-04
Loss = 7.6093e-03, PNorm = 37.2815, GNorm = 1.2898, lr_0 = 6.8455e-04
Loss = 7.6773e-03, PNorm = 37.3109, GNorm = 1.1781, lr_0 = 6.7967e-04
Loss = 6.9474e-03, PNorm = 37.3384, GNorm = 2.0784, lr_0 = 6.7483e-04
Loss = 8.2550e-03, PNorm = 37.3686, GNorm = 1.7711, lr_0 = 6.7002e-04
Loss = 7.0459e-03, PNorm = 37.4023, GNorm = 2.0476, lr_0 = 6.6524e-04
Validation rmse = 0.821436
Epoch 7
Loss = 7.5852e-03, PNorm = 37.4305, GNorm = 2.8561, lr_0 = 6.6050e-04
Loss = 8.3470e-03, PNorm = 37.4729, GNorm = 2.3759, lr_0 = 6.5580e-04
Loss = 8.6820e-03, PNorm = 37.5111, GNorm = 1.5511, lr_0 = 6.5113e-04
Loss = 6.8808e-03, PNorm = 37.5398, GNorm = 1.5081, lr_0 = 6.4649e-04
Loss = 7.5565e-03, PNorm = 37.5603, GNorm = 1.0994, lr_0 = 6.4188e-04
Loss = 6.9519e-03, PNorm = 37.5940, GNorm = 2.4484, lr_0 = 6.3731e-04
Loss = 6.7870e-03, PNorm = 37.6190, GNorm = 0.9683, lr_0 = 6.3276e-04
Loss = 7.9168e-03, PNorm = 37.6449, GNorm = 4.4853, lr_0 = 6.2826e-04
Loss = 7.2084e-03, PNorm = 37.6757, GNorm = 1.1940, lr_0 = 6.2378e-04
Loss = 6.3197e-03, PNorm = 37.7012, GNorm = 1.4126, lr_0 = 6.1933e-04
Loss = 6.0017e-03, PNorm = 37.7279, GNorm = 1.9466, lr_0 = 6.1492e-04
Loss = 7.1426e-03, PNorm = 37.7524, GNorm = 2.5045, lr_0 = 6.1054e-04
Validation rmse = 0.753272
Epoch 8
Loss = 6.8576e-03, PNorm = 37.7837, GNorm = 1.0464, lr_0 = 6.0619e-04
Loss = 6.1587e-03, PNorm = 37.8057, GNorm = 2.9357, lr_0 = 6.0187e-04
Loss = 6.6082e-03, PNorm = 37.8241, GNorm = 3.2492, lr_0 = 5.9758e-04
Loss = 7.1229e-03, PNorm = 37.8516, GNorm = 3.3329, lr_0 = 5.9332e-04
Loss = 6.8215e-03, PNorm = 37.8806, GNorm = 2.4310, lr_0 = 5.8910e-04
Loss = 6.8836e-03, PNorm = 37.9102, GNorm = 0.9233, lr_0 = 5.8490e-04
Loss = 7.1111e-03, PNorm = 37.9315, GNorm = 1.0579, lr_0 = 5.8073e-04
Loss = 6.8306e-03, PNorm = 37.9596, GNorm = 1.8902, lr_0 = 5.7659e-04
Loss = 6.4574e-03, PNorm = 37.9830, GNorm = 1.7140, lr_0 = 5.7248e-04
Loss = 6.1618e-03, PNorm = 38.0000, GNorm = 0.9078, lr_0 = 5.6841e-04
Loss = 7.5850e-03, PNorm = 38.0281, GNorm = 1.5251, lr_0 = 5.6436e-04
Validation rmse = 0.783793
Epoch 9
Loss = 8.3857e-03, PNorm = 38.0552, GNorm = 3.5840, lr_0 = 5.6033e-04
Loss = 6.8315e-03, PNorm = 38.0847, GNorm = 1.4418, lr_0 = 5.5634e-04
Loss = 7.0969e-03, PNorm = 38.1090, GNorm = 3.2508, lr_0 = 5.5238e-04
Loss = 7.5464e-03, PNorm = 38.1372, GNorm = 0.8184, lr_0 = 5.4844e-04
Loss = 6.8795e-03, PNorm = 38.1589, GNorm = 1.3481, lr_0 = 5.4453e-04
Loss = 6.5312e-03, PNorm = 38.1780, GNorm = 1.2026, lr_0 = 5.4065e-04
Loss = 6.7085e-03, PNorm = 38.2007, GNorm = 1.8140, lr_0 = 5.3680e-04
Loss = 6.3603e-03, PNorm = 38.2205, GNorm = 1.1961, lr_0 = 5.3298e-04
Loss = 6.8436e-03, PNorm = 38.2392, GNorm = 1.6417, lr_0 = 5.2918e-04
Loss = 5.6662e-03, PNorm = 38.2602, GNorm = 0.8798, lr_0 = 5.2541e-04
Loss = 6.1578e-03, PNorm = 38.2812, GNorm = 1.5980, lr_0 = 5.2166e-04
Loss = 5.6111e-03, PNorm = 38.3073, GNorm = 1.9710, lr_0 = 5.1795e-04
Validation rmse = 0.727391
Epoch 10
Loss = 7.1720e-03, PNorm = 38.3265, GNorm = 3.6785, lr_0 = 5.1426e-04
Loss = 6.2015e-03, PNorm = 38.3551, GNorm = 1.8787, lr_0 = 5.1059e-04
Loss = 6.4898e-03, PNorm = 38.3797, GNorm = 2.9595, lr_0 = 5.0695e-04
Loss = 6.4350e-03, PNorm = 38.3965, GNorm = 1.8472, lr_0 = 5.0334e-04
Loss = 6.6765e-03, PNorm = 38.4177, GNorm = 2.1843, lr_0 = 4.9976e-04
Loss = 7.0009e-03, PNorm = 38.4361, GNorm = 5.2686, lr_0 = 4.9619e-04
Loss = 6.1507e-03, PNorm = 38.4550, GNorm = 1.0267, lr_0 = 4.9266e-04
Loss = 5.7416e-03, PNorm = 38.4736, GNorm = 1.4020, lr_0 = 4.8915e-04
Loss = 6.3950e-03, PNorm = 38.4985, GNorm = 2.5849, lr_0 = 4.8566e-04
Loss = 6.0640e-03, PNorm = 38.5271, GNorm = 1.4493, lr_0 = 4.8220e-04
Loss = 5.7555e-03, PNorm = 38.5457, GNorm = 1.1310, lr_0 = 4.7877e-04
Validation rmse = 0.727000
Epoch 11
Loss = 6.6788e-03, PNorm = 38.5650, GNorm = 3.8445, lr_0 = 4.7536e-04
Loss = 5.9643e-03, PNorm = 38.5844, GNorm = 1.2838, lr_0 = 4.7197e-04
Loss = 6.2357e-03, PNorm = 38.6054, GNorm = 1.0508, lr_0 = 4.6861e-04
Loss = 5.3663e-03, PNorm = 38.6179, GNorm = 1.7898, lr_0 = 4.6527e-04
Loss = 5.9420e-03, PNorm = 38.6413, GNorm = 3.7216, lr_0 = 4.6195e-04
Loss = 6.2793e-03, PNorm = 38.6670, GNorm = 1.0560, lr_0 = 4.5866e-04
Loss = 5.3379e-03, PNorm = 38.6850, GNorm = 3.2419, lr_0 = 4.5539e-04
Loss = 5.7122e-03, PNorm = 38.7093, GNorm = 3.1681, lr_0 = 4.5215e-04
Loss = 6.1396e-03, PNorm = 38.7232, GNorm = 1.6931, lr_0 = 4.4893e-04
Loss = 6.6717e-03, PNorm = 38.7398, GNorm = 2.1950, lr_0 = 4.4573e-04
Loss = 5.6368e-03, PNorm = 38.7579, GNorm = 1.7551, lr_0 = 4.4255e-04
Loss = 6.1483e-03, PNorm = 38.7730, GNorm = 1.1425, lr_0 = 4.3940e-04
Validation rmse = 0.712627
Epoch 12
Loss = 5.4835e-03, PNorm = 38.7917, GNorm = 1.0576, lr_0 = 4.3627e-04
Loss = 5.5605e-03, PNorm = 38.8088, GNorm = 1.3283, lr_0 = 4.3316e-04
Loss = 5.7400e-03, PNorm = 38.8227, GNorm = 2.0314, lr_0 = 4.3007e-04
Loss = 5.7949e-03, PNorm = 38.8397, GNorm = 1.5931, lr_0 = 4.2701e-04
Loss = 5.3684e-03, PNorm = 38.8556, GNorm = 1.2695, lr_0 = 4.2396e-04
Loss = 6.6677e-03, PNorm = 38.8691, GNorm = 1.9289, lr_0 = 4.2094e-04
Loss = 4.7659e-03, PNorm = 38.8800, GNorm = 1.0922, lr_0 = 4.1794e-04
Loss = 5.2522e-03, PNorm = 38.8935, GNorm = 1.7682, lr_0 = 4.1497e-04
Loss = 6.1529e-03, PNorm = 38.9124, GNorm = 1.5207, lr_0 = 4.1201e-04
Loss = 6.0173e-03, PNorm = 38.9297, GNorm = 1.1025, lr_0 = 4.0907e-04
Loss = 5.1780e-03, PNorm = 38.9431, GNorm = 1.8604, lr_0 = 4.0616e-04
Validation rmse = 0.713260
Epoch 13
Loss = 5.3812e-03, PNorm = 38.9628, GNorm = 0.9879, lr_0 = 4.0326e-04
Loss = 5.6623e-03, PNorm = 38.9774, GNorm = 1.5855, lr_0 = 4.0039e-04
Loss = 5.3984e-03, PNorm = 38.9906, GNorm = 1.2593, lr_0 = 3.9754e-04
Loss = 5.8140e-03, PNorm = 39.0037, GNorm = 1.8254, lr_0 = 3.9471e-04
Loss = 4.9450e-03, PNorm = 39.0200, GNorm = 3.0263, lr_0 = 3.9189e-04
Loss = 5.7475e-03, PNorm = 39.0350, GNorm = 2.9064, lr_0 = 3.8910e-04
Loss = 5.8813e-03, PNorm = 39.0563, GNorm = 1.1152, lr_0 = 3.8633e-04
Loss = 5.4057e-03, PNorm = 39.0720, GNorm = 1.4400, lr_0 = 3.8358e-04
Loss = 6.4250e-03, PNorm = 39.0847, GNorm = 3.1464, lr_0 = 3.8084e-04
Loss = 5.4397e-03, PNorm = 39.0940, GNorm = 1.1155, lr_0 = 3.7813e-04
Loss = 5.8096e-03, PNorm = 39.1109, GNorm = 2.4304, lr_0 = 3.7543e-04
Loss = 5.5148e-03, PNorm = 39.1248, GNorm = 2.1004, lr_0 = 3.7276e-04
Validation rmse = 0.714623
Epoch 14
Loss = 4.9273e-03, PNorm = 39.1360, GNorm = 1.5096, lr_0 = 3.7010e-04
Loss = 5.7650e-03, PNorm = 39.1546, GNorm = 1.1973, lr_0 = 3.6747e-04
Loss = 5.1378e-03, PNorm = 39.1658, GNorm = 1.1446, lr_0 = 3.6485e-04
Loss = 5.1527e-03, PNorm = 39.1791, GNorm = 1.3066, lr_0 = 3.6225e-04
Loss = 4.7181e-03, PNorm = 39.1924, GNorm = 2.0074, lr_0 = 3.5967e-04
Loss = 5.3939e-03, PNorm = 39.2016, GNorm = 0.9141, lr_0 = 3.5710e-04
Loss = 6.1869e-03, PNorm = 39.2118, GNorm = 2.9930, lr_0 = 3.5456e-04
Loss = 5.9701e-03, PNorm = 39.2272, GNorm = 1.6189, lr_0 = 3.5203e-04
Loss = 6.0763e-03, PNorm = 39.2446, GNorm = 1.3292, lr_0 = 3.4953e-04
Loss = 5.4814e-03, PNorm = 39.2624, GNorm = 2.7584, lr_0 = 3.4703e-04
Loss = 5.3555e-03, PNorm = 39.2753, GNorm = 2.2672, lr_0 = 3.4456e-04
Validation rmse = 0.702789
Epoch 15
Loss = 5.6051e-03, PNorm = 39.2867, GNorm = 1.6641, lr_0 = 3.4211e-04
Loss = 4.2717e-03, PNorm = 39.3059, GNorm = 3.4624, lr_0 = 3.3967e-04
Loss = 5.2714e-03, PNorm = 39.3172, GNorm = 1.4953, lr_0 = 3.3725e-04
Loss = 4.8781e-03, PNorm = 39.3252, GNorm = 1.3944, lr_0 = 3.3485e-04
Loss = 5.0357e-03, PNorm = 39.3384, GNorm = 1.4848, lr_0 = 3.3246e-04
Loss = 5.7493e-03, PNorm = 39.3498, GNorm = 1.5268, lr_0 = 3.3009e-04
Loss = 5.0269e-03, PNorm = 39.3601, GNorm = 1.0873, lr_0 = 3.2774e-04
Loss = 5.2396e-03, PNorm = 39.3745, GNorm = 3.7205, lr_0 = 3.2540e-04
Loss = 4.8408e-03, PNorm = 39.3875, GNorm = 2.2552, lr_0 = 3.2308e-04
Loss = 6.0373e-03, PNorm = 39.3951, GNorm = 2.6850, lr_0 = 3.2078e-04
Loss = 4.5213e-03, PNorm = 39.4073, GNorm = 1.3352, lr_0 = 3.1850e-04
Loss = 5.7027e-03, PNorm = 39.4146, GNorm = 2.3474, lr_0 = 3.1623e-04
Validation rmse = 0.703556
Epoch 16
Loss = 4.7381e-03, PNorm = 39.4215, GNorm = 1.3024, lr_0 = 3.1397e-04
Loss = 4.8373e-03, PNorm = 39.4329, GNorm = 1.8454, lr_0 = 3.1174e-04
Loss = 4.3497e-03, PNorm = 39.4394, GNorm = 2.6100, lr_0 = 3.0952e-04
